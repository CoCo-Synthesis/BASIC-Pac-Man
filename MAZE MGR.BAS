0 PCLEAR1:POKE&HFFD8,0:LOADM"PACTILES.BIN":POKE&HFFD9,0:REM POKE&HADEB,57:POKE&HE414,0:POKE&HE42A,0:POKE359,255:POKE&HF00E,&H84:POKE&HF00D,&H94:POKE&HF00E,&HB3
1 ONBRKGOTO109:HSCREEN2:HCLS.:POKE&HE649,&H10:POKE&HE664,&H0:POKE&HE666,&HB:POKE&HE66A,&H3D:POKE&HE66B,7:POKE&HE66C,&H3C:POKE&HE66D,&H3C:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,&H3F:POKE&HE673,&H1C:RGB
2 CLEAR512:DIMP(&H156),PC(21),ML(15),A$(3),A(3),F1$,F2$:PLAY"T255;L255;V5;":BC=&HC:HBUFF1,100:HBUFF2,300:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR1:HPRINT(10,0),"pacdman":HCOLOR4:HPRINT(18,0),"MAZE MANAGER":HPRINT(11,10),CHR$(22)+" CHECKING MAZES"
3 HCOLOR1:D=PEEK(235):FORS=3TO17:O=NOTO:DSKI$D,17,S,F1$,F2$:HPRINT(8+S,10),CHR$(&H20)+CHR$(&H22+O):FORMZ=1TO15:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," "):IFINSTR(F1$,F$)ORINSTR(F2$,F$)THENML(MZ)=1
4 NEXT:NEXT:HPRINT(8+S,10),CHR$(&H20):HCOLORBC:HPRINT(.,3),CHR$(&H5B)+STRING$(7,CHR$(&H26))+CHR$(&H5D):FORAC=1TO3:READ A$(AC):READ A(AC):HPRINT(.,3+AC),CHR$(&H2E):IFA(AC)THENHCOLOR4 ELSEHCOLOR7
5 HPRINT(1,3+AC),A$(AC):HCOLORBC:HPRINT(8,3+AC),CHR$(&H2E):NEXT:HPRINT(.,AC+3),CHR$(58)+STRING$(7,CHR$(&H26))+CHR$(44):AC=1:HCOLOR9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(.,3+AC),CHR$(37):HCOLORBC
6 FORMZ=8TO22:HPRINT(.,MZ),CHR$(&H2E):HPRINT(8,MZ),CHR$(&H2E):NEXT:HPRINT(.,23),CHR$(92)+STRING$(7,CHR$(&H26))+CHR$(94):HCOLORBC:T=0:FORMY=5TO17STEP2:FORMX=32TO36STEP2:T=T+1:READB:PC(T)=B
7 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H22 THENHCOLOR1:ELSEIFB=67THENHCOLOR&HA:ELSEIFB=82THENHCOLOR2:ELSEHCOLORBC
8 HPRINT(MX,MY),CHR$(B):NEXT:NEXT:HCOLOR13:HPRINT(MX-3,MY-2),"L":KB$=CHR$(94)+CHR$(10)+CHR$(13):POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(12,3),"SELECT AN ACTION"
9 ONBRKGOTO109:A$=INKEY$:IFA$=""THEN9
10 ONINSTR(1,KB$,A$)GOSUB11,13,15:GOTO9
11 IFAC>1THENAC=AC-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,4+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,3+AC),CHR$(37)
12 RETURN
13 IFAC<3THENAC=AC+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,2+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,3+AC),CHR$(37)
14 RETURN
15 IFA(AC)THENELSE:PLAY"O1;1":RETURN
16 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:IFAC=2THENHPRINT(10,3)," SELECT MAZE TO LOAD":ELSEIFAC=3THENHPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE"
17 IFAC>1THENGOTO18ELSEMZ=0:GOTO28
18 GOSUB21:MZ=1:HCOLOR9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(.,7+MZ),CHR$(37)
19 ONBRKGOTO49:A$=INKEY$:IFA$=""THEN19
20 ONINSTR(1,KB$,A$)GOSUB23,25,27:GOTO19
21 POKE&HF00D,&H94:POKE&HF00E,&HB3:FORMR=8TO22:IFML(MR-7)THENHCOLOR4 ELSEHCOLOR7
22 HPRINT(1,MR),"MAZE"+STR$(MR-7):NEXT:RETURN
23 IFMZ>1THENMZ=MZ-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,8+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,7+MZ),CHR$(37)
24 RETURN
25 IFMZ<15THENMZ=MZ+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,6+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,7+MZ),CHR$(37)
26 RETURN
27 IFA(AC)THEN ONAC GOTO48,28,41:RETURN:ELSE PLAY"O1;1":RETURN
28 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:IFDT THENHCOLOR9:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO31
29 A$=INKEY$:IFA$=""THEN29
30 IFA$="N"THEN PLAY"O1;1":HCOLOR4:IFMZ>.THENHPRINT(9,3),"  SELECT MAZE TO LOAD    ":RETURN:ELSEHPRINT(9,3),"   SELECT AN ACTION     ":RETURN:ELSEIFA$="Y"THENPLAY"O5;12":HCOLOR.:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO29
31 IFML(MZ)THEN MF$="MAZE"+STR$(MZ)ELSEMF$="MAZE 00"
32 POKE&HF00D,&H94:POKE&HF00E,&HB3:PP=.:X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+8*17+1:Y2=Y1+8*19+1:HCOLOR4
33 IFMZ>.THENHPRINT(9,3),"   LOADING MAZE"+STR$(MZ) + STRING$(3,CHR$(36))+" " ELSE HPRINT(9,3),"  CREATING EMPTY MAZE   "
34 CLOSE #1:OPEN "I",#1,MF$:INPUT#1,PC:POKE&HFFBC,PC:HCOLORBC:FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:INPUT#1,B:P(Z)=B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:PP=PP+1:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H20 THENHCOLOR.:ELSEIFB=&H22 THENHCOLOR1
35 HPRINT(X+&HB,Y+&H4),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1:DT=.:HCOLOR7:HPRINT(1,6),A$(3):HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":IFPP=4THENHCOLOR4:A(3)=1:ELSE HCOLOR7:A(3)=0
36 HPRINT(1,6),A$(3):X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:MB$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)+CHR$(13)
37 ONBRKGOTO67:A$=INKEY$:IFA$=""THEN37
38 ONINSTR(1,MB$,A$)GOSUB50,52,54,56,58:GOTO37
39 HPUT(X1,Y1)-(X2,Y2),1:GOTO36
40 RETURN
41 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"     ":D=PEEK(235):FORS=3TO17:DSKI$D,17,S,F1$,F2$:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," ")
42 IFINSTR(F1$,F$)ORINSTR(F2$,F$)THENML(MZ)=1:HCOLOR9:HPRINT(9,3)," OVERWRITE MAZE"+STR$(MZ)+CHR$(96)+" Y"+CHR$(36)+"N   ":ELSEGOTO45
43 A$=INKEY$:IFA$=""THEN43
44 IFA$="N"THENPLAY"O1;1":GOTO47:ELSEIFA$="Y"THENPLAY"O5;12":HCOLOR4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"     ":GOTO46:ELSEGOTO43
45 NEXT
46 BZ=.:MF$="MAZE"+STR$(MZ):CLOSE #1:OPEN "O",#1,MF$:PRINT#1,PEEK(&HFFBC):FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:PRINT#1,P(Z):NEXT:NEXT:CLOSE #1:ML(MZ)=1:DT=.
47 HCOLOR4:HPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE":GOSUB21:RETURN
48 PLAY"O1;1":RETURN
49 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(9,3),"   SELECT AN ACTION     ":HCOLORBC:HPRINT(.,MZ+7),CHR$(&H2E):RETURN
50 IFY>1THENY=Y-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1+8)-(X2,Y2+8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
51 RETURN
52 IFY<19THENY=Y+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1-8)-(X2,Y2-8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
53 RETURN
54 IFX>1THENX=X-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1+8,Y1)-(X2+8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
55 RETURN
56 IFX<17THENX=X+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1-8,Y1)-(X2-8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
57 RETURN
58 IFX=9 ANDY=14THENPLAY"O1;1":RETURN
59 IFX>6 ANDX<10 ANDY>8 ANDY<12THENPLAY"O1;1":RETURN
60 PLAY"O5;12":HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE"
61 HCOLORBC:T=0:EX=.:FORMY=5TO17STEP2:FORMX=32TO36STEP2:T=T+1:Z=X-&H12+&H12*Y:IFPC(T)=P(Z)THENELSEGOTO63
62 X3=MX*8-1:Y3=MY*8-1:X4=X3+9:Y4=Y3+9:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:MA=MX:MB=MY:MC=T:B=PC(MC)
63 NEXT:NEXT
64 ONBRKGOTO99:A$=INKEY$:IFA$=""THEN64
65 ONINSTR(1,MB$,A$)GOSUB69,74,78,84,88:IFEX THENRETURNELSEGOTO64
66 RETURN
67 PLAY"O1;1":HCOLOR4:IFMZ>.THENHPRINT(9,3),"  SELECT MAZE TO LOAD " ELSE HPRINT(9,3),"   SELECT AN ACTION   "
68 HPUT(X1,Y1)-(X2,Y2),1:RETURN
69 IFMB>5THENMB=MB-2ELSERETURN
70 IF(MA=34ORMA=36)ANDMB=15THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(271,135)-(271+25,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO72
71 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(X3,Y3+16)-(X4,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B
72 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
73 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
74 IFMB<17THENMB=MB+2ELSERETURN
75 IF(MA=34ORMA=36)ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(271,135)-(271+25,Y4),2:HCOLOR9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
76 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:B=PC(MC):HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
77 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
78 IFMA>32THENMA=MA-2ELSERETURN
79 IFMA=34ANDMB=17THENMA=MA-2:MC=MC-1
80 IFMA=32ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(271,Y3)-(271+25,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO82
81 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(X3+16,Y3)-(X4+16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B
82 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
83 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
84 IFMA<36THENIFMA=34ANDMB=17THENRETURNELSEMA=MA+2:ELSERETURN
85 IFMA=34ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(271,135)-(271+25,Y4),2:HCOLOR9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
86 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:B=PC(MC):HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
87 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
88 IF(MA=34ORMA=36)ANDMB=17THENCB$=CHR$(94)+CHR$(10)+CHR$(13)ELSEGOTO93
89 PLAY"O5;12":NC=PEEK(&HFFBC):OC=NC:CE=.:CB$=CHR$(94)+CHR$(10)+CHR$(13):HCOLOR4:HPRINT(9,3)," UP"+CHR$(37)+"DOWN CHANGES COLOR "
90 ONBRKGOTO107:A$=INKEY$:IFA$=""THEN90
91 ONINSTR(1,CB$,A$)GOSUB102,104,106
92 IFCE THENRETURN:ELSEGOTO90
93 IFPP=4ANDB=37THENPLAY"O1;1":RETURN
94 IFP(Z)=37ANDB<>37THENPP=PP-1:IFPP=3THENA(3)=0:HCOLOR7:HPRINT(1,6),A$(3)
95 IFB=37THENPP=PP+1:IFPP=4THENA(3)=1:HCOLOR4:HPRINT(1,6),A$(3)
96 PLAY"O5;12":HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":IFDT THENELSEIFP(Z)=B THENELSEDT=NOT.:HCOLOR4:HPRINT(1,6),A$(3)
97 P(Z)=B:HPUT(X1,Y1)-(X2,Y2),1:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
98 HPRINT(X+&HB,Y+&H4),CHR$(B):HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:HPUT(X3,Y3)-(X4,Y4),2:EX=NOT.:RETURN
99 PLAY"O1;1":HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
100 IF(MA=34ORMA=36)ANDMB=17THENHPUT(271,Y3)-(271+25,Y4),2ELSEHPUT(X3,Y3)-(X4,Y4),2
101 EX=NOT.:RETURN
102 NC=NC+1:IFNC>63THENNC=0
103 POKE&HFFBC,NC:RETURN
104 NC=NC-1:IFNC<0THENNC=63
105 POKE&HFFBC,NC:RETURN
106 PLAY"O5;12":CE=NOT.:HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":GOTO64
107 PLAY"O1;1":HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":POKE&HFFBC,OC:RETURN
108 GOTO108
109 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR9:HPRINT(9,3),"   EXIT MANAGER"+CHR$(96)+" Y"+CHR$(36)+"N  "
110 A$=INKEY$:IFA$=""THEN110
111 IFA$="N"THENHCOLOR4:HPRINT(9,3),"   SELECT AN ACTION     ":GOTO9:ELSEIFA$="Y"THENRGB:END:ELSEGOTO110
112 DATA"NEW",1,"LOAD",1,"SAVE",0,91,45,93,58,47,44,92,43,94,40,38,39,42,101,32,46,36,37,41,67,82
