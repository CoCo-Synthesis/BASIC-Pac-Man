0 CLEAR
1 PCLEAR1:POKE&HFFD8,0:LOADM"PACTILES.BIN":POKE&HFFD9,0:REM POKE&HADEB,57:POKE&HE414,0:POKE&HE42A,0:POKE359,255:POKE&HF00E,&H84:POKE&HF00D,&H94:POKE&HF00E,&HB3
2 CLEAR0:HSCREEN2:HCLS.:POKE&HE649,&H10:POKE&HE664,&H0:POKE&HE666,&HB:POKE&HE66A,&H3D:POKE&HE66B,7:POKE&HE66C,&H3C:POKE&HE66D,&H3C:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,&H3F:POKE&HE673,&H1C:RGB
3 CLEAR512:DIMP(&H156),PC(21),ML(15),A$(3),A(3),F1$,F2$:PLAY"T255;L255;V5;":BC=&HC:HBUFF1,100:HBUFF2,300:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR1:HPRINT(10,0),"pacdman":HCOLOR4:HPRINT(18,0),"MAZE MANAGER":HPRINT(11,10),CHR$(22)+" CHECKING MAZES"
4 ONBRKGOTO111
5 HCOLOR1:D=PEEK(235):FORS=3TO17:O=NOTO:DSKI$D,17,S,F1$,F2$:HPRINT(8+S,10),CHR$(&H20)+CHR$(&H22+O):FORMZ=1TO15:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," "):IFINSTR(F1$,F$)ORINSTR(F2$,F$)THENML(MZ)=1
6 NEXT:NEXT:HPRINT(8+S,10),CHR$(&H20):HCOLORBC:HPRINT(.,3),CHR$(&H5B)+STRING$(7,CHR$(&H26))+CHR$(&H5D):FORAC=1TO3:READ A$(AC):READ A(AC):HPRINT(.,3+AC),CHR$(&H2E):IFA(AC)THENHCOLOR4 ELSEHCOLOR7
7 HPRINT(1,3+AC),A$(AC):HCOLORBC:HPRINT(8,3+AC),CHR$(&H2E):NEXT:HPRINT(.,AC+3),CHR$(58)+STRING$(7,CHR$(&H26))+CHR$(44):AC=1:HCOLOR9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(.,3+AC),CHR$(37):HCOLORBC
8 FORMZ=8TO22:HPRINT(.,MZ),CHR$(&H2E):HPRINT(8,MZ),CHR$(&H2E):NEXT:HPRINT(.,23),CHR$(92)+STRING$(7,CHR$(&H26))+CHR$(94):HCOLORBC:T=0:FORMY=5TO17STEP2:FORMX=32TO36STEP2:T=T+1:READB:PC(T)=B
9 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H22 THENHCOLOR1:ELSEIFB=67THENHCOLOR&HA:ELSEIFB=82THENHCOLOR2:ELSEHCOLORBC
10 HPRINT(MX,MY),CHR$(B):NEXT:NEXT:HCOLOR13:HPRINT(MX-3,MY-2),"L":KB$=CHR$(94)+CHR$(10)+CHR$(13):POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(12,3),"SELECT AN ACTION"
11 ONBRKGOTO111:A$=INKEY$:IFA$=""THEN11
12 ONINSTR(1,KB$,A$)GOSUB13,15,17:GOTO11
13 IFAC>1THENAC=AC-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,4+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,3+AC),CHR$(37)
14 RETURN
15 IFAC<3THENAC=AC+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,2+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,3+AC),CHR$(37)
16 RETURN
17 IFA(AC)THENELSE:PLAY"O1;1":RETURN
18 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:IFAC=2THENHPRINT(10,3)," SELECT MAZE TO LOAD":ELSEIFAC=3THENHPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE"
19 IFAC>1THENGOTO20ELSEMZ=0:GOTO30
20 GOSUB23:MZ=1:HCOLOR9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(.,7+MZ),CHR$(37)
21 ONBRKGOTO51:A$=INKEY$:IFA$=""THEN21
22 ONINSTR(1,KB$,A$)GOSUB25,27,29:GOTO21
23 POKE&HF00D,&H94:POKE&HF00E,&HB3:FORMR=8TO22:IFML(MR-7)THENHCOLOR4 ELSEHCOLOR7
24 HPRINT(1,MR),"MAZE"+STR$(MR-7):NEXT:RETURN
25 IFMZ>1THENMZ=MZ-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,8+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,7+MZ),CHR$(37)
26 RETURN
27 IFMZ<15THENMZ=MZ+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(.,6+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR9:HPRINT(.,7+MZ),CHR$(37)
28 RETURN
29 IFA(AC)THEN ONAC GOTO50,30,43:RETURN:ELSE PLAY"O1;1":RETURN
30 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:IFDT THENHCOLOR9:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO33
31 A$=INKEY$:IFA$=""THEN31
32 IFA$="N"THEN PLAY"O1;1":HCOLOR4:IFMZ>.THENHPRINT(9,3),"  SELECT MAZE TO LOAD    ":RETURN:ELSEHPRINT(9,3),"   SELECT AN ACTION     ":RETURN:ELSEIFA$="Y"THENPLAY"O5;12":HCOLOR.:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO31
33 IFML(MZ)THEN MF$="MAZE"+STR$(MZ)ELSEMF$="MAZE 00"
34 POKE&HF00D,&H94:POKE&HF00E,&HB3:PP=.:X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+8*17+1:Y2=Y1+8*19+1:HCOLOR4
35 IFMZ>.THENHPRINT(9,3),"   LOADING MAZE"+STR$(MZ) + STRING$(3,CHR$(36))+" " ELSE HPRINT(9,3),"  CREATING EMPTY MAZE   "
36 CLOSE #1:OPEN "I",#1,MF$:INPUT#1,PC:POKE&HFFBC,PC:HCOLORBC:FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:INPUT#1,B:P(Z)=B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:PP=PP+1:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H20 THENHCOLOR.:ELSEIFB=&H22 THENHCOLOR1
37 HPRINT(X+&HB,Y+&H4),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1:DT=.:HCOLOR7:HPRINT(1,6),A$(3):HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":IFPP=4THENHCOLOR4:A(3)=1:ELSE HCOLOR7:A(3)=0
38 HPRINT(1,6),A$(3):X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:MB$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)+CHR$(13)
39 ONBRKGOTO69:A$=INKEY$:IFA$=""THEN39
40 ONINSTR(1,MB$,A$)GOSUB52,54,56,58,60:GOTO39
41 HPUT(X1,Y1)-(X2,Y2),1:GOTO38
42 RETURN
43 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"     ":D=PEEK(235):FORS=3TO17:DSKI$D,17,S,F1$,F2$:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," ")
44 IFINSTR(F1$,F$)ORINSTR(F2$,F$)THENML(MZ)=1:HCOLOR9:HPRINT(9,3)," OVERWRITE MAZE"+STR$(MZ)+CHR$(96)+" Y"+CHR$(36)+"N   ":ELSEGOTO47
45 A$=INKEY$:IFA$=""THEN45
46 IFA$="N"THENPLAY"O1;1":GOTO49:ELSEIFA$="Y"THENPLAY"O5;12":HCOLOR4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"     ":GOTO48:ELSEGOTO45
47 NEXT
48 BZ=.:MF$="MAZE"+STR$(MZ):CLOSE #1:OPEN "O",#1,MF$:PRINT#1,PEEK(&HFFBC):FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:PRINT#1,P(Z):NEXT:NEXT:CLOSE #1:ML(MZ)=1:DT=.
49 HCOLOR4:HPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE":GOSUB23:RETURN
50 PLAY"O1;1":RETURN
51 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR4:HPRINT(9,3),"   SELECT AN ACTION     ":HCOLORBC:HPRINT(.,MZ+7),CHR$(&H2E):RETURN
52 IFY>1THENY=Y-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1+8)-(X2,Y2+8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
53 RETURN
54 IFY<19THENY=Y+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1-8)-(X2,Y2-8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
55 RETURN
56 IFX>1THENX=X-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1+8,Y1)-(X2+8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
57 RETURN
58 IFX<17THENX=X+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1-8,Y1)-(X2-8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
59 RETURN
60 IFX=9 ANDY=14THENPLAY"O1;1":RETURN
61 IFX>6 ANDX<10 ANDY>8 ANDY<12THENPLAY"O1;1":RETURN
62 PLAY"O5;12":HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE"
63 HCOLORBC:T=0:EX=.:FORMY=5TO17STEP2:FORMX=32TO36STEP2:T=T+1:Z=X-&H12+&H12*Y:IFPC(T)=P(Z)THENELSEGOTO65
64 X3=MX*8-1:Y3=MY*8-1:X4=X3+9:Y4=Y3+9:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:MA=MX:MB=MY:MC=T:B=PC(MC)
65 NEXT:NEXT
66 ONBRKGOTO101:A$=INKEY$:IFA$=""THEN66
67 ONINSTR(1,MB$,A$)GOSUB71,76,80,86,90:IFEX THENRETURNELSEGOTO66
68 RETURN
69 PLAY"O1;1":HCOLOR4:IFMZ>.THENHPRINT(9,3),"  SELECT MAZE TO LOAD " ELSE HPRINT(9,3),"   SELECT AN ACTION   "
70 HPUT(X1,Y1)-(X2,Y2),1:RETURN
71 IFMB>5THENMB=MB-2ELSERETURN
72 IF(MA=34ORMA=36)ANDMB=15THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(271,135)-(271+25,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO74
73 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(X3,Y3+16)-(X4,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B
74 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
75 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
76 IFMB<17THENMB=MB+2ELSERETURN
77 IF(MA=34ORMA=36)ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(271,135)-(271+25,Y4),2:HCOLOR9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
78 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:B=PC(MC):HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
79 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
80 IFMA>32THENMA=MA-2ELSERETURN
81 IFMA=34ANDMB=17THENMA=MA-2:MC=MC-1
82 IFMA=32ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(271,Y3)-(271+25,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO84
83 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(X3+16,Y3)-(X4+16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B
84 IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
85 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
86 IFMA<36THENIFMA=34ANDMB=17THENRETURNELSEMA=MA+2:ELSERETURN
87 IFMA=34ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(271,135)-(271+25,Y4),2:HCOLOR9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
88 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:B=PC(MC):HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
89 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
90 IF(MA=34ORMA=36)ANDMB=17THENCB$=CHR$(94)+CHR$(10)+CHR$(13)ELSEGOTO95
91 PLAY"O5;12":NC=PEEK(&HFFBC):OC=NC:CE=.:CB$=CHR$(94)+CHR$(10)+CHR$(13):HCOLOR4:HPRINT(9,3)," UP"+CHR$(37)+"DOWN CHANGES COLOR "
92 ONBRKGOTO109:A$=INKEY$:IFA$=""THEN92
93 ONINSTR(1,CB$,A$)GOSUB104,106,108
94 IFCE THENRETURN:ELSEGOTO92
95 IFPP=4ANDB=37THENPLAY"O1;1":RETURN
96 IFP(Z)=37ANDB<>37THENPP=PP-1:IFPP=3THENA(3)=0:HCOLOR7:HPRINT(1,6),A$(3)
97 IFB=37THENPP=PP+1:IFPP=4THENA(3)=1:HCOLOR4:HPRINT(1,6),A$(3)
98 PLAY"O5;12":HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":IFDT THENELSEIFP(Z)=B THENELSEDT=NOT.:HCOLOR4:HPRINT(1,6),A$(3)
99 P(Z)=B:HPUT(X1,Y1)-(X2,Y2),1:IFB=&H24 THENHCOLOR9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
100 HPRINT(X+&HB,Y+&H4),CHR$(B):HGET(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B:HPUT(X3,Y3)-(X4,Y4),2:EX=NOT.:RETURN
101 PLAY"O1;1":HCOLOR4:HPRINT(9,3)," SELECT TILE TO CHANGE ":HPUT(X1,Y1)-(X2,Y2),1:HCOLOR9:HLINE(X1,Y1)-(X2,Y2),PSET,B
102 IF(MA=34ORMA=36)ANDMB=17THENHPUT(271,Y3)-(271+25,Y4),2ELSEHPUT(X3,Y3)-(X4,Y4),2
103 EX=NOT.:RETURN
104 NC=NC+1:IFNC>63THENNC=0
105 POKE&HFFBC,NC:RETURN
106 NC=NC-1:IFNC<0THENNC=63
107 POKE&HFFBC,NC:RETURN
108 PLAY"O5;12":CE=NOT.:HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":GOTO66
109 PLAY"O1;1":HCOLOR4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":POKE&HFFBC,OC:RETURN
110 GOTO110
111 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR9:HPRINT(9,3),"   EXIT MANAGER"+CHR$(96)+" Y"+CHR$(36)+"N  "
112 A$=INKEY$:IFA$=""THEN112
113 IFA$="N"THENHCOLOR4:HPRINT(9,3),"   SELECT AN ACTION     ":GOTO11:ELSEIFA$="Y"THENPOKE&HE66C,0:RGB:RUN"*.BAS":ELSEGOTO112
114 DATA"NEW",1,"LOAD",1,"SAVE",0,91,45,93,58,47,44,92,43,94,40,38,39,42,101,32,46,36,37,41,67,82
