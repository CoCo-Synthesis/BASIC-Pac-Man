0 REM decb copy MAZEMAKR.BAS HDBDOS.DSK,MAZEMGR.BAS:144 -0 -a -l -t -r
51 DATA "NEW",1,"LOAD",1,"SAVE",0
60 PCLEAR1:POKE&HFFD8,0:LOADM"PACTILES.BIN":POKE&HFFD9,0:REM POKE&HADEB,57:POKE&HE414,0:POKE&HE42A,0:POKE359,255:POKE&HF00E,&H84:POKE&HF00D,&H94:POKE&HF00E,&HB3
65 ONBRK GOTO17000:HSCREEN2:HCLS0:POKE&HE649,&H10:POKE&HE664,&H0:POKE&HE666,&HB:POKE&HE66A,&H3D:POKE&HE66B,7:POKE&HE66C,&H3C:POKE&HE66D,&H3C:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,&H3F:POKE&HE673,&H1C:RGB
83 DATA 91,45,93
84 DATA 58,47,44
85 DATA 92,43,94
86 DATA 40,38,39
87 DATA 42,101,32
88 DATA 46,36,37
89 DATA 41,67,82
90 CLEAR 512:DIM P(&H156),PC(21),ML(15),A$(3),A(3),F1$,F2$:PLAY"T255;L255;V5;"
95 BC=&HC:HBUFF1,100:HBUFF2,300:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H1:HPRINT(10,0),"pacdman":HCOLOR&H4:HPRINT(18,0),"MAZE MANAGER":HPRINT(11,10),CHR$(22)+" CHECKING MAZES":HCOLOR&H1
100 D=PEEK(235):FOR S=3 TO 17:O=NOTO:DSKI$ D,17,S,F1$,F2$:HPRINT(8+S,10),CHR$(&H20)+CHR$(&H22+O):FORMZ=1TO15:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," ")
105 IF INSTR(F1$,F$) OR INSTR(F2$,F$) THENML(MZ)=1
110 NEXT:NEXT:HPRINT(8+S,10),CHR$(&H20):HCOLORBC:HPRINT(0,3),CHR$(&H5B)+STRING$(7,CHR$(&H26))+CHR$(&H5D)
120 FORAC=1TO3:READ A$(AC):READ A(AC):HPRINT(0,3+AC),CHR$(&H2E):IFA(AC)THENHCOLOR&H4 ELSEHCOLOR&H7
130 HPRINT(1,3+AC),A$(AC):HCOLORBC:HPRINT(8,3+AC),CHR$(&H2E):NEXT:HPRINT(0,AC+3),CHR$(58)+STRING$(7,CHR$(&H26))+CHR$(44):AC=1:HCOLOR&H9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(0,3+AC),CHR$(37):HCOLORBC
140 FORMZ=8TO22:HPRINT(0,MZ),CHR$(&H2E):HPRINT(8,MZ),CHR$(&H2E):NEXT:HPRINT(0,23),CHR$(92)+STRING$(7,CHR$(&H26))+CHR$(94):HCOLORBC:T=0:FORMY=5 TO17STEP2:FORMX=32 TO36STEP2:T=T+1:READB:PC(T)=B
161 IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H22 THENHCOLOR&H1:ELSEIFB=67 THENHCOLOR&HA:ELSEIFB=82 THENHCOLOR&H2:ELSEHCOLORBC
162 HPRINT(MX,MY),CHR$(B):NEXT:NEXT:HCOLOR13:HPRINT(MX-3,MY-2),"L":KB$=CHR$(94)+CHR$(10)+CHR$(13)
163 POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H4:HPRINT(12,3),"SELECT AN ACTION"
164 ONBRK GOTO17000:A$=INKEY$:IFA$=""THEN164
165 ON INSTR(1,KB$,A$) GOSUB500,600,700:GOTO164
499 REM MAZE SELECTION UP
500 IFAC>1 THEN AC=AC-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(0,4+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H9:HPRINT(0,3+AC),CHR$(37)
510 RETURN
599 REM MAZE SELECTION DOWN
600 IFAC<3 THEN AC=AC+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(0,2+AC),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H9:HPRINT(0,3+AC),CHR$(37)
610 RETURN
700 IFA(AC)THENELSE:PLAY"O1;1":RETURN
705 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H4:IFAC=2THENHPRINT(10,3)," SELECT MAZE TO LOAD":ELSEIFAC=3THENHPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE"
710 IFAC>1 THENGOTO760ELSEMZ=0:GOTO1210
760 GOSUB800:MZ=1:HCOLOR&H9:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(0,7+MZ),CHR$(37):KB$=CHR$(94)+CHR$(10)+CHR$(13)
770 ONBRK GOTO 1300:A$=INKEY$:IFA$=""THEN770
780 ON INSTR(1,KB$,A$) GOSUB 1000,1100,1200:GOTO770
799 REM UPDATE MAZE LIST
800 POKE&HF00D,&H94:POKE&HF00E,&HB3:FORMR=8 TO22:IFML(MR-7)THENHCOLOR&H4 ELSEHCOLOR&H7
810 HPRINT(1,MR),"MAZE"+STR$(MR-7):NEXT:RETURN
999 REM MAZE SELECTION UP
1000 IFMZ>1 THENMZ=MZ-1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(0,8+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H9:HPRINT(0,7+MZ),CHR$(37)
1010 RETURN
1099 REM MAZE SELECTION DOWN
1100 IFMZ<15 THENMZ=MZ+1:POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLORBC:HPRINT(0,6+MZ),CHR$(46):POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H9:HPRINT(0,7+MZ),CHR$(37)
1110 RETURN
1200 ONAC GOTO1290,1210,1260:RETURN
1210 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:IFDT THEN HCOLOR&H9:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO1214
1211 A$=INKEY$:IFA$=""THEN1211
1212 IFA$="N" THEN PLAY"O1;1":HCOLOR&H4:IFMZ>0 THENHPRINT(9,3),"  SELECT MAZE TO LOAD    ":RETURN:ELSEHPRINT(9,3),"   SELECT AN ACTION     ":RETURN:ELSEIFA$="Y" THENPLAY"O5;12":HCOLOR.:HPRINT(10,3),"LOSE MAZE CHANGES"+CHR$(96)+" Y"+CHR$(36)+"N":ELSEGOTO1211
1214 IFML(MZ) THEN MF$="MAZE"+STR$(MZ) ELSEMF$="MAZE 00"
1215 PP=.:X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+8*17+1:Y2=Y1+8*19+1:HCOLOR&H4
1216 IFMZ>0 THENHPRINT(9,3),"   LOADING MAZE"+STR$(MZ) + STRING$(3,CHR$(36))+" " ELSE HPRINT(9,3),"  CREATING A NEW MAZE   "
1217 POKE&HF00D,&H94:POKE&HF00E,&HB3:CLOSE #1:OPEN "I",#1,MF$:INPUT#1,PC
1220 POKE&HFFBC,PC:HCOLORBC:FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:INPUT#1,B:P(Z)=B:IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:PP=PP+1:ELSEIFB=&H3B THENHCOLOR&HB:ELSEIFB=&H20 THENHCOLOR&H0:ELSEIFB=&H22 THENHCOLOR&H1
1222 HPRINT(X+&HB,Y+&H4),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1:DT=.:HCOLOR&H4:HPRINT(9,3)," SELECT TILE TO CHANGE ":IFPP=4 THEN HCOLOR&H4:A(3)=1:ELSE HCOLOR&H7:A(3)=0:HPRINT(1,6),A$(3)
1223 X=1:Y=1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B:MB$=CHR$(94)+CHR$(10)+CHR$(8)+CHR$(9)+CHR$(13)
1227 ONBRK GOTO 2500:A$=INKEY$:IFA$=""THEN1227
1228 ON INSTR(1,MB$,A$) GOSUB 2000,2100,2200,2300,2400:GOTO1227
1229 HPUT(X1,Y1)-(X2,Y2),1:GOTO1223
1240 RETURN
1260 PLAY"O5;12":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"    "
1261 D=PEEK(235):FOR S=3 TO 17:DSKI$ D,17,S,F1$,F2$:F$="MAZE"+STR$(MZ):F$=F$+STRING$(8-LEN(F$)," ")
1262 IF INSTR(F1$,F$) OR INSTR(F2$,F$) THENML(MZ)=1:HCOLOR&H9:HPRINT(9,3)," OVERWRITE MAZE"+STR$(MZ)+CHR$(96)+" Y"+CHR$(36)+"N   ":ELSEGOTO1265
1263 A$=INKEY$:IFA$=""THEN1263
1264 IFA$="N" THENPLAY"O1;1":GOTO1271:ELSEIFA$="Y" THENPLAY"O5;12":HCOLOR&H4:HPRINT(9,3),"   SAVING MAZE"+STR$(MZ)+STRING$(3,CHR$(36))+"    ":GOTO1269:ELSEGOTO1263
1265 NEXT
1269 BZ=.:MF$="MAZE"+STR$(MZ):CLOSE #1:OPEN "O",#1,MF$:PRINT#1,PEEK(&HFFBC)
1270 FORY=1TO19:FORX=1TO17:Z=X-&H12+&H12*Y:PRINT#1,P(Z):NEXT:NEXT:CLOSE #1:ML(MZ)=1:DT=.
1271 HCOLOR&H4:HPRINT(9,3),"CHOOSE MAZE SLOT TO SAVE":GOSUB800:RETURN
1290 PLAY"O1;1":RETURN
1300 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H4:HPRINT(9,3),"   SELECT AN ACTION     ":HCOLORBC:HPRINT(0,MZ+7),CHR$(&H2E):RETURN
1999 REM GRID POSITION UP
2000 IFY>1 THENY=Y-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1+8)-(X2,Y2+8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B
2010 RETURN
2099 REM GRID POSITION DOWN
2100 IFY<19 THENY=Y+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1,Y1-8)-(X2,Y2-8),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B
2110 RETURN
2199 REM GRID POSITION LEFT
2200 IFX>1 THENX=X-1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1+8,Y1)-(X2+8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B
2210 RETURN
2299 REM GRID POSITION RIGHT
2300 IFX<17 THENX=X+1:X1=(X+&HB)*8-1:Y1=(Y+&H4)*8-1:X2=X1+9:Y2=Y1+9:HPUT(X1-8,Y1)-(X2-8,Y2),1:HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B
2310 RETURN
2400 IFX=9 ANDY=14THENPLAY"O1;1":RETURN
2401 IFX>6 ANDX<10 ANDY>8 ANDY<12 THENPLAY"O1;1":RETURN
2404 PLAY"O5;12":HCOLOR&H4:HPRINT(9,3),"SELECT REPLACEMENT TILE"
2405 HCOLORBC:T=0:EX=.:FORMY=5 TO17STEP2:FORMX=32 TO36STEP2:T=T+1:Z=X-&H12+&H12*Y:IFPC(T)=P(Z) THENELSEGOTO2440
2410 X3=MX*8-1:Y3=MY*8-1:X4=X3+9:Y4=Y3+9:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B:MA=MX:MB=MY:MC=T
2440 NEXT:NEXT
2450 ONBRK GOTO3500:A$=INKEY$:IFA$=""THEN2450
2460 ON INSTR(1,MB$,A$) GOSUB3000,3100,3200,3300,3400:IFEX THENRETURNELSEGOTO2450
2470 RETURN
2500 PLAY"O1;1":HCOLOR&H4:
2501 IFMZ>0 THENHPRINT(9,3),"  SELECT MAZE TO LOAD " ELSE HPRINT(9,3),"   SELECT AN ACTION   "
2502 HPUT(X1,Y1)-(X2,Y2),1:RETURN
2999 REM MENU POSITION UP
3000 IFMB>5 THENMB=MB-2 ELSERETURN
3005 IF (MA=34 OR MA=36) AND MB=15 THEN X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(271,135)-(271+25,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO3015
3010 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-3:B=PC(MC):HPUT(X3,Y3+16)-(X4,Y4+16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B
3015 IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
3030 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
3099 REM MENU POSITION DOWN
3100 IFMB<17 THENMB=MB+2 ELSERETURN
3105 IF(MA=34 OR MA=36)ANDMB=17THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(271,135)-(271+25,Y4),2:HCOLOR&H9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
3110 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+3:B=PC(MC):HPUT(X3,Y3-16)-(X4,Y4-16),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
3130 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
3199 REM MENU POSITION LEFT
3200 IFMA>32 THENMA=MA-2ELSERETURN
3201 IFMA=34 AND MB=17 THEN MA=MA-2:MC=MC-1
3205 IFMA=32 AND MB=17 THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(271,Y3)-(271+25,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B:GOTO3215
3210 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC-1:B=PC(MC):HPUT(X3+16,Y3)-(X4+16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B
3215 IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
3230 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
3299 REM MENU POSITION RIGHT
3300 IFMA<36 THEN IFMA=34 AND MB=17 THENRETURN ELSE MA=MA+2:ELSERETURN
3305 IFMA=34 AND MB=17 THENX3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(271,135)-(271+25,Y4),2:HCOLOR&H9:HLINE(271,135)-(271+25,Y4),PSET,B:HPUT(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B:RETURN
3310 X3=MA*8-1:Y3=MB*8-1:X4=X3+9:Y4=Y3+9:MC=MC+1:B=PC(MC):HPUT(X3-16,Y3)-(X4-16,Y4),2:HGET(X3,Y3)-(X4,Y4),2:HCOLOR&H9:HLINE(X3,Y3)-(X4,Y4),PSET,B:IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
3330 HPRINT(X+&HB,Y+&H4),CHR$(B):RETURN
3399 REM MENU CELL SELECTED
3400 IF (MA=34 OR MA=36) AND MB=17 THENCB$=CHR$(94)+CHR$(10)+CHR$(13) ELSEGOTO3405
3401 PLAY"O5;12":NC=PEEK(&HFFBC):OC=NC:CE=.:CB$=CHR$(94)+CHR$(10)+CHR$(13):HCOLOR&H4:HPRINT(9,3)," UP"+CHR$(37)+"DOWN CHANGES COLOR "
3402 ONBRK GOTO4500:A$=INKEY$:IFA$=""THEN3402
3403 ON INSTR(1,CB$,A$) GOSUB4000,4100,4200
3404 IFCE THENRETURN:ELSEGOTO3402
3405 IF PP=4 AND B=37 THENPLAY"O1;1":RETURN
3406 IF P(Z)=37 AND B<>37 THENPP=PP-1:IFPP=3 THEN A(3)=0:HCOLOR&H7:HPRINT(1,6),A$(3)
2407 IF B=37 THENPP=PP+1:IFPP=4 THEN A(3)=1:HCOLOR&H4:HPRINT(1,6),A$(3)
3407 PLAY"O5;12":HCOLOR&H4:HPRINT(9,3)," SELECT TILE TO CHANGE " 
3409 IFDT THENELSEIFP(Z)=B THENELSEDT=NOT.
3410 P(Z)=B:HPUT(X1,Y1)-(X2,Y2),1:IFB=&H24 THENHCOLOR&H9:ELSEIFB=&H25 THENHCOLOR&HE:ELSEHCOLORBC
3420 HPRINT(X+&HB,Y+&H4),CHR$(B):HGET(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B:HPUT(X3,Y3)-(X4,Y4),2:EX=NOT.:RETURN
3500 PLAY"O1;1":HCOLOR&H4:HPRINT(9,3)," SELECT TILE TO CHANGE "
3510 HPUT(X1,Y1)-(X2,Y2),1:HCOLOR&H9:HLINE(X1,Y1)-(X2,Y2),PSET,B
3515 IF (MA=34 OR MA=36) AND MB=17 THENHPUT(271,Y3)-(271+25,Y4),2 ELSEHPUT(X3,Y3)-(X4,Y4),2
3520 EX=NOT.:RETURN
4000 NC=NC+1:IFNC>63 THEN NC=0
4010 POKE&HFFBC,NC:RETURN
4100 NC=NC-1:IFNC<0 THEN NC=63
4110 POKE&HFFBC,NC:RETURN
4200 PLAY"O5;12":CE=NOT.:HCOLOR&H4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":GOTO2450
4500 PLAY"O1;1":HCOLOR&H4:HPRINT(9,3),"SELECT REPLACEMENT TILE ":POKE&HFFBC,OC:RETURN
16200 GOTO 16200
17000 PLAY"O1;1":POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H9:HPRINT(9,3),"   EXIT MANAGER"+CHR$(96)+" Y"+CHR$(36)+"N  "
17010 A$=INKEY$:IFA$=""THEN17010
17020 IFA$="N" THENHCOLOR&H4:HPRINT(9,3),"   SELECT AN ACTION     ":GOTO164:ELSEIFA$="Y" THENRGB:END:ELSEGOTO17010