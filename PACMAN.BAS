350 GOTO16000
376 A=X:C=Y:G=Z:OS=S
377 IFPW THENCD=CD-&H1:IFM1+M2+M3+M4 THENELSEPW=.:CD=.
380 O=NOTO:POKE&HFFBE,&H3C:GOSUB1000:FT=FT-&H1:POKE&HFFBB,RND(&H3F):POKE&HFFBE,&H3F:IFFT=. GOSUB880
447 OD=PD:OB=B:ONFIX(JOYSTK(.)/&H16)+&H1 GOTO451,453,452
451 PD=&H3:B=&H7C:GOTO460
452 PD=&H4:B=&H22:GOTO463
453 ONFIX(JOYSTK(&H1)/&H16)+&H1 GOTO454,456,455
454 PD=&H1:B=&H6B:GOTO458
455 PD=&H2:B=&H7B:GOTO459
456 ONPD GOTO458,459,460,463:GOTO500
458 Y=Y-&H1:GOTO500
459 Y=Y+&H1:GOTO500
460 X=X-&H1:IFX=&H1D THENX=&HC:GOTO500
461 IFX=&HB THENX=&H1C:GOTO500
462 GOTO500
463 X=X+&H1:IFX=&H1D THENX=&HC:GOTO500
464 IFX=&HB THENX=&H1C
500 Z=X-&H53+Y*&H12:IFP(Z)GOTO540
501 X=A:Y=C:Z=G:PD=OD:B=OB:ONOD GOTO524,526,528,532:GOTO540
524 Y=Y-&H1:Z=X-&H53+Y*&H12:IFP(Z)GOTO500
525 X=A:Y=C:Z=G:PD=OD:GOTO377
526 Y=Y+&H1:Z=X-&H53+Y*&H12:IFP(Z)GOTO500
527 X=A:Y=C:Z=G:PD=OD:GOTO377
528 X=X-&H1:IFX=&H1D THENX=&HC:GOTO530
529 IFX=&HB THENX=&H1C
530 Z=X-&H53+Y*&H12:IFP(Z)GOTO500
531 X=A:Y=C:Z=G:PD=OD:GOTO377
532 X=X+&H1:IFX=&H1D THENX=&HC:GOTO534
533 IFX=&HB THENX=&H1C
534 Z=X-&H53+Y*&H12:IFP(Z)GOTO500
535 X=A:Y=C:Z=G:PD=OD:GOTO377
540 HCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(B):GOTO560
550 HPRINT(X,Y),CHR$(&H21)
560 HPRINT(A,C),CHR$(&H20):W=NOTW:IFZ-Z1 THENELSEGOSUB9000
562 IFZ-Z2 THENELSEGOSUB9100
563 IFZ-Z3 THENELSEGOSUB9200
564 IFZ-Z4 THENELSEGOSUB9300
570 U=P(Z):ONU GOTO572,600,600,600,580,600,600,600,600,590:GOTO600
572 S=S+U:P(Z)=&H2:PP=PP-&H1:IFW THENPLAY"V20;O4;1;V15;3":GOTO790
573 PLAY"V20;O4;3;V15;1":GOTO790
580 PLAY"V18;O3;2;V24;O2;12;V29;7;V24;3;V16;O1;12;V14;7;V3;7;7;V8;7;V26;7;V19;12;V24;O2;3;V31;3;V25;7;V15;9;V20;9;V27;12;V18;O3;2;V11;3;V4;3;V2;3;V3;3;3;V2;3;3;V1;3;V15"
581 S=S+U:P(Z)=&H2:PL=PL+&H1:PW=&H1:M1=NOTJ1:M2=NOTJ2:M3=NOTJ3:M4=NOTJ4:CD=CT:K=.:RGB:GOTO790
590 PLAY"V27;O3;2;V29;O2;12;9;V28;7;4;4;O1;12;V31;7;V29;1;V27;1;V23;1;V27;1;V29;1;V30;7;V29;12;V27;O2;4;4;V28;7;V29;9;V28;12;O3;2;2;V27;4;V12;O1;1;V4;1;V1;1;V15":S=S+FR*&HA:P(Z)=&H2:GOTO790
600 PLAY"V5;O1;C;G;V15":IFS-OS GOTO790
615 IFPP=. ANDPL=&H4 THENFR=FR+&H1:HCOLOR&H0:HPRINT(X,Y),CHR$(&H20):HPRINT(X1,Y1),CHR$(&H20):HPRINT(X2,Y2),CHR$(&H20):HPRINT(X3,Y3),CHR$(&H20):HPRINT(X4,Y4),CHR$(&H20):GOTO16085
616 GOTO376
790 S$=MID$(STR$(S),&H2):PO=LEN(S$):HCOLOR&H4:HPRINT(&H25-PO,&H6),S$:IFS-LM>&H3E7 THENPLAY"T255;L255;XE1$;XE2$;XE3$;":LM=LM+&H3E8:NL=NL+&H1:HCOLOR&H1:HPRINT(&HC,&H17),STRING$(NL-&H1,CHR$(&H22)):GOTO615
791 GOTO615
880 OC=NOTOC:IFOC THENP(&HCF)=&HA:ONFR GOTO890,891,892,893,894,895,896:GOTO900
881 GOTO900
890 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3C):HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H3D):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H3E):FT=30:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
891 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3F):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=27:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
892 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H7:HPRINT(&H14,&HF),CHR$(&H23):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=24:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
893 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H62):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=21:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
894 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H79):HCOLOR&HF:HPRINT(&H14,&HF),CHR$(&H7A):FT=18:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
895 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H6F):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):FT=15:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
896 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H1:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):FT=12:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
900 HPRINT(&H14,&HF),CHR$(&H20):P(&HCF)=&HF:FT=30:RETURN
910 P(&HCF)=&HA:HPRINT(&H14,&HF),CHR$(&H20):ONFR GOTO920,921,922,923,924,925,926:GOTO927
920 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3C):HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H3D):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H3E):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
921 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3F):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
922 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H7:HPRINT(&H14,&HF),CHR$(&H23):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
923 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H62):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
924 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H79):HCOLOR&HF:HPRINT(&H14,&HF),CHR$(&H7A):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
925 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H6F):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
926 FT=30:CT=5:R1=.:R2=4:R3=8:R4=12:HCOLOR&H1:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
927 HPRINT(&H14,&HF),CHR$(&H20):P(&HCF)=&HF:RETURN
1000 IFR1 THENR1=R1-&H1:FORT=1TO40:NEXT:HCOLORC1:G1=&H77+O:HPRINT(X1,Y1),CHR$(G1+O*&HE):FORT=1TO40:NEXT:GOTO2000
1010 IFM1 ANDO THENFORT=1TO100:NEXT:GOTO2000
1011 A1=X1:B1=Y1:AB=Z1:IFPW GOSUB1020
1012 ONJ1+&H1 GOTO1030:GOTO1050
1020 IFCD=. THENM1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
1021 IFCD<&H7 THENPOKE&HFFB2,&H3F:POKE&HFFB8,&H24
1023 RETURN
1030 IFM1 THENOND1 GOSUB1700,1750,1800,1850:GOTO1555
1031 OND1 GOTO1100,1200,1300,1400:GOTO1555
1050 IFZ1=&HAB THEND1=&H1:GOTO1555
1051 IFZ1=&HAC THEND1=&H3:GOTO1555
1052 IFZ1=&HAA THEND1=&H4:GOTO1555
1053 GOTO1555
1100 U=P(Z1+&H1):IFU ANDX1<X THEND1=&H4:GOTO1550
1101 IFP(Z1-&H12)THEND1=&H1:GOTO1550
1102 IFU THEND1=&H4:GOTO1550
1103 IFP(Z1-&H1)THEND1=&H3:GOTO1550
1104 GOTO1550
1200 IFP(Z1-&H1)ANDX1>X THEND1=&H3:GOTO1550
1201 U=P(Z1+&H1):IFU ANDX1<X THEND1=&H4:GOTO1550
1202 IFP(Z1+&H12)THEND1=&H2:GOTO1550
1203 IFU THEND1=&H4:GOTO1550
1204 D1=&H3:GOTO1550
1300 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:GOTO1550
1301 U=P(Z1+&H12):IFU ANDY1<Y THEND1=&H2:GOTO1550
1302 IFP(Z1-&H1)THEND1=&H3:GOTO1550:
1303 IFU THEND1=&H2:GOTO1550
1304 IFQ THEND1=&H1:GOTO1550
1305 GOTO1550
1400 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:GOTO1550
1401 U=P(Z1+&H12):IFU ANDY1<Y THEND1=&H2:GOTO1550
1402 IFP(Z1+&H1)THEND1=&H4:GOTO1550
1403 IFU THEND1=&H2:GOTO1550
1404 IFQ THEND1=&H1
1550 G1=&H73+D1
1555 OND1 GOTO1557,1560,1570,1580
1557 Y1=Y1-&H1:W1=NOTW1:GOTO1600
1560 Y1=Y1+&H1:W1=NOTW1:GOTO1600
1570 X1=X1-&H1:W1=NOTW1:GOTO1600
1580 X1=X1+&H1:W1=NOTW1
1600 IFX1=&H1D THENX1=&HC:R1=M1+&H1:GOTO1615
1601 IFX1=&HB THENX1=&H1C:IFM THENR1=M1+&H1
1615 Z1=X1-&H53+Y1*&H12:IFZ1=&H99 THENM1=.:GOTO1622
1616 IFM1 THEN POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X1,Y1),CHR$(&H7E):HCOLOR&H2:HPRINT(X1,Y1),CHR$(&H78+W1*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO1625
1622 HCOLORC1:HPRINT(X1,Y1),CHR$(G1+W1*&HE):IFZ1=&H99 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X1,Y1),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J1=.:GOTO1625
1623 IFAB=&H99 THENHCOLOR&HB:HPRINT(A1,B1),CHR$(&H3B):GOTO1661
1625 IFAB=Z2 THENIFM2 GOTO1630ELSEGOTO1635:ELSEIFAB=Z3 THENIFM3 GOTO1630ELSEGOTO1636:ELSEIFAB=Z4 THENIFM4 GOTO1630ELSEGOTO1637:ELSEGOTO1640
1630 HCOLOR&H8:HPRINT(A1,B1),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A1,B1),CHR$(&H78+W1*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO1661
1635 HCOLORC2:HPRINT(A1,B1),CHR$(G2):GOTO1661
1636 HCOLORC3:HPRINT(A1,B1),CHR$(G3):GOTO1661
1637 HCOLORC4:HPRINT(A1,B1),CHR$(G4):GOTO1661
1640 U=P(AB):IFU=&H1 THENHCOLOR&H9:HPRINT(A1,B1),CHR$(&H24):GOTO1661
1641 IFU=&H5 THENHCOLOR&HE:HPRINT(A1,B1),CHR$(&H25):GOTO1661
1642 IFU=&HA GOSUB910:GOTO1661
1643 HPRINT(A1,B1),CHR$(&H20)
1661 IFZ-Z1 GOTO2000
1662 GOSUB9000:GOTO2000
1700 U=P(Z1+&H1):IFU ANDX1>X THEND1=&H4:RETURN
1701 IFP(Z1-&H12)THEND1=&H1:RETURN
1702 IFU THEND1=&H4:RETURN
1703 IFP(Z1-&H1)THEND1=&H3:RETURN
1704 RETURN
1750 IFP(Z1-&H1)ANDX1<X THEND1=&H3:RETURN
1751 U=P(Z1+&H1):IFU ANDX1>X THEND1=&H4:RETURN
1752 IFP(Z1+&H12)THEND1=&H2:RETURN
1753 IFU THEND1=&H4:RETURN
1754 D1=&H3:RETURN
1800 Q=P(Z1-&H12):IFQ ANDY1<Y THEND1=&H1:RETURN
1801 U=P(Z1+&H12):IFU ANDY1>Y THEND1=&H2:RETURN
1802 IFP(Z1-&H1)THEND1=&H3:RETURN
1803 IFU THEND1=&H2:RETURN
1804 IFQ THEND1=&H1:RETURN
1805 RETURN
1850 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:RETURN
1851 U=P(Z1+&H12):IFU ANDY1>Y THEND1=&H2:RETURN
1852 IFP(Z1+&H1)THEND1=&H4:RETURN
1853 IFU THEND1=&H2:RETURN
1854 IFQ THEND1=&H1:RETURN
1855 RETURN
2000 IFR2 THENR2=R2-&H1:FORT=1TO40:NEXT:HCOLORC2:G2=&H76+O:HPRINT(X2,Y2),CHR$(G2+O*&HE):FORT=1TO40:NEXT:GOTO3000
2010 IFM2 ANDO THENFORT=1TO100:NEXT:GOTO3000
2011 A2=X2:B2=Y2:AB=Z2:IFPW GOSUB2020
2012 ONJ2+&H1 GOTO2030:GOTO2050
2020 IFCD=. THENM1=.:M2=.:M3=.:M4=.:PW=.:RGB
2021 RETURN
2030 IFM2 THENOND2 GOSUB2700,2750,2800,2850:GOTO2555
2031 OND2 GOTO2100,2200,2300,2400:GOTO2555
2050 IFZ2=&HAB THEND2=&H1:GOTO2555
2051 IFZ2=&HAC THEND2=&H3:GOTO2555
2052 IFZ2=&HAA THEND2=&H4:GOTO2555
2053 GOTO2555
2100 Q=P(Z2-&H1):IFQ ANDX2>X THEND2=&H3:GOTO2550
2101 U=P(Z2+&H1):IFU ANDX2<X THEND2=&H4:GOTO2550
2102 IFP(Z2-&H12)THEND2=&H1:GOTO2550
2103 IFU THEND2=&H4:GOTO2550
2104 IFQ THEND2=&H3:GOTO2550
2105 GOTO2550
2200 IFP(Z2-&H1)ANDX2>X THEND2=&H3:GOTO2550
2201 U=P(Z2+&H1):IFU ANDX2<X THEND2=&H4:GOTO2550
2202 IFP(Z2+&H12)THEND2=&H2:GOTO2550
2203 IFU THEND2=&H4:GOTO2550
2204 D2=&H3:GOTO2550
2300 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:GOTO2550
2301 U=P(Z2+&H12):IFU ANDY2<Y THEND2=&H2:GOTO2550
2302 IFP(Z2-&H1)THEND2=&H3:GOTO2550
2303 IFU THEND2=&H2:GOTO2550
2304 IFQ THEND2=&H1:GOTO2550
2305 GOTO2550
2400 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:GOTO2550
2401 U=P(Z2+&H12):IFU ANDY2<Y THEND2=&H2:GOTO2550
2402 IFP(Z2+&H1)THEND2=&H4:GOTO2550
2403 IFU THEND2=&H2:GOTO2550
2404 IFQ THEND2=&H1
2550 G2=&H73+D2
2555 OND2 GOTO2557,2560,2570,2580
2557 Y2=Y2-&H1:W2=NOTW2:GOTO2600
2560 Y2=Y2+&H1:W2=NOTW2:GOTO2600
2570 X2=X2-&H1:W2=NOTW2:GOTO2600
2580 X2=X2+&H1:W2=NOTW2
2600 IFX2=&H1D THENX2=&HC:R2=M2+&H1:GOTO2615
2601 IFX2=&HB THENX2=&H1C:R2=M2+&H1
2615 Z2=X2-&H53+Y2*&H12:IFZ2=&H99 THENM2=.:GOTO2622
2616 IFM2 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X2,Y2),CHR$(&H7E):HCOLOR&H2:HPRINT(X2,Y2),CHR$(&H78+W2*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO2625
2622 HCOLORC2:HPRINT(X2,Y2),CHR$(G2+W2*&HE):IFZ2=&H99 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X2,Y2),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J2=.:GOTO2625
2623 IFAB=&H99 THENHCOLOR&HB:HPRINT(A2,B2),CHR$(&H3B):GOTO2661
2625 IFAB=Z3 THENIFM3 GOTO2630ELSEGOTO2635:ELSEIFAB=Z4 THENIFM4 GOTO2630ELSEGOTO2636:ELSEIFAB=Z1 THENIFM1 GOTO2630ELSEGOTO2637:ELSEGOTO2640
2630 HCOLOR&H8:HPRINT(A2,B2),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A2,B2),CHR$(&H78+W2*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO2661
2635 HCOLORC3:HPRINT(A2,B2),CHR$(G3):GOTO2661
2636 HCOLORC4:HPRINT(A2,B2),CHR$(G4):GOTO2661
2637 HCOLORC1:HPRINT(A2,B2),CHR$(G1):GOTO2661
2640 U=P(AB):IFU=&H1 THENHCOLOR&H9:HPRINT(A2,B2),CHR$(&H24):GOTO2661
2641 IFU=&H5 THENHCOLOR&HE:HPRINT(A2,B2),CHR$(&H25):GOTO2661
2642 IFU=&HA GOSUB910:GOTO2661
2643 HPRINT(A2,B2),CHR$(&H20)
2661 IFZ-Z2 GOTO3000
2662 GOSUB9100:GOTO3000
2700 Q=P(Z2-&H1):IFQ ANDX2<X THEND2=&H3:RETURN
2701 U=P(Z2+&H1):IFU ANDX2>X THEND2=&H4:RETURN
2702 IFP(Z2-&H12)THEND2=&H1:RETURN
2703 IFU THEND2=&H4:RETURN
2704 IFQ THEND2=&H3:RETURN
2705 RETURN
2750 IFP(Z2-&H1)ANDX2<X THEND2=&H3:RETURN
2751 U=P(Z2+&H1):IFU ANDX2>X THEND2=&H4:RETURN
2752 IFP(Z2+&H12)THEND2=&H2:RETURN
2753 IFU THEND2=&H4:RETURN
2754 D2=&H3:RETURN
2800 Q=P(Z2-&H12):IFQ ANDY2<Y THEND2=&H1:RETURN
2801 U=P(Z2+&H12):IFU ANDY2>Y THEND2=&H2:RETURN
2803 IFP(Z2-&H1)THEND2=&H3:RETURN
2804 IFU THEND2=&H2:RETURN
2805 IFQ THEND2=&H1:RETURN
2806 RETURN
2850 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:RETURN
2851 U=P(Z2+&H12):IFU ANDY2>Y THEND2=&H2:RETURN
2852 IFP(Z2+&H1)THEND2=&H4:RETURN
2853 IFU THEND2=&H2:RETURN
2854 IFQ THEND2=&H1:RETURN
2855 RETURN
3000 IFR3 THENR3=R3-&H1:FORT=1TO40:NEXT:HCOLORC3:G3=&H75+O:HPRINT(X3,Y3),CHR$(G3+O*&HE):FORT=1TO40:NEXT:GOTO4000
3001 IFO GOTO4000
3010 A3=X3:B3=Y3:AB=Z3:IFPW GOSUB3020
3011 ONJ3+&H1 GOTO3030:GOTO3050
3020 IFCD=. THENM1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
3021 IFCD<&H7 THENRGB
3022 RETURN
3030 IFM3 THENOND3 GOSUB3700,3750,3800,3850:GOTO3555
3031 OND3 GOTO3100,3200,3300,3400:GOTO3555
3050 IFZ3=&HAB THEND3=&H1:GOTO3555
3051 IFZ3=&HAC THEND3=&H3:GOTO3555
3052 IFZ3=&HAA THEND3=&H4:GOTO3555
3053 GOTO3555
3100 U=P(Z3-&H1):IFU ANDX3>X THEND3=&H3:GOTO3550
3101 IFP(Z3-&H12)THEND3=&H1:GOTO3550
3102 IFP(Z3+&H1)THEND3=&H4:GOTO3550
3103 IFU THEND3=&H3:GOTO3550
3104 GOTO3550
3200 U=P(Z3-&H1):IFU ANDX3>X THEND3=&H3:GOTO3550
3201 IFP(Z3+&H12)THEND3=&H2:GOTO3550
3202 IFP(Z3+&H1)THEND3=&H4:GOTO3550
3203 IFU THEND3=&H3:GOTO3550
3204 D3=&H3:GOTO3550
3300 U=P(Z3-&H12):IFU ANDY3>Y THEND3=&H1:GOTO3550
3301 IFP(Z3-&H1)THEND3=&H3:GOTO3550
3302 IFP(Z3+&H12)THEND3=&H2:GOTO3550
3303 IFU THEND3=&H1:GOTO3550
3304 GOTO3550
3400 IFP(Z3+&H1)THEND3=&H4:GOTO3550
3401 IFP(Z3+&H12)THEND3=&H2:GOTO3550
3402 IFP(Z3-&H12)THEND3=&H1
3550 G3=&H73+D3
3555 OND3 GOTO3557,3560,3570,3580
3557 Y3=Y3-&H1:W3=NOTW3:GOTO3600
3560 Y3=Y3+&H1:W3=NOTW3:GOTO3600
3570 X3=X3-&H1:W3=NOTW3:GOTO3600
3580 X3=X3+&H1:W3=NOTW3
3600 IFX3=&H1D THENX3=&HC:R3=M3+&H1:GOTO3615
3601 IFX3=&HB THENX3=&H1C:R3=M3+&H1
3615 Z3=X3-&H53+Y3*&H12:IFZ3=&H99 THENM3=.:GOTO3622
3616 IFM3 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X3,Y3),CHR$(&H7E):HCOLOR&H2:HPRINT(X3,Y3),CHR$(&H78+W3*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO3625
3622 HCOLORC3:HPRINT(X3,Y3),CHR$(G3+W3*&HE):IFZ3=&H99 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X3,Y3),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J3=.:GOTO3625
3623 IFAB=&H99 THENHCOLOR&HB:HPRINT(A3,B3),CHR$(&H3B):GOTO3661
3625 IFAB=Z4 THENIFM4 GOTO3630ELSEGOTO3635:ELSEIFAB=Z1 THENIFM1 GOTO3630ELSEGOTO3636:ELSEIFAB=Z2 THENIFM2 GOTO3630ELSEGOTO3637:ELSEGOTO3640
3630 HCOLOR&H8:HPRINT(A3,B3),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A3,B3),CHR$(&H78+W3*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO3661
3635 HCOLORC4:HPRINT(A3,B3),CHR$(G4):GOTO3661
3636 HCOLORC1:HPRINT(A3,B3),CHR$(G1):GOTO3661
3637 HCOLORC2:HPRINT(A3,B3),CHR$(G2):GOTO3661
3640 U=P(AB):IFU=&H1 THENHCOLOR&H9:HPRINT(A3,B3),CHR$(&H24):GOTO3661
3641 IFU=&H5 THENHCOLOR&HE:HPRINT(A3,B3),CHR$(&H25):GOTO3661
3642 IFU=&HA GOSUB910:GOTO3661
3643 HPRINT(A3,B3),CHR$(&H20)
3661 IFZ-Z3 GOTO4000
3662 GOSUB9200:GOTO4000
3700 U=P(Z3-&H1):IFU ANDX3<X THEND3=&H3:RETURN
3701 IFP(Z3-&H12)THEND3=&H1:RETURN
3702 IFP(Z3+&H1)THEND3=&H4:RETURN
3703 IFU THEND3=&H3:RETURN
3704 RETURN
3750 U=P(Z3-&H1):IFU ANDX3<X THEND3=&H3:RETURN
3751 IFP(Z3+&H12)THEND3=&H2:RETURN
3752 IFP(Z3+&H1)THEND3=&H4:RETURN
3753 IFU THEND3=&H3:RETURN
3754 D3=&H3:RETURN
3800 U=P(Z3-&H12):IFU ANDY3<Y THEND3=&H1:RETURN
3801 IFP(Z3-&H1)THEND3=&H3:RETURN
3802 IFP(Z3+&H12)THEND3=&H2:RETURN
3803 IFU THEND3=&H1:RETURN
3804 RETURN
3850 U=P(Z3-&H12):IFU ANDY3>Y THEND3=&H1:RETURN
3851 IFP(Z3+&H1)THEND3=&H4:RETURN
3852 IFP(Z3+&H12)THEND3=&H2:RETURN
3853 IFU THEND3=&H1:RETURN
3854 RETURN
4000 IFR4 THENR4=R4-&H1:FORT=1TO40:NEXT:HCOLORC4:G4=&H77+O*2:HPRINT(X4,Y4),CHR$(G4+O*&HE):FORT=1TO40:NEXT:RETURN
4001 IFO THENELSERETURN
4010 A4=X4:B4=Y4:AB=Z4:IFPW GOSUB4020
4011 ONJ4+&H1 GOTO4030:GOTO4050
4020 IFCD=. THENM1=.:M2=.:M3=.:M4=.:PW=.:RGB
4021 RETURN
4030 IFM4 THENOND4 GOSUB4700,4750,4800,4850:GOTO4555
4031 OND4 GOTO4100,4200,4300,4400:GOTO4555
4050 IFZ4=&HAB THEND4=&H1:GOTO4555
4051 IFZ4=&HAC THEND4=&H3:GOTO4555
4052 IFZ4=&HAA THEND4=&H4:GOTO4555
4053 GOTO4555
4100 U=P(Z4-&H1):IFU ANDX4>X THEND4=&H3:GOTO4550
4101 IFP(Z4-&H12)THEND4=&H1:GOTO4550
4102 IFP(Z4+&H1)THEND4=&H4:GOTO4550
4103 IFU THEND4=&H3:GOTO4550
4104 GOTO4550
4200 IFP(Z4+&H12)THEND4=&H2:GOTO4550
4201 IFP(Z4+&H1)THEND4=&H4:GOTO4550
4202 IFP(Z4-&H1)THEND4=&H3:GOTO4550
4203 D4=&H3:GOTO4550
4300 IFP(Z4-&H1)THEND4=&H3:GOTO4550
4301 IFP(Z4+&H12)THEND4=&H2:GOTO4550
4302 IFP(Z4-&H12)THEND4=&H1:GOTO4550
4303 GOTO4550
4400 IFP(Z4+&H1)THEND4=&H4:GOTO4550
4401 IFP(Z4+&H12)THEND4=&H2:GOTO4550
4402 IFP(Z4-&H12)THEND4=&H1
4550 G4=&H73+D4
4555 OND4 GOTO4557,4560,4570,4580
4557 Y4=Y4-&H1:W4=NOTW4:GOTO4600
4560 Y4=Y4+&H1:W4=NOTW4:GOTO4600
4570 X4=X4-&H1:W4=NOTW4:GOTO4600
4580 X4=X4+&H1:W4=NOTW4
4600 IFX4=&H1D THENX4=&HC:R4=M4+&H1:GOTO4615
4601 IFX4=&HB THENX4=&H1C:R4=M4+&H1
4615 Z4=X4-&H53+Y4*&H12:IFZ4=&H99 THENM4=.:GOTO4622
4616 IFM4 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X4,Y4),CHR$(&H7E):HCOLOR&H2:HPRINT(X4,Y4),CHR$(&H78+W4*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO4625
4622 HCOLORC4:HPRINT(X4,Y4),CHR$(G4+W4*&HE):IFZ4=&H99 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X4,Y4),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J4=.:GOTO4625
4623 IFAB=&H99 THENHCOLOR&HB:HPRINT(A4,B4),CHR$(&H3B):GOTO4661
4625 IFAB=Z1 THENIFM1 GOTO4630ELSEGOTO4635:ELSEIFAB=Z2 THENIFM2 GOTO4630ELSEGOTO4636:ELSEIFAB=Z3 THENIFM3 GOTO4630ELSEGOTO4637:ELSEGOTO4640
4630 HCOLOR&H8:HPRINT(A4,B4),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A4,B4),CHR$(&H78+W4*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO4661
4635 HCOLORC1:HPRINT(A4,B4),CHR$(G1):GOTO4661
4636 HCOLORC2:HPRINT(A4,B4),CHR$(G2):GOTO4661
4637 HCOLORC3:HPRINT(A4,B4),CHR$(G3):GOTO4661
4640 U=P(AB):IFU=&H1 THENHCOLOR&H9:HPRINT(A4,B4),CHR$(&H24):GOTO4661
4641 IFU=&H5 THENHCOLOR&HE:HPRINT(A4,B4),CHR$(&H25):GOTO4661
4642 IFU=&HA GOSUB910:GOTO4661
4643 HPRINT(A4,B4),CHR$(&H20)
4661 IFZ-Z4 THENRETURN
4662 GOSUB9300:RETURN
4700 U=P(Z4-&H1):IFU ANDX4<X THEND4=&H3:RETURN
4701 IFP(Z4-&H12)THEND4=&H1:RETURN
4702 IFP(Z4+&H1)THEND4=&H4:RETURN
4703 IFU THEND4=&H3:RETURN
4704 RETURN
4750 IFP(Z4+&H12)THEND4=&H2:RETURN
4751 IFP(Z4+&H1)THEND4=&H4:RETURN
4752 IFP(Z4-&H1)THEND4=&H3:RETURN
4753 D4=&H3:RETURN
4800 IFP(Z4+&H12)THEND4=&H2:RETURN
4801 IFP(Z4-&H1)THEND4=&H3:RETURN
4802 IFP(Z4-&H12)THEND4=&H1:RETURN
4803 RETURN
4850 IFP(Z4+&H1)THEND4=&H4:RETURN
4851 IFP(Z4+&H12)THEND4=&H2:RETURN
4852 IFP(Z4-&H12)THEND4=&H1:RETURN
4853 RETURN
9000 IFM1 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO10000
9005 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y1=&HD:M1=.:D1=&H1:G1=&H73+W1:R1=&H14-FR:J1=NOT.:K=K+&H1
9006 IFNOT(Z2=&HAC ORZ3=&HAC ORZ4=&HAC)THENZ1=&HAC:X1=&H15:W1=NOT.:D1=&H3:ELSEIFNOT(Z2=&HAA ORZ3=&HAA ORZ4=&HAA)THENZ1=&HAA:X1=&H13:W1=NOT.:D1=&H4:ELSEZ1=&HAB:X1=&H14:W1=.:D1=&H1
9007 RETURN
9100 IFM2 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO10000
9105 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y2=&HD:M2=.:D2=&H1:G2=&H73+W2:R2=&H14-FR:J2=NOT.:K=K+&H1
9106 IFNOT(Z1=&HAC ORZ3=&HAC ORZ4=&HAC)THENZ2=&HAC:X2=&H15:W2=NOT.:D2=&H3:ELSEIFNOT(Z1=&HAA ORZ3=&HAA ORZ4=&HAA)THENZ2=&HAA:X2=&H13:W2=NOT.:D2=&H4:ELSEZ2=&HAB:X2=&H14:W2=.:D2=&H1
9107 RETURN
9200 IFM3 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO10000
9205 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y3=&HD:M3=.:D3=&H1:G3=&H73+W3:R3=&H14-FR:J3=NOT.:K=K+&H1
9206 IFNOT(Z2=&HAC ORZ1=&HAC ORZ4=&HAC)THENZ3=&HAC:X3=&H15:W3=NOT.:D3=&H3:ELSEIFNOT(Z2=&HAA ORZ1=&HAA ORZ4=&HAA)THENZ3=&HAA:X3=&H13:W3=NOT.:D3=&H4:ELSEZ3=&HAB:X3=&H14:W3=.:D3=&H1
9207 RETURN
9300 IFM4 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO10000
9305 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y4=&HD:M4=.:D4=&H1:G4=&H73+W4:R4=&H14-FR:J4=NOT.:K=K+&H1
9306 IFNOT(Z2=&HAC ORZ3=&HAC ORZ1=&HAC)THENZ4=&HAC:X4=&H15:W4=NOT.:D4=&H3:ELSEIFNOT(Z2=&HAA ORZ3=&HAA ORZ1=&HAA)THENZ4=&HAA:X4=&H13:W4=NOT.:D4=&H4:ELSEZ4=&HAB:X4=&H14:W4=.:D4=&H1
9307 RETURN
10000 HCOLOR&H1:HPRINT(X,Y),CHR$(&H6B):PLAY"V31;O3;7;V27;7;V28;5;5;O4;4;O3;5;V27;5;V28;7;V27;7;V26;7;V27;8;V26;5;V27;5;O4;4;O3;4;4;V28;2;V27;4;4;V26;O4;4;"
10007 HPRINT(X,Y),CHR$(&H6C):PLAY"V27;O3;5;V26;5;7;O4;4;O3;4;4;V27;2;V26;2;V27;2;2;V26;2;4;4;O4;4;V25;O3;5;4;2;V26;2;O4;1;O2;12;12;12;O4;1;O3;2;2;"
10008 HPRINT(X,Y),CHR$(&H71):PLAY"V25;4;4;V24;2;V25;2;V24;O2;12;V25;12;9;9;V24;9;12;V25;12;V24;O4;1;O3;2;V23;2;O2;12;V24;12;V23;9;V24;9;V25;O3;8;"
10009 HPRINT(X,Y),CHR$(&H72):PLAY"V23;O2;7;V24;9;9;O1;7;V29;O2;7;V28;O3;4;V27;8;V26;12;V24;O4;3;V23;5;V22;7;V21;9;V20;11;V18;O5;1;V19;O1;1;"
10010 HPRINT(X,Y),CHR$(&H73):PLAY"V24;12;V30;O2;7;V28;O3;4;V27;8;V26;12;V24;O4;3;V23;5;V22;7;V21;9;V20;11;V18;O5;1;V3;O1;1;V2;1;V15;P1;P1;P1;"
10011 HPRINT(X,Y),CHR$(&H20):NL=NL-&H1:IFNL=. THENHCOLOR&H3:HPRINT(16,&HF),"GAME OVER":GOSUB17000:HCLS0:RESTORE:GOTO16020
10015 U=P(Z1):IFU=&H1 THENHCOLOR&H9:HPRINT(X1,Y1),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X1,Y1),CHR$(&H25):ELSEHPRINT(X1,Y1),CHR$(&H20)
10016 U=P(Z2):IFU=&H1 THENHCOLOR&H9:HPRINT(X2,Y2),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X2,Y2),CHR$(&H25):ELSEHPRINT(X2,Y2),CHR$(&H20)
10017 U=P(Z3):IFU=&H1 THENHCOLOR&H9:HPRINT(X3,Y3),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X3,Y3),CHR$(&H25):ELSEHPRINT(X3,Y3),CHR$(&H20)
10018 U=P(Z4):IFU=&H1 THENHCOLOR&H9:HPRINT(X4,Y4),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X4,Y4),CHR$(&H25):ELSEHPRINT(X4,Y4),CHR$(&H20)
10019 U=P(Z):IFU=&H1 THENHCOLOR&H9:HPRINT(X,Y),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X,Y),CHR$(&H25):ELSEHPRINT(X,Y),CHR$(&H20)
10020 HPRINT(NL+&HB,23),CHR$(&H20):X=&H14:Y=&H11:HCOLOR&H1:HPRINT(X,Y),CHR$(&H22):P(&HCF)=&HF:GOTO16280
16000 PCLEAR1:POKE&HFFD8,0:LOADM"PACTILES.BIN":POKE&HFFD9,0:POKE&HADEB,57:POKE&HE414,0:POKE&HE42A,0:POKE359,255:POKE&HF00E,&H84:POKE&HF00D,&H94:POKE&HF00E,&HB3
16004 POKE&HE649,&H10:POKE&HE664,&H0:POKE&HE666,&HB:POKE&HE66A,&H3D:POKE&HE66B,&H34:POKE&HE66C,&H3C:POKE&HE66D,&H3C:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,&H3F:POKE&HE673,&H1C:RGB
16007 E1$="V30;O2;7;V29;7;V28;7;V27;7;7;V25;7;V24;7;V18;7;V17;7;V14;7;V12;7;V30;7;V28;7;7;V27;7;7;V25;7;V23;7;V18;7;V17;7;V15;7;V12;7;V11;7;V31;7;V29;7;V28;7;V27;7;V26;7;V25;7;V23;7;V18;7;V16;7;V14;7;V17;7;V28;7;V29;7;V27;7;7;V26;7;V25;7;V23;7"
16008 E2$="V18;7;V16;7;V14;7;V12;7;V17;7;V30;7;V28;7;7;V27;7;7;V24;7;V22;7;V18;7;V16;7;V14;7;V18;7;V29;7;V28;7;7;V27;7;V26;7;V25;7;V22;7;V18;7;V16;7;V14;7;V11;7;V20;7;V29;7;7;V27;7;7;V26;7;V24;7;V22;7;V18;7;V16;7;V14;7;V21;7;V29;7;V28;7;V27;7;7"
16009 E3$="V26;7;V24;7;V22;7;V18;7;V16;7;V14;7;V11;7;V21;O1;1;V29;O2;7;V28;7;7;V26;7;7;V24;7;V21;7;V18;7;V15;7;V13;7;V23;7;V29;7;V28;7;V27;7;7;V26;7;V24;7;V21;7;V17;7;V15;7;V13;7;V10;7;V15;"
16010 GK$="T255;L255;V14;O1;1;V11;1;V21;1;V28;7;V31;12;V19;O2;4;V18;4;V29;7;V16;9;V27;12;V18;O3;2;V27;2;V18;4;V24;5;V25;7;V20;7;8;V22;9;11;12;V21;12;O4;1;2;V22;3;V23;3;V21;4;V19;4;V23;5;V20;6;6;V21;7;V12;O1;1;V4;1;V1;1;V15"
16011 M1$="V26;O1;1;V29;O3;2;V30;2;2;V23;O1;1;V17;7;V16;7;V13;7;V25;O4;2;V27;2;2;2;V15;O1;1;V3;1;V1;1;P255;V21;O3;8;V25;8;8;V26;8;V17;O1;1;V3;1;V1;1;P255;V27;O3;5;V28;5;V30;5;V29;5;V22;O1;12;V17;7;V16;7;V12;12;V27;O4;2;V28;2;2;2;O3;8;8;8;V27;8"
16012 M2$="V19;O1;1;V10;1;V8;1;V6;1;V4;7;V2;7;P255;P255;V27;O3;5;V26;5;5;5;V27;5;5;5;5;V24;O1;7;V22;7;V20;12;V19;12;V18;7;V17;7;V16;12;V12;7;V31;O3;2;V29;4;2;V30;2;V18;O1;1;V17;7;V16;7;V12;7;V27;O4;3;3;3;3;V12;O1;1;V4;1;V1;1;V10;1;V26;O3;9;9;9"
16013 M3$="9;V8;O1;1;V3;1;V1;1;V5;1;V30;O3;7;V29;7;7;V28;7;V19;O1;12;V17;12;V15;12;V16;7;V29;O4;3;V28;3;3;3;O3;9;V27;9;V28;9;V27;9;V13;O1;1;V10;1;V8;1;V5;7;V4;7;V1;1;P255;V13;O1;1;V26;O3;7;7;7;7;7;V27;7;7;V26;7;V22;O1;7;V21;12;V20;12;V19;7"
16014 M4$="V18;7;V16;12;V15;12;V21;12;V30;O3;2;V29;2;2;V28;2;V17;O1;1;1;V15;1;V19;1;V27;O4;2;2;2;V24;2;V4;O1;1;V2;1;P255;V18;O1;1;V25;O3;8;V26;8;8;V21;8;P255;P255;P255;V19;O3;5;V30;5;V28;5;V29;5;V26;5;V18;O1;12;V16;7;V14;7;V21;7;V29;O4;2;V28;2"
16015 M5$="V29;2;V27;2;V28;O3;8;8;8;V24;8;V11;O1;7;V9;1;V7;1;V5;1;V2;1;P255;P255;V21;O1;1;V26;O3;5;5;5;V27;5;5;5;5;V26;5;V23;O1;7;V21;7;V19;12;12;V17;7;V16;7;V14;12;V25;O3;4;V29;5;V30;4;V29;5;5;V28;5;V29;5;V28;5;7;7;7;7;V22;O1;1;V5;1;V2;1;P255"
16016 M6$="V25;O1;7;V30;O3;7;V29;7;V28;7;V29;8;V27;8;V28;8;V27;8;8;8;8;8;V19;O1;1;V4;1;V2;1;P255;V26;O3;8;V28;8;8;V27;8;V28;9;V27;9;9;9;11;11;V28;11;11;V19;O1;1;V6;1;V2;1;P255;V27;O4;2;V28;2;V29;2;V28;2;V29;2;V28;2;2;2;V21;O2;4;V15;4;V13;O1;12"
16017 M7$="V9;12;V7;12;V4;12;V2;1;V15":HSCREEN2
16019 DIM P(&H156),X,Y,Z,W,O,X1,Y1,Z1,D1,G1,C1,W1,X2,Y2,Z2,D2,G2,C2,W2,X3,Y3,Z3,D3,G3,C3,W3,X4,Y4,Z4,D4,G4,C4,W4,A,C,G,AB,A1,B1,A2,B2,A3,B3,A4,B4,PW,K
16020 HCLS0:G1=&H69:G2=&H69:G3=&H69:G4=&H69:FR=&H1:NL=&H3:S=.:OS=.:LM=.:BC=&HC:C1=&H3:C2=&H6:C3=&H5:C4=&H7:MZ=&H1:BL=.
16021 HCOLOR&H9,0:HPRINT(9,1),"COCOdSYNTHESIS PRESENTS":FORT=1TO3000:NEXT
16022 POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H1:FORT=8TO31:HPRINT(T-1,1),CHR$(&H20)+CHR$(&H22):PLAY"T255;L255;V20;O3;9;V23;7;V24;4;V25;1;V26;O2;7;V14;7;P255;P255;P255;"
16023 HPRINT(T,1),CHR$(&H21):PLAY"V23;O2;4;V27;9;V26;O3;1;4;V25;8;V10;O2;4;P255;P255;P255;":NEXT:HPRINT(31,1),CHR$(&H20)
16024 HCOLOR&H4:HPRINT(18,0),"BASIC":HCOLOR&H1:HPRINT(17,1),"pacdman":FORT=1TO3000:NEXT:HCOLOR&H4:HPRINT(9,4),"INTRODUCING THE GHOSTS":FORT=1TO1000:NEXT
16025 X=2:HCOLORC1:FORY=23TO5 STEP-1:HPRINT(X,Y),CHR$(&H74-&HE):HPRINT(X,Y+1),CHR$(&H20):FORT=1TO200:NEXT:HPRINT(X,Y),CHR$(&H74):FORT=1TO200:NEXT:NEXT:HPRINT(9,4),STRING$(22," "):HPRINT(2,5),CHR$(G1)+" BLINKY"
16026 HCOLORC2:FORY=23TO7 STEP-1:HPRINT(X,Y),CHR$(&H74-&HE):HPRINT(X,Y+1),CHR$(&H20):FORT=1TO200:NEXT:HPRINT(X,Y),CHR$(&H74):FORT=1TO200:NEXT:NEXT:HPRINT(2,7),CHR$(G1)+" PINKY"
16027 HCOLORC3:FORY=23TO9 STEP-1:HPRINT(X,Y),CHR$(&H74-&HE):HPRINT(X,Y+1),CHR$(&H20):FORT=1TO200:NEXT:HPRINT(X,Y),CHR$(&H74):FORT=1TO200:NEXT:NEXT:HPRINT(2,9),CHR$(G1)+" INKY"
16028 HCOLORC4:FORY=23TO11 STEP-1:HPRINT(X,Y),CHR$(&H74-&HE):HPRINT(X,Y+1),CHR$(&H20):FORT=1TO200:NEXT:HPRINT(X,Y),CHR$(&H74):FORT=1TO200:NEXT:NEXT:HPRINT(2,11),CHR$(G1)+" CLYDE"
16029 FORT=1TO1000:NEXT:HCOLOR&H9:HPRINT(2,17),CHR$(&H24):HCOLOR&H4:HPRINT(4,17),"10 PTS":HCOLOR&HE:HPRINT(2,19),CHR$(&H25):HCOLOR&H4:HPRINT(4,19),"50 PTS"
16050 HCOLOR&H4:HPRINT(33,4),"1UP":HCOLORBC:HPRINT(30,5),CHR$(&H5B)+STRING$(7,CHR$(&H26))+CHR$(&H5D):HPRINT(30,6),CHR$(&H2E):HCOLOR&H4:HPRINT(36,6),"00":HCOLORBC:HPRINT(38,6),CHR$(&H2E)
16060 HPRINT(30,7),CHR$(&H5C)+STRING$(7,CHR$(&H26))+CHR$(&H5E)
16085 IFFR>&H7 THENFR=&H7:BL=BL+&H1
16086 PL=.:PP=.:Z=.:POKE&HE47B,38:POKE&HE47C,54:ONERR GOTO16150
16087 MF$="MAZE"+STR$(MZ):OPEN "I",#1,MF$:INPUT#1,PC:POKE&HE670,PC:RGB:HCOLORBC:MZ=MZ+&H1
16090 FORY=1TO19:FORX=1TO17
16100 Z=X-&H12+&H12*Y:INPUT#1,B:IFB=&H24 THENHCOLOR&H9:P(Z)=&H1:PP=PP+&H1:ELSEIFB=&H25 THENHCOLOR&HE:P(Z)=&H5:ELSEIFB=&H3B THENHCOLOR&HB:P(Z)=.:ELSEIFB=&H20 THENHCOLOR&H0:P(Z)=&H2:ELSEIFB=&H22 THENHCOLOR&H1:P(Z)=&H2:ELSEP(Z)=.
16130 HPRINT(X+&HB,Y+&H3),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1
16140 IFFR=&H1 GOSUB17000
16150 IFERNO=26 THENMZ=&H1:GOTO16087
16160 POKE&HE47B,18:POKE&HE47C,18
16280 POKE&HF00D,&HA4:POKE&HF00E,&H84:K=.:X1=&H14:Y1=&HB:D1=&H2:G1=&H74:Z1=&H87:M1=.:W1=.:X2=&H14:Y2=&HD:D2=&H1:G2=&H74:Z2=&HAB:M2=.:W2=.
16281 X3=&H13:Y3=&HD:D3=&H4:G3=&H67:Z3=&HAA:M3=.:W3=NOT.:X4=&H15:Y4=&HD:D4=&H4:G4=&H67:Z4=&HAC:M4=.:W4=NOT.:J1=.:J2=NOT.:J3=NOT.:J4=NOT.
16282 HCOLORC1:HPRINT(X1,Y1),CHR$(G1):HCOLORC2:HPRINT(X2,Y2),CHR$(G2):HCOLORC3:HPRINT(X3,Y3),CHR$(G3):HCOLORC4:HPRINT(X4,Y4),CHR$(G4)
16290 ONFR GOTO16291,16292,16293,16294,16295,16296,16297
16291 FT=30:CT=30:R1=.:R2=10:R3=20:R4=30:HCOLOR&H3:HPRINT(28,23),CHR$(&H3C):HCOLOR&H4:HPRINT(28,23),CHR$(&H3D):HCOLOR&HD:HPRINT(28,23),CHR$(&H3E):GOTO16350
16292 FT=30:CT=27:R1=.:R2=9:R3=18:R4=27:HCOLOR&H3:HPRINT(27,23),CHR$(&H3F):HCOLOR&HD:HPRINT(27,23),CHR$(&H40):GOTO16350
16293 FT=30:CT=24:R1=.:R2=8:R3=16:R4=24:HCOLOR&H7:HPRINT(26,23),CHR$(&H23):HCOLOR&HD:HPRINT(26,23),CHR$(&H40):GOTO16350
16294 FT=30:CT=21:R1=.:R2=7:R3=14:R4=21:HCOLOR&H3:HPRINT(25,23),CHR$(&H62):HCOLOR&HD:HPRINT(25,23),CHR$(&H40):GOTO16350
16295 FT=30:CT=18:R1=.:R2=6:R3=12:R4=18:HCOLOR&HD:HPRINT(24,23),CHR$(&H79):HCOLOR&HF:HPRINT(24,23),CHR$(&H7A):GOTO16350
16296 FT=30:CT=15:R1=.:R2=5:R3=&HA:R4=15:HCOLOR&H4:HPRINT(23,23),CHR$(&H6F):HCOLOR&H5:HPRINT(23,23),CHR$(&H7F):GOTO16350
16297 FT=30:CT=15:R1=.:R2=4:R3=8:R4=12:HCOLOR&H1:HPRINT(22-BL,23),CHR$(&H7D):HCOLOR&H5:HPRINT(22-BL,23),CHR$(&H5F):GOTO16350
16350 POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H1:HPRINT(&H12,&HF),"READY"+CHR$(96):PLAY"T255;L255;XM1$;XM2$;XM3$;XM4$;XM5$;XM6$;XM7$;P1;P1;":HCOLOR&H9:HPRINT(&H14,&HF),CHR$(&H20)
16360 IFP(&HCD)=&H1 THENHPRINT(&H12,&HF),CHR$(&H24)ELSEHPRINT(&H12,&HF),CHR$(&H20)
16361 IFP(&HCE)=&H1 THENHPRINT(&H13,&HF),CHR$(&H24)ELSEHPRINT(&H13,&HF),CHR$(&H20)
16362 IFP(&HD0)=&H1 THENHPRINT(&H15,&HF),CHR$(&H24)ELSEHPRINT(&H15,&HF),CHR$(&H20)
16363 IFP(&HD1)=&H1 THENHPRINT(&H16,&HF),CHR$(&H24)ELSEHPRINT(&H16,&HF),CHR$(&H20)
16364 IFP(&HD2)=&H1 THENHPRINT(&H17,&HF),CHR$(&H24)ELSEHPRINT(&H17,&HF),CHR$(&H20)
16370 X=&H14:Y=&H11:B=&H22:PD=&H4:OB=B:Z=&HF3:PW=.:C1=&H3:C2=&H6:C3=&H5:C4=&H7:W=.:GOTO376
17000 HCOLOR&HE:HPRINT(32,11),"PRESS":HPRINT(32,13),"BUTTON":HPRINT(31,15),"TO START"
17010 IFBUTTON(0)THENHCOLOR.:HPRINT(32,11),"PRESS":HPRINT(32,13),"BUTTON":HPRINT(31,15),"TO START":IFFR=&H1 ANDNL THENHCOLOR&H1:HPRINT(12,23),STRING$(NL-&H1,CHR$(&H22)):RETURN:ELSERETURN
17020 IFFL=.THENPOKE&HFFBE,&H3C
17030 IFFL=20 THENPOKE&HFFBE,&H3F
17040 FL=FL+&H1:IFFL=40 THEN FL=.
17050 GOTO17010