10 GOTO3100
20 A=X:C=Y:G=Z:OS=S
30 IFPW THENCD=CD-I:IFM1+M2+M3+M4 THENELSEPW=.:CD=.
40 O=NOTO:POKEP3,V6:FT=FT-I:POKEP4,RND(V6):TIMER=.:GOSUB640:IFFT=.GOSUB460
50 IFTIMER<18GOTO50
60 POKEP3,V5:OB$=B$:B$=CHR$(H(JOYSTK(.))):ONINSTR(1,P$,B$)GOTO130,140,150,180
90 B$=CHR$(V(JOYSTK(I))):ONINSTR(1,P$,B$)GOTO130,140,150,180:GOTO210
130 Y=Y-I:GOTO200
140 Y=Y+I:GOTO200
150 X=X-I:IFX=RC THENX=LB:GOTO200
160 IFX=LC THENX=RB
170 GOTO200
180 X=X+I:IFX=RC THENX=LB:GOTO200
190 IFX=LC THENX=RB
200 Z=X-XA+Y*YA:IFP(Z)GOTO340
210 B$=OB$:X=A:Y=C:Z=G:ONINSTR(1,P$,B$)GOTO220,240,260,300:GOTO340
220 Y=Y-I:Z=X-XA+Y*YA:IFP(Z)GOTO340
230 X=A:Y=C:Z=G:GOTO30
240 Y=Y+I:Z=X-XA+Y*YA:IFP(Z)GOTO340
250 X=A:Y=C:Z=G:GOTO30
260 X=X-I:IFX=RC THENX=LB:GOTO280
270 IFX=LC THENX=RB
280 Z=X-XA+Y*YA:IFP(Z)GOTO340
290 X=A:Y=C:Z=G:GOTO30
300 X=X+I:IFX=RC THENX=LB:GOTO320
310 IFX=LC THENX=RB
320 Z=X-XA+Y*YA:IFP(Z)GOTO340
330 X=A:Y=C:Z=G:GOTO30
340 HCOLORI:HPRINT(X,Y),"!":HPRINT(A,C)," ":W=NOTW:IFZ=Z1 GOSUB2820
350 IFZ=Z2 GOSUB2860
360 IFZ=Z3 GOSUB2900
370 IFZ=Z4 GOSUB2940
380 U=P(Z):ONU GOTO390,430,430,430,400,430,430,430,430,420:GOTO430
390 S=S+U:P(Z)=&H2:PP=PP-I:PLAY"V20O4C":GOTO450
400 PLAY"V18O3D-V24O2BV29G-V24DV16O1BV14G-V3G-G-V8G-V26G-V19BV24O2DV31DV25G-V15A-V20A-V27BV18O3D-V11DV4DV2DV3DDV2DDV1DV15"
410 S=S+U:P(Z)=&H2:PL=PL+I:PW=I:M1=NOT.:M2=NOT.:M3=NOT.:M4=NOT.:CD=CT:K=.:RGB:GOTO450
420 PLAY"V27O3D-V29O2BA-V28G-E-E-O1BV31G-V29CV27CV23CV27CV29CV30G-V29BV27O2E-E-V28G-V29A-V28BO3D-D-V27E-V12O1CV4CV1CV15":S=S+FR*&HA:P(Z)=&H2:GOTO450
430 PLAY"V5O1CV15":IFS-OS GOTO450
440 IFPP=.ANDPL=&H4 THENFR=FR+I:FORT=1TO5:PALETTEBC,V6:PLAY"V0T15P1":PALETTEBC,PC:PLAY"P1T255":NEXT:HCOLOR.:HPRINT(X,Y)," ":HPRINT(X1,Y1)," ":HPRINT(X2,Y2)," ":HPRINT(X3,Y3)," ":HPRINT(X4,Y4)," ":GOTO3350:ELSE20
450 S$=MID$(STR$(S),&H2):PO=LEN(S$):HCOLOR&H4:HPRINT(&H25-PO,&H5),S$:IFS-LM>&H3E7 THENPLAY"T255L255XE1$;XE2$;XE3$;":LM=LM+&H3E8:NL=NL+I:HCOLORI:HPRINT(LB,&H17),STRING$(NL-I,QT$)
455 GOTO440
460 OC=NOTOC:IFOC THENP(&HCF)=&HA:ONFR GOTO470,480,490,500,510,520,530
461 GOTO540
470 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"<":HCOLOR&H4:HPRINT(&H14,&HF),"=":HCOLOR&HD:HPRINT(&H14,&HF),">":FT=&H1E:POKEP1,V1:POKEP2,V2:RETURN
480 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"?":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H1B:POKEP1,V1:POKEP2,V2:RETURN
490 POKEP1,V3:POKEP2,V4:HCOLOR&H7:HPRINT(&H14,&HF),"#":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H18:POKEP1,V1:POKEP2,V2:RETURN
500 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"b":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H15:POKEP1,V1:POKEP2,V2:RETURN
510 POKEP1,V3:POKEP2,V4:HCOLOR&HD:HPRINT(&H14,&HF),"y":HCOLOR&HF:HPRINT(&H14,&HF),"z":FT=&H12:POKEP1,V1:POKEP2,V2:RETURN
520 POKEP1,V3:POKEP2,V4:HCOLOR&H4:HPRINT(&H14,&HF),"o":HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):FT=&HF:POKEP1,V1:POKEP2,V2:RETURN
530 POKEP1,V3:POKEP2,V4:HCOLORI:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):FT=&HC:POKEP1,V1:POKEP2,V2:RETURN
540 HPRINT(&H14,&HF)," ":P(&HCF)=&HF:FT=&H1E:RETURN
550 P(&HCF)=&HA:HPRINT(&H14,&HF)," ":ONFR GOTO560,570,580,590,600,610,620:GOTO630
560 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"<":HCOLOR&H4:HPRINT(&H14,&HF),"=":HCOLOR&HD:HPRINT(&H14,&HF),">":POKEP1,V1:POKEP2,V2:RETURN
570 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"?":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
580 POKEP1,V3:POKEP2,V4:HCOLOR&H7:HPRINT(&H14,&HF),"#":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
590 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"b":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
600 POKEP1,V3:POKEP2,V4:HCOLOR&HD:HPRINT(&H14,&HF),"y":HCOLOR&HF:HPRINT(&H14,&HF),"z":POKEP1,V1:POKEP2,V2:RETURN
610 POKEP1,V3:POKEP2,V4:HCOLOR&H4:HPRINT(&H14,&HF),"o":HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):POKEP1,V1:POKEP2,V2:RETURN
620 POKEP1,V3:POKEP2,V4:HCOLORI:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):POKEP1,V1:POKEP2,V2:RETURN
630 HPRINT(&H14,&HF)," ":P(&HCF)=&HF:RETURN
640 IFPW GOSUB680
650 IFR1 THENELSE660
655 R1=R1-I:IFM1 THENHCOLOR&H2:HPRINT(X1,Y1),CHR$(&H78+O*HE):POKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X1,Y1),UP$:POKEP1,V1:POKEP2,V2:GOTO1190
656 HCOLORC1:G1=&H77+O:HPRINT(X1,Y1),CHR$(G1+O*HE):GOTO1190
660 IFM1 ANDO GOTO1190
670 A1=X1:B1=Y1:AB=Z1:ONJ1+I GOTO710:GOTO730
680 ONCD GOTO690,700,700,700,700,700,700:RETURN
690 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
700 POKE&HFFB2,V6:POKE&HFFB8,SM:RETURN
710 IFM1 THENOND1 GOSUB1110,1130,1150,1170:GOTO830
720 OND1 GOTO750,770,790,810:GOTO830
730 IFZ1=JC THEND1=I ELSEIFZ1=JR THEND1=&H3 ELSEIFZ1=JL THEND1=&H4
740 GOTO830
750 U=P(Z1+I):IFU ANDX1<X THEND1=&H4 ELSEIFP(Z1-YA)THEND1=I ELSEIFU THEND1=&H4 ELSEIFP(Z1-I)THEND1=&H3
760 GOTO820
770 U=P(Z1+I):IFP(Z1-I)ANDX1>X THEND1=&H3 ELSEIFU ANDX1<X THEND1=&H4 ELSEIFP(Z1+YA)THEND1=&H2 ELSEIFU THEND1=&H4 ELSED1=&H3
780 GOTO820
790 Q=P(Z1-YA):U=P(Z1+YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1<Y THEND1=&H2 ELSEIFP(Z1-I)THEND1=&H3 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
800 GOTO820
810 Q=P(Z1-YA):U=P(Z1+YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1<Y THEND1=&H2 ELSEIFP(Z1+I)THEND1=&H4 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
820 G1=&H73+D1
830 OND1 GOTO840,850,860,870
840 Y1=Y1-I:GOTO880
850 Y1=Y1+I:GOTO880
860 X1=X1-I:GOTO880
870 X1=X1+I
880 W1=NOTW1:IFX1=RC THENX1=LB:R1=M1+I:GOTO900
890 IFX1=LC THENX1=RB:R1=M1+I
900 Z1=X1-XA+Y1*YA:IFM1 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X1,Y1),UP$:HCOLOR&H2:HPRINT(X1,Y1),CHR$(&H78+W1*HE):POKEP1,V1:POKEP2,V2:GOTO920
910 HCOLORC1:HPRINT(X1,Y1),CHR$(G1+W1*HE)
920 IFZ1=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X1,Y1),";":POKEP1,V1:POKEP2,V2:J1=.:GOTO940
930 IFAB=LG THENHCOLORLC:HPRINT(A1,B1),";":GOTO1090
940 IFAB=Z2 GOTO950ELSE960
950 IFM2 GOTO1000ELSE1010
960 IFAB=Z3 GOTO970ELSE980
970 IFM3 GOTO1000ELSE1020
980 IFAB=Z4 GOTO990ELSE1040
990 IFM4 GOTO1000ELSE1030
1000 HCOLOR&H8:HPRINT(A1,B1),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A1,B1),CHR$(&H78+W1*HE):POKEP1,V1:POKEP2,V2:GOTO1090
1010 HCOLORC2:HPRINT(A1,B1),CHR$(G2):GOTO1090
1020 HCOLORC3:HPRINT(A1,B1),CHR$(G3):GOTO1090
1030 HCOLORC4:HPRINT(A1,B1),CHR$(G4):GOTO1090
1040 ONP(AB)GOTO1050,1080,1080,1080,1060,1080,1080,1080,1080,1070:GOTO1080
1050 HCOLOR&H9:HPRINT(A1,B1),"$":GOTO1090
1060 HCOLORHE:HPRINT(A1,B1),"%":GOTO1090
1070 GOSUB550:GOTO1090
1080 HPRINT(A1,B1)," "
1090 IFZ-Z1 GOTO1190
1100 GOSUB2820:GOTO1190
1110 U=P(Z1+I):IFU ANDX1>X THEND1=&H4 ELSEIFP(Z1-YA)THEND1=I ELSEIFU THEND1=&H4 ELSEIFP(Z1-I)THEND1=&H3
1120 RETURN
1130 U=P(Z1+I):IFP(Z1-I)ANDX1<X THEND1=&H3 ELSEIFU ANDX1>X THEND1=&H4 ELSEIFP(Z1+YA)THEND1=&H2 ELSEIFU THEND1=&H4 ELSED1=&H3
1140 RETURN
1150 U=P(Z1+YA):Q=P(Z1-YA):IFQ ANDY1<Y THEND1=I ELSEIFU ANDY1>Y THEND1=&H2 ELSEIFP(Z1-I)THEND1=&H3 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
1160 RETURN
1170 U=P(Z1+YA):Q=P(Z1-YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1>Y THEND1=&H2 ELSEIFP(Z1+I)THEND1=&H4 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
1180 RETURN
1190 IFPW GOSUB1230
1200 IFR2 THENELSE1210
1205 R2=R2-I:IFM2 THENHCOLOR&H2:HPRINT(X2,Y2),CHR$(&H78+O*HE):POKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X2,Y2),UP$:POKEP1,V1:POKEP2,V2:GOTO1730
1206 HCOLORC2:G2=&H77+O:HPRINT(X2,Y2),CHR$(G2+O*HE):GOTO1730
1210 IFM2 ANDO GOTO1730
1220 A2=X2:B2=Y2:AB=Z2:ONJ2+I GOTO1250:GOTO1270
1230 ONCD GOTO1240:RETURN
1240 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
1250 IFM2 THENOND2 GOSUB1650,1670,1690,1710:GOTO1370
1260 OND2 GOTO1290,1310,1330,1350:GOTO1370
1270 IFZ2=JC THEND2=I ELSEIFZ2=JR THEND2=&H3 ELSEIFZ2=JL THEND2=&H4
1280 GOTO1370
1290 Q=P(Z2-I):U=P(Z2+I):IFQ ANDX2>X THEND2=&H3 ELSEIFU ANDX2<X THEND2=&H4 ELSEIFP(Z2-YA)THEND2=I ELSEIFU THEND2=&H4 ELSEIFQ THEND2=&H3
1300 GOTO1360
1310 U=P(Z2+I):IFP(Z2-I)ANDX2>X THEND2=&H3 ELSEIFU ANDX2<X THEND2=&H4 ELSEIFP(Z2+YA)THEND2=&H2 ELSEIFU THEND2=&H4 ELSED2=&H3
1320 GOTO1360
1330 Q=P(Z2-YA):U=P(Z2+YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2<Y THEND2=&H2 ELSEIFP(Z2-I)THEND2=&H3 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
1340 GOTO1360
1350 Q=P(Z2-YA):U=P(Z2+YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2<Y THEND2=&H2 ELSEIFP(Z2+I)THEND2=&H4 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
1360 G2=&H73+D2
1370 OND2 GOTO1380,1390,1400,1410
1380 Y2=Y2-I:GOTO1420
1390 Y2=Y2+I:GOTO1420
1400 X2=X2-I:GOTO1420
1410 X2=X2+I
1420 W2=NOTW2:IFX2=RC THENX2=LB:R2=M2+I:GOTO1440
1430 IFX2=LC THENX2=RB:R2=M2+I
1440 Z2=X2-XA+Y2*YA:IFM2 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X2,Y2),UP$:HCOLOR&H2:HPRINT(X2,Y2),CHR$(&H78+W2*HE):POKEP1,V1:POKEP2,V2:GOTO1460
1450 HCOLORC2:HPRINT(X2,Y2),CHR$(G2+W2*HE)
1460 IFZ2=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X2,Y2),";":POKEP1,V1:POKEP2,V2:J2=.:GOTO1480
1470 IFAB=LG THENHCOLORLC:HPRINT(A2,B2),";":GOTO1630
1480 IFAB=Z3 GOTO1490ELSE1500
1490 IFM3 GOTO1540ELSE1550
1500 IFAB=Z4 GOTO1510ELSE1520
1510 IFM4 GOTO1540ELSE1560
1520 IFAB=Z1 GOTO1530ELSE1580
1530 IFM1 GOTO1540ELSE1570
1540 HCOLOR&H8:HPRINT(A2,B2),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A2,B2),CHR$(&H78+W2*HE):POKEP1,V1:POKEP2,V2:GOTO1630
1550 HCOLORC3:HPRINT(A2,B2),CHR$(G3):GOTO1630
1560 HCOLORC4:HPRINT(A2,B2),CHR$(G4):GOTO1630
1570 HCOLORC1:HPRINT(A2,B2),CHR$(G1):GOTO1630
1580 ONP(AB)GOTO1590,1620,1620,1620,1600,1620,1620,1620,1620,1610:GOTO1620
1590 HCOLOR&H9:HPRINT(A2,B2),"$":GOTO1630
1600 HCOLORHE:HPRINT(A2,B2),"%":GOTO1630
1610 GOSUB550:GOTO1630
1620 HPRINT(A2,B2)," "
1630 IFZ-Z2 GOTO1730
1640 GOSUB2860:GOTO1730
1650 U=P(Z2+I):Q=P(Z2-I):IFQ ANDX2<X THEND2=&H3 ELSEIFU ANDX2>X THEND2=&H4 ELSEIFP(Z2-YA)THEND2=I ELSEIFU THEND2=&H4 ELSEIFQ THEND2=&H3
1660 RETURN
1670 U=P(Z2+I):IFP(Z2-I)ANDX2<X THEND2=&H3 ELSEIFU ANDX2>X THEND2=&H4 ELSEIFP(Z2+YA)THEND2=&H2 ELSEIFU THEND2=&H4 ELSED2=&H3
1680 RETURN
1690 U=P(Z2+YA):Q=P(Z2-YA):IFQ ANDY2<Y THEND2=I ELSEIFU ANDY2>Y THEND2=&H2 ELSEIFP(Z2-I)THEND2=&H3 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
1700 RETURN
1710 U=P(Z2+YA):Q=P(Z2-YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2>Y THEND2=&H2 ELSEIFP(Z2+I)THEND2=&H4 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
1720 RETURN
1730 HCOLORI:HPRINT(X,Y),B$:IFPW GOSUB1770
1740 IFR3 THENELSE1750
1745 R3=R3-I:IFM3 THENHCOLOR&H2:HPRINT(X3,Y3),CHR$(&H78+O*HE):POKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X3,Y3),UP$:POKEP1,V1:POKEP2,V2:GOTO2280
1746 HCOLORC3:G3=&H77+O:HPRINT(X3,Y3),CHR$(G3+O*HE):GOTO2280
1750 IFO GOTO2280
1760 A3=X3:B3=Y3:AB=Z3:ONJ3+I GOTO1800:GOTO1820
1770 ONCD GOTO1780,1790,1790,1790,1790,1790,1790:RETURN
1780 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
1790 RGB:RETURN
1800 IFM3 THENOND3 GOSUB2200,2220,2240,2260:GOTO1920
1810 OND3 GOTO1840,1860,1880,1900:GOTO1920
1820 IFZ3=JC THEND3=I ELSEIFZ3=JR THEND3=&H3 ELSEIFZ3=JL THEND3=&H4
1830 GOTO1920
1840 U=P(Z3-I):IFU ANDX3>X THEND3=&H3 ELSEIFP(Z3-YA)THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3
1850 GOTO1910
1860 U=P(Z3-I):IFU ANDX3>X THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3 ELSED3=&H3
1870 GOTO1910
1880 U=P(Z3-YA):IFU ANDY3>Y THEND3=I ELSEIFP(Z3-I)THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
1890 GOTO1910
1900 IFP(Z3+I)THEND3=&H4 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3-YA)THEND3=I
1910 G3=&H73+D3
1920 OND3 GOTO1930,1940,1950,1960
1930 Y3=Y3-I:GOTO1970
1940 Y3=Y3+I:GOTO1970
1950 X3=X3-I:GOTO1970
1960 X3=X3+I
1970 W3=NOTW3:IFX3=RC THENX3=LB:R3=M3+I:GOTO1990
1980 IFX3=LC THENX3=RB:R3=M3+I
1990 Z3=X3-XA+Y3*YA:IFM3 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X3,Y3),UP$:HCOLOR&H2:HPRINT(X3,Y3),CHR$(&H78+W3*HE):POKEP1,V1:POKEP2,V2:GOTO2010
2000 HCOLORC3:HPRINT(X3,Y3),CHR$(G3+W3*HE)
2010 IFZ3=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X3,Y3),";":POKEP1,V1:POKEP2,V2:J3=.:GOTO2030
2020 IFAB=LG THENHCOLORLC:HPRINT(A3,B3),";":GOTO2180
2030 IFAB=Z4 GOTO2040ELSE2050
2040 IFM4 GOTO2090ELSE2100
2050 IFAB=Z1 GOTO2060ELSE2070
2060 IFM1 GOTO2090ELSE2110
2070 IFAB=Z2 GOTO2080ELSE2130
2080 IFM2 GOTO2090ELSE2120
2090 HCOLOR&H8:HPRINT(A3,B3),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A3,B3),CHR$(&H78+W3*HE):POKEP1,V1:POKEP2,V2:GOTO2180
2100 HCOLORC4:HPRINT(A3,B3),CHR$(G4):GOTO2180
2110 HCOLORC1:HPRINT(A3,B3),CHR$(G1):GOTO2180
2120 HCOLORC2:HPRINT(A3,B3),CHR$(G2):GOTO2180
2130 ONP(AB)GOTO2140,2170,2170,2170,2150,2170,2170,2170,2170,2160:GOTO2170
2140 HCOLOR&H9:HPRINT(A3,B3),"$":GOTO2180
2150 HCOLORHE:HPRINT(A3,B3),"%":GOTO2180
2160 GOSUB550:GOTO2180
2170 HPRINT(A3,B3)," "
2180 IFZ-Z3 GOTO2280
2190 GOSUB2900:GOTO2280
2200 U=P(Z3-I):IFU ANDX3<X THEND3=&H3 ELSEIFP(Z3-YA)THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3
2210 RETURN
2220 U=P(Z3-I):IFU ANDX3<X THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3 ELSED3=&H3
2230 RETURN
2240 U=P(Z3-YA):IFU ANDY3<Y THEND3=I ELSEIFP(Z3-I)THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
2250 RETURN
2260 U=P(Z3-YA):IFU ANDY3>Y THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
2270 RETURN
2280 IFPW GOSUB2320
2290 IFR4 THENELSE2300
2295 R4=R4-I:IFM4 THENHCOLOR&H2:HPRINT(X4,Y4),CHR$(&H78+O*HE):POKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X4,Y4),UP$:POKEP1,V1:POKEP2,V2:RETURN
2296 HCOLORC4:G4=&H77+O:HPRINT(X4,Y4),CHR$(G4+O*HE):RETURN
2300 IFO THENELSERETURN
2310 A4=X4:B4=Y4:AB=Z4:ONJ4+I GOTO2340:GOTO2360
2320 ONCD GOTO2330:RETURN
2330 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
2340 IFM4 THENOND4 GOSUB2740,2760,2780,2800:GOTO2460
2350 OND4 GOTO2380,2400,2420,2440:GOTO2460
2360 IFZ4=JC THEND4=I ELSEIFZ4=JR THEND4=&H3 ELSEIFZ4=JL THEND4=&H4
2370 GOTO2460
2380 U=P(Z4-I):IFU ANDX4>X THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I ELSEIFP(Z4+I)THEND4=&H4 ELSEIFU THEND4=&H3
2390 GOTO2450
2400 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4+I)THEND4=&H4 ELSEIFP(Z4-I)THEND4=&H3 ELSED4=&H3
2410 GOTO2450
2420 IFP(Z4-I)THEND4=&H3 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
2430 GOTO2450
2440 IFP(Z4+I)THEND4=&H4 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
2450 G4=&H73+D4
2460 OND4 GOTO2470,2480,2490,2500
2470 Y4=Y4-I:GOTO2510
2480 Y4=Y4+I:GOTO2510
2490 X4=X4-I:GOTO2510
2500 X4=X4+I
2510 W4=NOTW4:IFX4=RC THENX4=LB:R4=M4+I:GOTO2530
2520 IFX4=LC THENX4=RB:R4=M4+I
2530 Z4=X4-XA+Y4*YA:IFM4 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X4,Y4),UP$:HCOLOR&H2:HPRINT(X4,Y4),CHR$(&H78+W4*HE):POKEP1,V1:POKEP2,V2:GOTO2550
2540 HCOLORC4:HPRINT(X4,Y4),CHR$(G4+W4*HE)
2550 IFZ4=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X4,Y4),";":POKEP1,V1:POKEP2,V2:J4=.:GOTO2570
2560 IFAB=LG THENHCOLORLC:HPRINT(A4,B4),";":GOTO2720
2570 IFAB=Z1 GOTO2580ELSE2590
2580 IFM1 GOTO2630ELSE2640
2590 IFAB=Z2 GOTO2600ELSE2610
2600 IFM2 GOTO2630ELSE2650
2610 IFAB=Z3 GOTO2620ELSE2670
2620 IFM3 GOTO2630ELSE2660
2630 HCOLOR&H8:HPRINT(A4,B4),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A4,B4),CHR$(&H78+W4*HE):POKEP1,V1:POKEP2,V2:GOTO2720
2640 HCOLORC1:HPRINT(A4,B4),CHR$(G1):GOTO2720
2650 HCOLORC2:HPRINT(A4,B4),CHR$(G2):GOTO2720
2660 HCOLORC3:HPRINT(A4,B4),CHR$(G3):GOTO2720
2670 ONP(AB)GOTO2680,2710,2710,2710,2690,2710,2710,2710,2710,2700:GOTO2710
2680 HCOLOR&H9:HPRINT(A4,B4),"$":GOTO2720
2690 HCOLORHE:HPRINT(A4,B4),"%":GOTO2720
2700 GOSUB550:GOTO2720
2710 HPRINT(A4,B4)," "
2720 IFZ-Z4 THENRETURN
2730 GOSUB2940:RETURN
2740 U=P(Z4-I):IFU ANDX4<X THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I ELSEIFP(Z4+I)THEND4=&H4 ELSEIFU THEND4=&H3
2750 RETURN
2760 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4+I)THEND4=&H4 ELSEIFP(Z4-I)THEND4=&H3 ELSED4=&H3
2770 RETURN
2780 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-I)THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I
2790 RETURN
2800 IFP(Z4+I)THEND4=&H4 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
2810 RETURN
2820 IFM1 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE2980
2830 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y1=&HD:M1=.:D1=I:G1=&H73+W1:R1=&H14-FR:J1=NOT.:K=K+I
2840 IFNOT(Z2=JR ORZ3=JR ORZ4=JR)THENZ1=JR:X1=&H15:W1=NOT.:D1=&H3:ELSEIFNOT(Z2=JL ORZ3=JL ORZ4=JL)THENZ1=JL:X1=&H13:W1=NOT.:D1=&H4:ELSEZ1=JC:X1=&H14:W1=.:D1=I
2850 RETURN
2860 IFM2 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE2980
2870 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y2=&HD:M2=.:D2=I:G2=&H73+W2:R2=&H14-FR:J2=NOT.:K=K+I
2880 IFNOT(Z1=JR ORZ3=JR ORZ4=JR)THENZ2=JR:X2=&H15:W2=NOT.:D2=&H3:ELSEIFNOT(Z1=JL ORZ3=JL ORZ4=JL)THENZ2=JL:X2=&H13:W2=NOT.:D2=&H4:ELSEZ2=JC:X2=&H14:W2=.:D2=I
2890 RETURN
2900 IFM3 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE2980
2910 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y3=&HD:M3=.:D3=I:G3=&H73+W3:R3=&H14-FR:J3=NOT.:K=K+I
2920 IFNOT(Z2=JR ORZ1=JR ORZ4=JR)THENZ3=JR:X3=&H15:W3=NOT.:D3=&H3:ELSEIFNOT(Z2=JL ORZ1=JL ORZ4=JL)THENZ3=JL:X3=&H13:W3=NOT.:D3=&H4:ELSEZ3=JC:X3=&H14:W3=.:D3=I
2930 RETURN
2940 IFM4 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE2980
2950 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y4=&HD:M4=.:D4=I:G4=&H73+W4:R4=&H14-FR:J4=NOT.:K=K+I
2960 IFNOT(Z2=JR ORZ3=JR ORZ1=JR)THENZ4=JR:X4=&H15:W4=NOT.:D4=&H3:ELSEIFNOT(Z2=JL ORZ3=JL ORZ1=JL)THENZ4=JL:X4=&H13:W4=NOT.:D4=&H4:ELSEZ4=JC:X4=&H14:W4=.:D4=I
2970 RETURN
2980 HCOLORI:HPRINT(X,Y),"k":PLAY"V31O3G-V27G-V28EEO4E-O3EV27EV28G-V27G-V26G-V27GV26EV27EO4E-O3E-E-V28D-V27E-E-V26O4E-"
2990 HPRINT(X,Y),"l":PLAY"V27O3EV26EG-O4E-O3E-E-V27D-V26D-V27D-D-V26D-E-E-O4E-V25O3EE-D-V26D-O4CO2BBBO4CO3D-D-"
3000 HPRINT(X,Y),"q":PLAY"V25E-E-V24D-V25D-V24O2BV25BA-A-V24A-BV25BV24O4CO3D-V23D-O2BV24BV23A-V24A-V25O3G"
3010 HPRINT(X,Y),"r":PLAY"V23O2G-V24A-A-O1G-V29O2G-V28O3E-V27GV26BV24O4DV23EV22G-V21A-V20B-V18O5CV19O1C"
3020 HPRINT(X,Y),"s":PLAY"V24BV30O2G-V28O3E-V27GV26BV24O4DV23EV22G-V21A-V20B-V18O5CV3O1CV2CV15P1P1P1"
3030 HPRINT(X,Y)," ":NL=NL-I:IFNL=.THENHCOLOR&H3:HPRINT(16,&HF),"GAME OVER":GOSUB3680:HCLS.:RESTORE:GOTO3190
3040 U=P(Z1):IFU=I THENHCOLOR&H9:HPRINT(X1,Y1),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X1,Y1),"%":ELSEHPRINT(X1,Y1)," "
3050 U=P(Z2):IFU=I THENHCOLOR&H9:HPRINT(X2,Y2),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X2,Y2),"%":ELSEHPRINT(X2,Y2)," "
3060 U=P(Z3):IFU=I THENHCOLOR&H9:HPRINT(X3,Y3),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X3,Y3),"%":ELSEHPRINT(X3,Y3)," "
3070 U=P(Z4):IFU=I THENHCOLOR&H9:HPRINT(X4,Y4),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X4,Y4),"%":ELSEHPRINT(X4,Y4)," "
3080 U=P(Z):IFU=I THENHCOLOR&H9:HPRINT(X,Y),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X,Y),"%":ELSEHPRINT(X,Y)," "
3090 HPRINT(NL+LC,23)," ":X=&H14:Y=&H11:HCOLORI:HPRINT(X,Y),QT$:P(&HCF)=&HF:GOTO3430
3100 PCLEAR1:DIMI,P(&H156),H(63),V(63),P$,X,Y,Z,XA,YA,G,W,O,X1,Y1,Z1,D1,G1,C1,W1,X2,Y2,Z2,D2,G2,C2,W2,X3,Y3,Z3,D3,G3,C3,W3,X4,Y4,Z4,D4,G4,C4,W4,A,C,AB,A1,B1,A2,B2,A3,B3,A4,B4,PW,K,LB,LC,RB,RC,LG,JL,JC,JR,JD,QT$,PL$,PU$,PD$,UP$,HE,P1,P2,V1,V2,V3,V4,SP
3110 I=&H1:P1=&HF00D:P2=&HF00E:P3=&HFFBE:P4=&HFFBB:V1=&H94:V2=&HB3:V3=&HA4:V4=&H84:V6=&H3F:QT$=CHR$(&H22):PL$=CHR$(&H7C):PU$=CHR$(&H6B):PD$=CHR$(&H7B):UP$=CHR$(&H7E):HE=&HE:XA=&H53:YA=&H12:LB=&HC:LC=&HB:RB=&H1C:RC=&H1D:JD=&H16:SP=&H20:LG=&H99:JL=&HAA:JC=&HAB:JR=&HAC
3120 POKE&HFFD8,.:LOADM"PACTILES.BIN":POKE&HFFD9,.:POKE&HADEB,57:POKE&HE414,.:POKE&HE42A,.:POKE359,255
3125 DIMCR(63):FORT=0TO63:READCR(T):NEXT
3126 DATA0,12,2,14,7,9,5,16,28,44,13,29,11,27,10,43,34,17,18,33,3,1,19,50,30,45,31,46,15,60,47,61,23,8,21,6,39,24,38,54,25,42,26,58,24,41,40,56,20,4,35,51,37,53,36,52,32,59,49,62,55,57,63,48
3130 CMP:HCOLOR4,14:HSCREEN2:POKE&HE649,&H10:HPRINT(&H9,I),"SELECT MONITOR TYPE"
3131 HPRINT(6,3),CHR$(91)+CHR$(38)+CHR$(93)+STRING$(15," ")+CHR$(91)+CHR$(38)+CHR$(93):HPRINT(6,4),CHR$(46)
3132 HCOLOR4:HLINE(56,32)-(63,40),PSET,BF:HCOLOR14:HPRINT(7,4),"C":HCOLOR4:HPRINT(8,4),CHR$(46)+" COMPOSITE  OR "+CHR$(46):HCOLOR4:HLINE(200,32)-(208,40),PSET,BF:HCOLOR14:HPRINT(25,4),"R":HCOLOR4:HPRINT(26,4),CHR$(46)+" RGB"
3133 HPRINT(6,5),CHR$(92)+CHR$(38)+CHR$(94)+STRING$(15," ")+CHR$(92)+CHR$(38)+CHR$(94):KB$="CR"
3135 A$=INKEY$:IFA$=""THEN3135
3136 ONINSTR(1,KB$,A$)GOTO3138,3140:GOTO3135
3138 CLS0:HSCREEN0:HCOLOR0,0:V5=54:SM=8:POKE&HE664,.:POKE&HE665,51:POKE&HE666,12:POKE&HE667,6:POKE&HE668,63:POKE&HE669,44:POKE&HE66A,41:POKE&HE66B,21:POKE&HE66C,V5:POKE&HE66D,V5:POKE&HE66E,SM:POKE&HE66F,63:POKE&HE670,12:POKE&HE671,34:POKE&HE672,63:POKE&HE673,28:RGB:GOTO3150
3140 CLS0:HSCREEN0:HCOLOR0,0:V5=&H3C:SM=&H24:POKE&HE664,.:POKE&HE666,LC:POKE&HE66A,&H3D:POKE&HE66B,&H34:POKE&HE66C,V5:POKE&HE66D,V5:POKE&HE66E,SM:POKE&HE670,&H8:POKE&HE672,V6:POKE&HE673,RB:RGB
3150 HSCREEN2:E1$="V30O2G-V29G-V28G-V27G-G-V25G-V24G-V18G-V17G-V14G-V12G-V30G-V28G-G-V27G-G-V25G-V23G-V18G-V17G-V15G-V12G-V11G-V31G-V29G-V28G-V27G-V26G-V25G-V23G-V18G-V16G-V14G-V17G-V28G-V29G-V27G-G-V26G-V25G-V23G-"
3160 E2$="V18G-V16G-V14G-V12G-V17G-V30G-V28G-G-V27G-G-V24G-V22G-V18G-V16G-V14G-V18G-V29G-V28G-G-V27G-V26G-V25G-V22G-V18G-V16G-V14G-V11G-V20G-V29G-G-V27G-G-V26G-V24G-V22G-V18G-V16G-V14G-V21G-V29G-V28G-V27G-G-"
3170 E3$="V26G-V24G-V22G-V18G-V16G-V14G-V11G-V21O1CV29O2G-V28G-G-V26G-G-V24G-V21G-V18G-V15G-V13G-V23G-V29G-V28G-V27G-G-V26G-V24G-V21G-V17G-V15G-V13G-V10G-V15"
3180 GK$="T255L255V14O1CV11CV21CV28G-V31BV19O2E-V18E-V29G-V16A-V27BV18O3D-V27D-V18E-V24EV25G-V20G-GV22A-B-BV21BO4CD-V22DV23DV21E-V19E-V23EV20FFV21G-V12O1CV4CV1CV15"
3190 HCLS.:G1=&H69:G2=&H69:G3=&H69:G4=&H69:FR=I:NL=&H3:S=.:OS=.:LM=.:BC=LB:C1=&H3:C2=&H6:C3=&H5:C4=&H7:MZ=I:BL=.
3200 POKEP1,V1:POKEP2,V2:HCOLOR&H9,.:HPRINT(&H9,I),"COCOdSYNTHESIS PRESENTS"
3201 FORT=0TO63:ONFIX(T/JD)+I GOTO3202,3203,3204:GOTO3205
3202 H(T)=ASC(PL$):V(T)=ASC(PU$):NEXT
3203 H(T)=46:V(T)=46:NEXT
3204 H(T)=ASC(QT$):V(T)=ASC(PD$):NEXT
3205 P$=PU$+PD$+PL$+QT$
3210 POKEP1,V1:POKEP2,V2:HCOLORI:FORT=8TO31:HPRINT(T-I,I)," "+QT$:PLAY"T255L255V20O3A-V23G-V24E-V25CV26O2G-V14G-P255P255P255"
3220 HPRINT(T,I),"!":PLAY"V23O2E-V27A-V26O3CE-V25GV10O2E-P255P255P255":NEXT:HPRINT(31,I)," "
3230 HCOLOR&H4:HPRINT(18,.),"BASIC":HCOLORI:HPRINT(17,I),"pacdman":FORT=1TO3000:NEXT:HCOLOR&H4:HPRINT(&H9,&H4),"INTRODUCING THE GHOSTS":FORT=1TO1000:NEXT
3240 X=&H2:HCOLORC1:FORY=23TO5 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
3250 HPRINT(&H9,&H4),STRING$(22," "):HPRINT(&H2,&H5),CHR$(G1)+" BLINKY"
3260 HCOLORC2:FORY=23TO7 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
3270 HPRINT(&H2,&H7),CHR$(G1)+" PINKY"
3280 HCOLORC3:FORY=23TO9 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
3290 HPRINT(&H2,&H9),CHR$(G1)+" INKY"
3300 HCOLORC4:FORY=23TO11 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
3310 HPRINT(&H2,LC),CHR$(G1)+" CLYDE"
3320 FORT=1TO1000:NEXT:HCOLOR&H9:HPRINT(30,&H9),"$":HCOLOR&H4:HPRINT(32,&H9),"10 PTS":HCOLORHE:HPRINT(30,LC),"%":HCOLOR&H4:HPRINT(32,LC),"50 PTS"
3330 HCOLOR&H4:HPRINT(33,&H3),"1UP":HCOLORBC:HPRINT(30,&H4),CHR$(&H5B)+STRING$(&H7,CHR$(&H26))+CHR$(&H5D):HPRINT(30,&H5),CHR$(&H2E):HCOLOR&H4:HPRINT(36,&H5),"00":HCOLORBC:HPRINT(38,&H5),CHR$(&H2E)
3340 HPRINT(30,&H6),CHR$(&H5C)+STRING$(&H7,CHR$(&H26))+CHR$(&H5E)
3350 IFFR>&H7 THENFR=&H7:BL=BL+I
3360 PL=.:PP=.:Z=.:POKE&HE47B,38:POKE&HE47C,54:ONERR GOTO3790
3370 MF$="MAZE"+STR$(MZ):OPEN "I",#1,MF$:INPUT#1,PC:IFA$="C"THENPC=CR(PC)
3380 POKE&HE670,PC:RGB:HCOLORBC:MZ=MZ+I:FORY=1TO19:FORX=1TO17
3390 Z=X-YA+YA*Y:INPUT#1,B:IFB=&H24 THENHCOLOR&H9:P(Z)=I:PP=PP+I:ELSEIFB=&H25 THENHCOLORHE:P(Z)=&H5:ELSEIFB=&H3B THENHCOLORLC:P(Z)=.:ELSEIFB=SP THENHCOLOR.:P(Z)=&H2:ELSEIFB=&H22 THENHCOLORI:P(Z)=&H2:ELSEP(Z)=.
3400 HPRINT(X+LC,Y+&H3),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1
3410 IFFR=I GOSUB3680
3420 POKE&HE47B,18:POKE&HE47C,18
3430 POKEP1,V3:POKEP2,V4:K=.:X1=&H14:Y1=LC:D1=&H2:G1=&H74:Z1=&H87:M1=.:W1=.:X2=&H14:Y2=&HD:D2=I:G2=&H74:Z2=JC:M2=.:W2=.
3440 X3=&H13:Y3=&HD:D3=&H4:G3=&H67:Z3=JL:M3=.:W3=NOT.:X4=&H15:Y4=&HD:D4=&H4:G4=&H67:Z4=JR:M4=.:W4=NOT.:J1=.:J2=NOT.:J3=NOT.:J4=NOT.
3450 HCOLORC1:HPRINT(X1,Y1),CHR$(G1):HCOLORC2:HPRINT(X2,Y2),CHR$(G2):HCOLORC3:HPRINT(X3,Y3),CHR$(G3):HCOLORC4:HPRINT(X4,Y4),CHR$(G4)
3460 ONFR GOTO3470,3480,3490,3500,3510,3520,3530
3470 FT=&H1E:CT=&H1E:R1=.:R2=10:R3=20:R4=&H1E:HCOLOR&H3:HPRINT(28,23),"<":HCOLOR&H4:HPRINT(28,23),"=":HCOLOR&HD:HPRINT(28,23),">":GOTO3540
3480 FT=&H1E:CT=&H1B:R1=.:R2=9:R3=&H12:R4=&H1B:HCOLOR&H3:HPRINT(27,23),"?":HCOLOR&HD:HPRINT(27,23),"@":GOTO3540
3490 FT=&H1E:CT=&H18:R1=.:R2=8:R3=16:R4=&H18:HCOLOR&H7:HPRINT(26,23),"#":HCOLOR&HD:HPRINT(26,23),"@":GOTO3540
3500 FT=&H1E:CT=&H15:R1=.:R2=7:R3=14:R4=&H15:HCOLOR&H3:HPRINT(25,23),"b":HCOLOR&HD:HPRINT(25,23),"@":GOTO3540
3510 FT=&H1E:CT=&H12:R1=.:R2=6:R3=&HC:R4=&H12:HCOLOR&HD:HPRINT(24,23),"y":HCOLOR&HF:HPRINT(24,23),"z":GOTO3540
3520 FT=&H1E:CT=&HF:R1=.:R2=5:R3=&HA:R4=&HF:HCOLOR&H4:HPRINT(23,23),"o":HCOLOR&H5:HPRINT(23,23),CHR$(&H7F):GOTO3540
3530 FT=&H1E:CT=&HF:R1=.:R2=4:R3=8:R4=&HC:HCOLORI:HPRINT(22-BL,23),CHR$(&H7D):HCOLOR&H5:HPRINT(22-BL,23),CHR$(&H5F):GOTO3540
3540 POKEP1,V1:POKEP2,V2:HCOLORI:HPRINT(YA,&HF),"READY"+CHR$(96)
3550 PLAY"V26O1CV29O3D-V30D-D-V23O1CV17G-V16G-V13G-V25O4D-V27D-D-D-V15O1CV3CV1CP255V21O3GV25GGV26GV17O1CV3CV1CP255V27O3EV28EV30EV29EV22O1BV17G-V16G-V12BV27O4D-V28D-D-D-O3GGGV27G"
3560 PLAY"V19O1CV10CV8CV6CV4G-V2G-P255P255V27O3EV26EEEV27EEEEV24O1G-V22G-V20BV19BV18G-V17G-V16BV12G-V31O3D-V29E-D-V30D-V18O1CV17G-V16G-V12G-V27O4DDDDV12O1CV4CV1CV10CV26O3A-A-A-"
3570 PLAY"9V8O1CV3CV1CV5CV30O3G-V29G-G-V28G-V19O1BV17BV15BV16G-V29O4DV28DDDO3A-V27A-V28A-V27A-V13O1CV10CV8CV5G-V4G-V1CP255V13O1CV26O3G-G-G-G-G-V27G-G-V26G-V22O1G-V21BV20BV19G-"
3580 PLAY"V18G-V16BV15BV21BV30O3D-V29D-D-V28D-V17O1CCV15CV19CV27O4D-D-D-V24D-V4O1CV2CP255V18O1CV25O3GV26GGV21GP255P255P255V19O3EV30EV28EV29EV26EV18O1BV16G-V14G-V21G-V29O4D-V28D-"
3590 PLAY"V29D-V27D-V28O3GGGV24GV11O1G-V9CV7CV5CV2CP255P255V21O1CV26O3EEEV27EEEEV26EV23O1G-V21G-V19BBV17G-V16G-V14BV25O3E-V29EV30E-V29EEV28EV29EV28EG-G-G-G-V22O1CV5CV2CP255"
3600 PLAY"V25O1G-V30O3G-V29G-V28G-V29GV27GV28GV27GGGGGV19O1CV4CV2CP255V26O3GV28GGV27GV28A-V27A-A-A-B-B-V28B-B-V19O1CV6CV2CP255V27O4D-V28D-V29D-V28D-V29D-V28D-D-D-V21O2E-V15E-V13O1B"
3610 PLAY"V9BV7BV4BV2CV15P1P1":HCOLOR&H9:HPRINT(&H14,&HF)," "
3620 IFP(&HCD)=I THENHPRINT(YA,&HF),"$"ELSEHPRINT(YA,&HF)," "
3630 IFP(&HCE)=I THENHPRINT(&H13,&HF),"$"ELSEHPRINT(&H13,&HF)," "
3640 IFP(&HD0)=I THENHPRINT(&H15,&HF),"$"ELSEHPRINT(&H15,&HF)," "
3650 IFP(&HD1)=I THENHPRINT(JD,&HF),"$"ELSEHPRINT(JD,&HF)," "
3660 IFP(&HD2)=I THENHPRINT(&H17,&HF),"$"ELSEHPRINT(&H17,&HF)," "
3670 X=&H14:Y=&H11:B$=QT$:OB$=B$:Z=&HF3:PW=.:C1=&H3:C2=&H6:C3=&H5:C4=&H7:W=.:GOTO20
3680 HCOLORHE:HPRINT(&HA,23),"PRESS BUTTON TO START"
3690 IFBUTTON(.)GOTO3770
3700 IFFL=I THENPOKEP3,V5
3710 IFBUTTON(.)GOTO3770
3720 IFFL=&H14 THENPOKEP3,V6
3730 IFBUTTON(.)GOTO3770
3740 IFFL=&H28 THENFL=.
3750 IFBUTTON(.)GOTO3770
3760 FL=FL+I:GOTO3690
3770 HCOLOR.:HPRINT(&HA,23),"PRESS BUTTON TO START":IFFR=I ANDNL THENHCOLORI:HPRINT(LB,23),STRING$(NL-I,QT$)
3780 RETURN
3790 IFERNO=26 THENMZ=I:GOTO3370:ELSE3420
