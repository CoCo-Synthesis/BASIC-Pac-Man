10 GOTO4260
20 A=X:C=Y:G=Z:OS=S
30 IFPW THENCD=CD-&H1:IFM1+M2+M3+M4 THENELSEPW=.:CD=.
40 O=NOTO:POKE&HFFBE,&H3C:TIMER=.:GOSUB690:PRINTTIMER:FT=FT-&H1:POKE&HFFBB,RND(&H3F):POKE&HFFBE,&H3F:IFFT=. GOSUB500
50 OD=PD:OB=B:ONFIX(JOYSTK(.)/&H16)+&H1 GOTO60,80,70
60 PD=&H3:B=&H7C:GOTO140
70 PD=&H4:B=&H22:GOTO170
80 ONFIX(JOYSTK(&H1)/&H16)+&H1 GOTO90,110,100
90 PD=&H1:B=&H6B:GOTO120
100 PD=&H2:B=&H7B:GOTO130
110 ONPD GOTO120,130,140,170:GOTO190
120 Y=Y-&H1:GOTO190
130 Y=Y+&H1:GOTO190
140 X=X-&H1:IFX=&H1D THENX=&HC:GOTO190
150 IFX=&HB THENX=&H1C:GOTO190
160 GOTO190
170 X=X+&H1:IFX=&H1D THENX=&HC:GOTO190
180 IFX=&HB THENX=&H1C
190 Z=X-&H53+Y*&H12:IFP(Z)GOTO330
200 X=A:Y=C:Z=G:PD=OD:B=OB:ONOD GOTO210,230,250,290:GOTO330
210 Y=Y-&H1:Z=X-&H53+Y*&H12:IFP(Z)GOTO190
220 X=A:Y=C:Z=G:PD=OD:GOTO30
230 Y=Y+&H1:Z=X-&H53+Y*&H12:IFP(Z)GOTO190
240 X=A:Y=C:Z=G:PD=OD:GOTO30
250 X=X-&H1:IFX=&H1D THENX=&HC:GOTO270
260 IFX=&HB THENX=&H1C
270 Z=X-&H53+Y*&H12:IFP(Z)GOTO190
280 X=A:Y=C:Z=G:PD=OD:GOTO30
290 X=X+&H1:IFX=&H1D THENX=&HC:GOTO310
300 IFX=&HB THENX=&H1C
310 Z=X-&H53+Y*&H12:IFP(Z)GOTO190
320 X=A:Y=C:Z=G:PD=OD:GOTO30
330 HCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(B):GOTO350
340 HPRINT(X,Y),CHR$(&H21)
350 HPRINT(A,C),CHR$(&H20):W=NOTW:IFZ-Z1 THENELSEGOSUB3980
360 IFZ-Z2 THENELSEGOSUB4020
370 IFZ-Z3 THENELSEGOSUB4060
380 IFZ-Z4 THENELSEGOSUB4100
390 U=P(Z):ONU GOTO400,450,450,450,420,450,450,450,450,440:GOTO450
400 S=S+U:P(Z)=&H2:PP=PP-&H1:IFW THENPLAY"V20;O4;1;V15;3":GOTO480
410 PLAY"V20;O4;3;V15;1":GOTO480
420 PLAY"V18;O3;2;V24;O2;12;V29;7;V24;3;V16;O1;12;V14;7;V3;7;7;V8;7;V26;7;V19;12;V24;O2;3;V31;3;V25;7;V15;9;V20;9;V27;12;V18;O3;2;V11;3;V4;3;V2;3;V3;3;3;V2;3;3;V1;3;V15"
430 S=S+U:P(Z)=&H2:PL=PL+&H1:PW=&H1:M1=NOTJ1:M2=NOTJ2:M3=NOTJ3:M4=NOTJ4:CD=CT:K=.:RGB:GOTO480
440 PLAY"V27;O3;2;V29;O2;12;9;V28;7;4;4;O1;12;V31;7;V29;1;V27;1;V23;1;V27;1;V29;1;V30;7;V29;12;V27;O2;4;4;V28;7;V29;9;V28;12;O3;2;2;V27;4;V12;O1;1;V4;1;V1;1;V15":S=S+FR*&HA:P(Z)=&H2:GOTO480
450 PLAY"V5;O1;C;G;V15":IFS-OS GOTO480
460 IFPP=. ANDPL=&H4 THENFR=FR+&H1:HCOLOR&H0:HPRINT(X,Y),CHR$(&H20):HPRINT(X1,Y1),CHR$(&H20):HPRINT(X2,Y2),CHR$(&H20):HPRINT(X3,Y3),CHR$(&H20):HPRINT(X4,Y4),CHR$(&H20):GOTO4500
470 GOTO20
480 S$=MID$(STR$(S),&H2):PO=LEN(S$):HCOLOR&H4:HPRINT(&H25-PO,&H5),S$:IFS-LM>&H3E7 THENPLAY"T255;L255;XE1$;XE2$;XE3$;":LM=LM+&H3E8:NL=NL+&H1:HCOLOR&H1:HPRINT(&HC,&H17),STRING$(NL-&H1,CHR$(&H22)):GOTO460
490 GOTO460
500 OC=NOTOC:IFOC THENP(&HCF)=&HA:ONFR GOTO520,530,540,550,560,570,580:GOTO590
510 GOTO590
520 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3C):HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H3D):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H3E):FT=30:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
530 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3F):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=27:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
540 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H7:HPRINT(&H14,&HF),CHR$(&H23):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=24:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
550 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H62):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):FT=21:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
560 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H79):HCOLOR&HF:HPRINT(&H14,&HF),CHR$(&H7A):FT=18:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
570 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H6F):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):FT=15:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
580 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H1:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):FT=12:POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
590 HPRINT(&H14,&HF),CHR$(&H20):P(&HCF)=&HF:FT=30:RETURN
600 P(&HCF)=&HA:HPRINT(&H14,&HF),CHR$(&H20):ONFR GOTO610,620,630,640,650,660,670:GOTO680
610 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3C):HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H3D):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H3E):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
620 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H3F):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
630 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H7:HPRINT(&H14,&HF),CHR$(&H23):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
640 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H3:HPRINT(&H14,&HF),CHR$(&H62):HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H40):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
650 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HD:HPRINT(&H14,&HF),CHR$(&H79):HCOLOR&HF:HPRINT(&H14,&HF),CHR$(&H7A):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
660 POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H4:HPRINT(&H14,&HF),CHR$(&H6F):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
670 FT=30:CT=5:R1=.:R2=4:R3=8:R4=12:HCOLOR&H1:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):POKE&HF00D,&H94:POKE&HF00E,&HB3:RETURN
680 HPRINT(&H14,&HF),CHR$(&H20):P(&HCF)=&HF:RETURN
690 IFPW GOSUB730
700 IFR1 THENR1=R1-&H1:FORT=1TO40:NEXT:HCOLORC1:G1=&H77+O:HPRINT(X1,Y1),CHR$(G1+O*&HE):FORT=1TO40:NEXT:GOTO1550
710 IFM1 ANDO THENFORT=1TO125:NEXT:GOTO1550
720 A1=X1:B1=Y1:AB=Z1:ONJ1+&H1 GOTO760:GOTO780
730 ONCD GOTO740,750,750,750,750,750,750:RETURN
740 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
750 POKE&HFFB2,&H3F:POKE&HFFB8,&H24:RETURN
760 IFM1 THENOND1 GOSUB1330,1380,1430,1490:GOTO1040
770 OND1 GOTO820,870,920,980:GOTO1040
780 IFZ1-&HAB THENELSED1=&H1:GOTO1040
790 IFZ1-&HAC THENELSED1=&H3:GOTO1040
800 IFZ1-&HAA THENELSED1=&H4:GOTO1040
810 GOTO1040
820 U=P(Z1+&H1):IFU ANDX1<X THEND1=&H4:GOTO1030
830 IFP(Z1-&H12)THEND1=&H1:GOTO1030
840 IFU THEND1=&H4:GOTO1030
850 IFP(Z1-&H1)THEND1=&H3:GOTO1030
860 GOTO1030
870 IFP(Z1-&H1)ANDX1>X THEND1=&H3:GOTO1030
880 U=P(Z1+&H1):IFU ANDX1<X THEND1=&H4:GOTO1030
890 IFP(Z1+&H12)THEND1=&H2:GOTO1030
900 IFU THEND1=&H4:GOTO1030
910 D1=&H3:GOTO1030
920 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:GOTO1030
930 U=P(Z1+&H12):IFU ANDY1<Y THEND1=&H2:GOTO1030
940 IFP(Z1-&H1)THEND1=&H3:GOTO1030:
950 IFU THEND1=&H2:GOTO1030
960 IFQ THEND1=&H1:GOTO1030
970 GOTO1030
980 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:GOTO1030
990 U=P(Z1+&H12):IFU ANDY1<Y THEND1=&H2:GOTO1030
1000 IFP(Z1+&H1)THEND1=&H4:GOTO1030
1010 IFU THEND1=&H2:GOTO1030
1020 IFQ THEND1=&H1
1030 G1=&H73+D1
1040 OND1 GOTO1050,1060,1070,1080
1050 Y1=Y1-&H1:W1=NOTW1:GOTO1090
1060 Y1=Y1+&H1:W1=NOTW1:GOTO1090
1070 X1=X1-&H1:W1=NOTW1:GOTO1090
1080 X1=X1+&H1:W1=NOTW1
1090 IFX1-&H1D THENELSEX1=&HC:R1=M1+&H1:GOTO1110
1100 IFX1-&HB THENELSEX1=&H1C:R1=M1+&H1
1110 Z1=X1-&H53+Y1*&H12:IFZ1-&H99 THENELSEM1=.:GOTO1130
1120 IFM1 THEN POKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X1,Y1),CHR$(&H7E):HCOLOR&H2:HPRINT(X1,Y1),CHR$(&H78+W1*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO1150
1130 HCOLORC1:HPRINT(X1,Y1),CHR$(G1+W1*&HE):IFZ1-&H99 THENELSEPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X1,Y1),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J1=.:GOTO1150
1140 IFAB-&H99 THENELSEHCOLOR&HB:HPRINT(A1,B1),CHR$(&H3B):GOTO1310
1150 IFAB-Z2 GOTO1170ELSEGOTO1160
1160 IFM2 GOTO1220ELSEGOTO1230
1170 IFAB-Z3 GOTO1190ELSEGOTO1180
1180 IFM3 GOTO1220ELSEGOTO1240
1190 IFAB-Z4 GOTO1210ELSEGOTO1200
1200 IFM4 GOTO1220ELSEGOTO1250
1210 GOTO1260
1220 HCOLOR&H8:HPRINT(A1,B1),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A1,B1),CHR$(&H78+W1*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO1310
1230 HCOLORC2:HPRINT(A1,B1),CHR$(G2):GOTO1310
1240 HCOLORC3:HPRINT(A1,B1),CHR$(G3):GOTO1310
1250 HCOLORC4:HPRINT(A1,B1),CHR$(G4):GOTO1310
1260 ONP(AB)GOTO1270,1300,1300,1300,1280,1300,1300,1300,1300,1290:GOTO1300
1270 HCOLOR&H9:HPRINT(A1,B1),CHR$(&H24):GOTO1310
1280 HCOLOR&HE:HPRINT(A1,B1),CHR$(&H25):GOTO1310
1290 GOSUB600:GOTO1310
1300 HPRINT(A1,B1),CHR$(&H20)
1310 IFZ-Z1 GOTO1550
1320 GOSUB3980:GOTO1550
1330 U=P(Z1+&H1):IFU ANDX1>X THEND1=&H4:RETURN
1340 IFP(Z1-&H12)THEND1=&H1:RETURN
1350 IFU THEND1=&H4:RETURN
1360 IFP(Z1-&H1)THEND1=&H3:RETURN
1370 RETURN
1380 IFP(Z1-&H1)ANDX1<X THEND1=&H3:RETURN
1390 U=P(Z1+&H1):IFU ANDX1>X THEND1=&H4:RETURN
1400 IFP(Z1+&H12)THEND1=&H2:RETURN
1410 IFU THEND1=&H4:RETURN
1420 D1=&H3:RETURN
1430 Q=P(Z1-&H12):IFQ ANDY1<Y THEND1=&H1:RETURN
1440 U=P(Z1+&H12):IFU ANDY1>Y THEND1=&H2:RETURN
1450 IFP(Z1-&H1)THEND1=&H3:RETURN
1460 IFU THEND1=&H2:RETURN
1470 IFQ THEND1=&H1:RETURN
1480 RETURN
1490 Q=P(Z1-&H12):IFQ ANDY1>Y THEND1=&H1:RETURN
1500 U=P(Z1+&H12):IFU ANDY1>Y THEND1=&H2:RETURN
1510 IFP(Z1+&H1)THEND1=&H4:RETURN
1520 IFU THEND1=&H2:RETURN
1530 IFQ THEND1=&H1:RETURN
1540 RETURN
1550 IFPW GOSUB1590
1560 IFR2 THENR2=R2-&H1:FORT=1TO40:NEXT:HCOLORC2:G2=&H76+O:HPRINT(X2,Y2),CHR$(G2+O*&HE):FORT=1TO40:NEXT:GOTO2420
1570 IFM2 ANDO THENFORT=1TO125:NEXT:GOTO2420
1580 A2=X2:B2=Y2:AB=Z2:ONJ2+&H1 GOTO1610:GOTO1630
1590 ONCD GOTO1600:RETURN
1600 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
1610 IFM2 THENOND2 GOSUB2190,2250,2300,2360:GOTO1900
1620 OND2 GOTO1670,1730,1780,1840:GOTO1900
1630 IFZ2-&HAB THENELSED2=&H1:GOTO1900
1640 IFZ2-&HAC THENELSED2=&H3:GOTO1900
1650 IFZ2-&HAA THENELSED2=&H4:GOTO1900
1660 GOTO1900
1670 Q=P(Z2-&H1):IFQ ANDX2>X THEND2=&H3:GOTO1890
1680 U=P(Z2+&H1):IFU ANDX2<X THEND2=&H4:GOTO1890
1690 IFP(Z2-&H12)THEND2=&H1:GOTO1890
1700 IFU THEND2=&H4:GOTO1890
1710 IFQ THEND2=&H3:GOTO1890
1720 GOTO1890
1730 IFP(Z2-&H1)ANDX2>X THEND2=&H3:GOTO1890
1740 U=P(Z2+&H1):IFU ANDX2<X THEND2=&H4:GOTO1890
1750 IFP(Z2+&H12)THEND2=&H2:GOTO1890
1760 IFU THEND2=&H4:GOTO1890
1770 D2=&H3:GOTO1890
1780 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:GOTO1890
1790 U=P(Z2+&H12):IFU ANDY2<Y THEND2=&H2:GOTO1890
1800 IFP(Z2-&H1)THEND2=&H3:GOTO1890
1810 IFU THEND2=&H2:GOTO1890
1820 IFQ THEND2=&H1:GOTO1890
1830 GOTO1890
1840 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:GOTO1890
1850 U=P(Z2+&H12):IFU ANDY2<Y THEND2=&H2:GOTO1890
1860 IFP(Z2+&H1)THEND2=&H4:GOTO1890
1870 IFU THEND2=&H2:GOTO1890
1880 IFQ THEND2=&H1
1890 G2=&H73+D2
1900 OND2 GOTO1910,1920,1930,1940
1910 Y2=Y2-&H1:W2=NOTW2:GOTO1950
1920 Y2=Y2+&H1:W2=NOTW2:GOTO1950
1930 X2=X2-&H1:W2=NOTW2:GOTO1950
1940 X2=X2+&H1:W2=NOTW2
1950 IFX2-&H1D THENELSEX2=&HC:R2=M2+&H1:GOTO1970
1960 IFX2-&HB THENELSEX2=&H1C:R2=M2+&H1
1970 Z2=X2-&H53+Y2*&H12:IFZ2-&H99 THENELSEM2=.:GOTO1990
1980 IFM2 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X2,Y2),CHR$(&H7E):HCOLOR&H2:HPRINT(X2,Y2),CHR$(&H78+W2*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO2010
1990 HCOLORC2:HPRINT(X2,Y2),CHR$(G2+W2*&HE):IFZ2-&H99 THENELSEPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X2,Y2),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J2=.:GOTO2010
2000 IFAB-&H99 THENELSEHCOLOR&HB:HPRINT(A2,B2),CHR$(&H3B):GOTO2170
2010 IFAB-Z3 GOTO2030ELSEGOTO2020
2020 IFM3 GOTO2080ELSEGOTO2090
2030 IFAB-Z4 GOTO2050ELSEGOTO2040
2040 IFM4 GOTO2080ELSEGOTO2100
2050 IFAB-Z1 GOTO2070ELSEGOTO2060
2060 IFM1 GOTO2080ELSEGOTO2110
2070 GOTO2120
2080 HCOLOR&H8:HPRINT(A2,B2),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A2,B2),CHR$(&H78+W2*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO2170
2090 HCOLORC3:HPRINT(A2,B2),CHR$(G3):GOTO2170
2100 HCOLORC4:HPRINT(A2,B2),CHR$(G4):GOTO2170
2110 HCOLORC1:HPRINT(A2,B2),CHR$(G1):GOTO2170
2120 ONP(AB)GOTO2130,2160,2160,2160,2140,2160,2160,2160,2160,2150:GOTO2160
2130 HCOLOR&H9:HPRINT(A2,B2),CHR$(&H24):GOTO2170
2140 HCOLOR&HE:HPRINT(A2,B2),CHR$(&H25):GOTO2170
2150 GOSUB600:GOTO2170
2160 HPRINT(A2,B2),CHR$(&H20)
2170 IFZ-Z2 GOTO2420
2180 GOSUB4020:GOTO2420
2190 Q=P(Z2-&H1):IFQ ANDX2<X THEND2=&H3:RETURN
2200 U=P(Z2+&H1):IFU ANDX2>X THEND2=&H4:RETURN
2210 IFP(Z2-&H12)THEND2=&H1:RETURN
2220 IFU THEND2=&H4:RETURN
2230 IFQ THEND2=&H3:RETURN
2240 RETURN
2250 IFP(Z2-&H1)ANDX2<X THEND2=&H3:RETURN
2260 U=P(Z2+&H1):IFU ANDX2>X THEND2=&H4:RETURN
2270 IFP(Z2+&H12)THEND2=&H2:RETURN
2280 IFU THEND2=&H4:RETURN
2290 D2=&H3:RETURN
2300 Q=P(Z2-&H12):IFQ ANDY2<Y THEND2=&H1:RETURN
2310 U=P(Z2+&H12):IFU ANDY2>Y THEND2=&H2:RETURN
2320 IFP(Z2-&H1)THEND2=&H3:RETURN
2330 IFU THEND2=&H2:RETURN
2340 IFQ THEND2=&H1:RETURN
2350 RETURN
2360 Q=P(Z2-&H12):IFQ ANDY2>Y THEND2=&H1:RETURN
2370 U=P(Z2+&H12):IFU ANDY2>Y THEND2=&H2:RETURN
2380 IFP(Z2+&H1)THEND2=&H4:RETURN
2390 IFU THEND2=&H2:RETURN
2400 IFQ THEND2=&H1:RETURN
2410 RETURN
2420 IFPW GOSUB2460
2430 IFR3 THENR3=R3-&H1:FORT=1TO40:NEXT:HCOLORC3:G3=&H75+O:HPRINT(X3,Y3),CHR$(G3+O*&HE):FORT=1TO40:NEXT:GOTO3230
2440 IFO GOTO3230
2450 A3=X3:B3=Y3:AB=Z3:ONJ3+&H1 GOTO2490:GOTO2510
2460 ONCD GOTO2470,2480,2480,2480,2480,2480,2480:RETURN
2470 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
2480 RGB:RETURN
2490 IFM3 THENOND3 GOSUB3030,3080,3130,3180:GOTO2740
2500 OND3 GOTO2550,2600,2650,2700:GOTO2740
2510 IFZ3-&HAB THENELSED3=&H1:GOTO2740
2520 IFZ3-&HAC THENELSED3=&H3:GOTO2740
2530 IFZ3-&HAA THENELSED3=&H4:GOTO2740
2540 GOTO2740
2550 U=P(Z3-&H1):IFU ANDX3>X THEND3=&H3:GOTO2730
2560 IFP(Z3-&H12)THEND3=&H1:GOTO2730
2570 IFP(Z3+&H1)THEND3=&H4:GOTO2730
2580 IFU THEND3=&H3:GOTO2730
2590 GOTO2730
2600 U=P(Z3-&H1):IFU ANDX3>X THEND3=&H3:GOTO2730
2610 IFP(Z3+&H12)THEND3=&H2:GOTO2730
2620 IFP(Z3+&H1)THEND3=&H4:GOTO2730
2630 IFU THEND3=&H3:GOTO2730
2640 D3=&H3:GOTO2730
2650 U=P(Z3-&H12):IFU ANDY3>Y THEND3=&H1:GOTO2730
2660 IFP(Z3-&H1)THEND3=&H3:GOTO2730
2670 IFP(Z3+&H12)THEND3=&H2:GOTO2730
2680 IFU THEND3=&H1:GOTO2730
2690 GOTO2730
2700 IFP(Z3+&H1)THEND3=&H4:GOTO2730
2710 IFP(Z3+&H12)THEND3=&H2:GOTO2730
2720 IFP(Z3-&H12)THEND3=&H1
2730 G3=&H73+D3
2740 OND3 GOTO2750,2760,2770,2780
2750 Y3=Y3-&H1:W3=NOTW3:GOTO2790
2760 Y3=Y3+&H1:W3=NOTW3:GOTO2790
2770 X3=X3-&H1:W3=NOTW3:GOTO2790
2780 X3=X3+&H1:W3=NOTW3
2790 IFX3-&H1D THENELSEX3=&HC:R3=M3+&H1:GOTO2810
2800 IFX3-&HB THENELSEX3=&H1C:R3=M3+&H1
2810 Z3=X3-&H53+Y3*&H12:IFZ3-&H99 THENELSEM3=.:GOTO2830
2820 IFM3 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X3,Y3),CHR$(&H7E):HCOLOR&H2:HPRINT(X3,Y3),CHR$(&H78+W3*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO2850
2830 HCOLORC3:HPRINT(X3,Y3),CHR$(G3+W3*&HE):IFZ3-&H99 THENELSEPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X3,Y3),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J3=.:GOTO2850
2840 IFAB-&H99 THENELSEHCOLOR&HB:HPRINT(A3,B3),CHR$(&H3B):GOTO3010
2850 IFAB-Z4 GOTO2870ELSEGOTO2860
2860 IFM4 GOTO2920ELSEGOTO2930
2870 IFAB-Z1 GOTO2890ELSEGOTO2880
2880 IFM1 GOTO2920ELSEGOTO2940
2890 IFAB-Z2 GOTO2910ELSEGOTO2900
2900 IFM2 GOTO2920ELSEGOTO2950
2910 GOTO2960
2920 HCOLOR&H8:HPRINT(A3,B3),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A3,B3),CHR$(&H78+W3*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO3010
2930 HCOLORC4:HPRINT(A3,B3),CHR$(G4):GOTO3010
2940 HCOLORC1:HPRINT(A3,B3),CHR$(G1):GOTO3010
2950 HCOLORC2:HPRINT(A3,B3),CHR$(G2):GOTO3010
2960 ONP(AB)GOTO2970,3000,3000,3000,2980,3000,3000,3000,3000,2990:GOTO3000
2970 HCOLOR&H9:HPRINT(A3,B3),CHR$(&H24):GOTO3010
2980 HCOLOR&HE:HPRINT(A3,B3),CHR$(&H25):GOTO3010
2990 GOSUB600:GOTO3010
3000 HPRINT(A3,B3),CHR$(&H20)
3010 IFZ-Z3 GOTO3230
3020 GOSUB4060:GOTO3230
3030 U=P(Z3-&H1):IFU ANDX3<X THEND3=&H3:RETURN
3040 IFP(Z3-&H12)THEND3=&H1:RETURN
3050 IFP(Z3+&H1)THEND3=&H4:RETURN
3060 IFU THEND3=&H3:RETURN
3070 RETURN
3080 U=P(Z3-&H1):IFU ANDX3<X THEND3=&H3:RETURN
3090 IFP(Z3+&H12)THEND3=&H2:RETURN
3100 IFP(Z3+&H1)THEND3=&H4:RETURN
3110 IFU THEND3=&H3:RETURN
3120 D3=&H3:RETURN
3130 U=P(Z3-&H12):IFU ANDY3<Y THEND3=&H1:RETURN
3140 IFP(Z3-&H1)THEND3=&H3:RETURN
3150 IFP(Z3+&H12)THEND3=&H2:RETURN
3160 IFU THEND3=&H1:RETURN
3170 RETURN
3180 U=P(Z3-&H12):IFU ANDY3>Y THEND3=&H1:RETURN
3190 IFP(Z3+&H1)THEND3=&H4:RETURN
3200 IFP(Z3+&H12)THEND3=&H2:RETURN
3210 IFU THEND3=&H1:RETURN
3220 RETURN
3230 IFPW GOSUB3270
3240 IFR4 THENR4=R4-&H1:FORT=1TO40:NEXT:HCOLORC4:G4=&H77+O*2:HPRINT(X4,Y4),CHR$(G4+O*&HE):FORT=1TO40:NEXT:RETURN
3250 IFO THENELSERETURN
3260 A4=X4:B4=Y4:AB=Z4:ONJ4+&H1 GOTO3290:GOTO3310
3270 ONCD GOTO3280:RETURN
3280 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
3290 IFM4 THENOND4 GOSUB3810,3860,3900,3940:GOTO3520
3300 OND4 GOTO3350,3400,3440,3480:GOTO3520
3310 IFZ4-&HAB THENELSED4=&H1:GOTO3520
3320 IFZ4-&HAC THENELSED4=&H3:GOTO3520
3330 IFZ4-&HAA THENELSED4=&H4:GOTO3520
3340 GOTO3520
3350 U=P(Z4-&H1):IFU ANDX4>X THEND4=&H3:GOTO3510
3360 IFP(Z4-&H12)THEND4=&H1:GOTO3510
3370 IFP(Z4+&H1)THEND4=&H4:GOTO3510
3380 IFU THEND4=&H3:GOTO3510
3390 GOTO3510
3400 IFP(Z4+&H12)THEND4=&H2:GOTO3510
3410 IFP(Z4+&H1)THEND4=&H4:GOTO3510
3420 IFP(Z4-&H1)THEND4=&H3:GOTO3510
3430 D4=&H3:GOTO3510
3440 IFP(Z4-&H1)THEND4=&H3:GOTO3510
3450 IFP(Z4+&H12)THEND4=&H2:GOTO3510
3460 IFP(Z4-&H12)THEND4=&H1:GOTO3510
3470 GOTO3510
3480 IFP(Z4+&H1)THEND4=&H4:GOTO3510
3490 IFP(Z4+&H12)THEND4=&H2:GOTO3510
3500 IFP(Z4-&H12)THEND4=&H1
3510 G4=&H73+D4
3520 OND4 GOTO3530,3540,3550,3560
3530 Y4=Y4-&H1:W4=NOTW4:GOTO3570
3540 Y4=Y4+&H1:W4=NOTW4:GOTO3570
3550 X4=X4-&H1:W4=NOTW4:GOTO3570
3560 X4=X4+&H1:W4=NOTW4
3570 IFX4-&H1D THENELSEX4=&HC:R4=M4+&H1:GOTO3590
3580 IFX4-&HB THENELSEX4=&H1C:R4=M4+&H1
3590 Z4=X4-&H53+Y4*&H12:IFZ4=&H99 THENM4=.:GOTO3610
3600 IFM4 THENPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&H8:HPRINT(X4,Y4),CHR$(&H7E):HCOLOR&H2:HPRINT(X4,Y4),CHR$(&H78+W4*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO3630
3610 HCOLORC4:HPRINT(X4,Y4),CHR$(G4+W4*&HE):IFZ4-&H99 THENELSEPOKE&HF00D,&HA4:POKE&HF00E,&H84:HCOLOR&HB:HPRINT(X4,Y4),CHR$(&H3B):POKE&HF00D,&H94:POKE&HF00E,&HB3:J4=.:GOTO3630
3620 IFAB-&H99 THENELSEHCOLOR&HB:HPRINT(A4,B4),CHR$(&H3B):GOTO3790
3630 IFAB-Z1 GOTO3650ELSEGOTO3640
3640 IFM1 GOTO3700ELSEGOTO3710
3650 IFAB-Z2 GOTO3670ELSEGOTO3660
3660 IFM2 GOTO3700ELSEGOTO3720
3670 IFAB-Z3 GOTO3690ELSEGOTO3680
3680 IFM3 GOTO3700ELSEGOTO3730
3690 GOTO3740
3700 HCOLOR&H8:HPRINT(A4,B4),CHR$(&H7E):HCOLOR&H2:POKE&HF00D,&HA4:POKE&HF00E,&H84:HPRINT(A4,B4),CHR$(&H78+W4*&HE):POKE&HF00D,&H94:POKE&HF00E,&HB3:GOTO3790
3710 HCOLORC1:HPRINT(A4,B4),CHR$(G1):GOTO3790
3720 HCOLORC2:HPRINT(A4,B4),CHR$(G2):GOTO3790
3730 HCOLORC3:HPRINT(A4,B4),CHR$(G3):GOTO3790
3740 ONP(AB)GOTO3750,3780,3780,3780,3760,3780,3780,3780,3780,3770:GOTO3780
3750 HCOLOR&H9:HPRINT(A4,B4),CHR$(&H24):GOTO3790
3760 HCOLOR&HE:HPRINT(A4,B4),CHR$(&H25):GOTO3790
3770 GOSUB600:GOTO3790
3780 HPRINT(A4,B4),CHR$(&H20)
3790 IFZ-Z4 THENRETURN
3800 GOSUB4100:RETURN
3810 U=P(Z4-&H1):IFU ANDX4<X THEND4=&H3:RETURN
3820 IFP(Z4-&H12)THEND4=&H1:RETURN
3830 IFP(Z4+&H1)THEND4=&H4:RETURN
3840 IFU THEND4=&H3:RETURN
3850 RETURN
3860 IFP(Z4+&H12)THEND4=&H2:RETURN
3870 IFP(Z4+&H1)THEND4=&H4:RETURN
3880 IFP(Z4-&H1)THEND4=&H3:RETURN
3890 D4=&H3:RETURN
3900 IFP(Z4+&H12)THEND4=&H2:RETURN
3910 IFP(Z4-&H1)THEND4=&H3:RETURN
3920 IFP(Z4-&H12)THEND4=&H1:RETURN
3930 RETURN
3940 IFP(Z4+&H1)THEND4=&H4:RETURN
3950 IFP(Z4+&H12)THEND4=&H2:RETURN
3960 IFP(Z4-&H12)THEND4=&H1:RETURN
3970 RETURN
3980 IFM1 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO4140
3990 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y1=&HD:M1=.:D1=&H1:G1=&H73+W1:R1=&H14-FR:J1=NOT.:K=K+&H1
4000 IFNOT(Z2=&HAC ORZ3=&HAC ORZ4=&HAC)THENZ1=&HAC:X1=&H15:W1=NOT.:D1=&H3:ELSEIFNOT(Z2=&HAA ORZ3=&HAA ORZ4=&HAA)THENZ1=&HAA:X1=&H13:W1=NOT.:D1=&H4:ELSEZ1=&HAB:X1=&H14:W1=.:D1=&H1
4010 RETURN
4020 IFM2 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO4140
4030 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y2=&HD:M2=.:D2=&H1:G2=&H73+W2:R2=&H14-FR:J2=NOT.:K=K+&H1
4040 IFNOT(Z1=&HAC ORZ3=&HAC ORZ4=&HAC)THENZ2=&HAC:X2=&H15:W2=NOT.:D2=&H3:ELSEIFNOT(Z1=&HAA ORZ3=&HAA ORZ4=&HAA)THENZ2=&HAA:X2=&H13:W2=NOT.:D2=&H4:ELSEZ2=&HAB:X2=&H14:W2=.:D2=&H1
4050 RETURN
4060 IFM3 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO4140
4070 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y3=&HD:M3=.:D3=&H1:G3=&H73+W3:R3=&H14-FR:J3=NOT.:K=K+&H1
4080 IFNOT(Z2=&HAC ORZ1=&HAC ORZ4=&HAC)THENZ3=&HAC:X3=&H15:W3=NOT.:D3=&H3:ELSEIFNOT(Z2=&HAA ORZ1=&HAA ORZ4=&HAA)THENZ3=&HAA:X3=&H13:W3=NOT.:D3=&H4:ELSEZ3=&HAB:X3=&H14:W3=.:D3=&H1
4090 RETURN
4100 IFM4 THENHCOLOR&H1:IFW THENHPRINT(X,Y),CHR$(&H21)ELSEHPRINT(X,Y),CHR$(B):ELSEGOTO4140
4110 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y4=&HD:M4=.:D4=&H1:G4=&H73+W4:R4=&H14-FR:J4=NOT.:K=K+&H1
4120 IFNOT(Z2=&HAC ORZ3=&HAC ORZ1=&HAC)THENZ4=&HAC:X4=&H15:W4=NOT.:D4=&H3:ELSEIFNOT(Z2=&HAA ORZ3=&HAA ORZ1=&HAA)THENZ4=&HAA:X4=&H13:W4=NOT.:D4=&H4:ELSEZ4=&HAB:X4=&H14:W4=.:D4=&H1
4130 RETURN
4140 HCOLOR&H1:HPRINT(X,Y),CHR$(&H6B):PLAY"V31;O3;7;V27;7;V28;5;5;O4;4;O3;5;V27;5;V28;7;V27;7;V26;7;V27;8;V26;5;V27;5;O4;4;O3;4;4;V28;2;V27;4;4;V26;O4;4;"
4150 HPRINT(X,Y),CHR$(&H6C):PLAY"V27;O3;5;V26;5;7;O4;4;O3;4;4;V27;2;V26;2;V27;2;2;V26;2;4;4;O4;4;V25;O3;5;4;2;V26;2;O4;1;O2;12;12;12;O4;1;O3;2;2;"
4160 HPRINT(X,Y),CHR$(&H71):PLAY"V25;4;4;V24;2;V25;2;V24;O2;12;V25;12;9;9;V24;9;12;V25;12;V24;O4;1;O3;2;V23;2;O2;12;V24;12;V23;9;V24;9;V25;O3;8;"
4170 HPRINT(X,Y),CHR$(&H72):PLAY"V23;O2;7;V24;9;9;O1;7;V29;O2;7;V28;O3;4;V27;8;V26;12;V24;O4;3;V23;5;V22;7;V21;9;V20;11;V18;O5;1;V19;O1;1;"
4180 HPRINT(X,Y),CHR$(&H73):PLAY"V24;12;V30;O2;7;V28;O3;4;V27;8;V26;12;V24;O4;3;V23;5;V22;7;V21;9;V20;11;V18;O5;1;V3;O1;1;V2;1;V15;P1;P1;P1;"
4190 HPRINT(X,Y),CHR$(&H20):NL=NL-&H1:IFNL=. THENHCOLOR&H3:HPRINT(16,&HF),"GAME OVER":GOSUB4830:HCLS0:RESTORE:GOTO4340
4200 U=P(Z1):IFU=&H1 THENHCOLOR&H9:HPRINT(X1,Y1),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X1,Y1),CHR$(&H25):ELSEHPRINT(X1,Y1),CHR$(&H20)
4210 U=P(Z2):IFU=&H1 THENHCOLOR&H9:HPRINT(X2,Y2),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X2,Y2),CHR$(&H25):ELSEHPRINT(X2,Y2),CHR$(&H20)
4220 U=P(Z3):IFU=&H1 THENHCOLOR&H9:HPRINT(X3,Y3),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X3,Y3),CHR$(&H25):ELSEHPRINT(X3,Y3),CHR$(&H20)
4230 U=P(Z4):IFU=&H1 THENHCOLOR&H9:HPRINT(X4,Y4),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X4,Y4),CHR$(&H25):ELSEHPRINT(X4,Y4),CHR$(&H20)
4240 U=P(Z):IFU=&H1 THENHCOLOR&H9:HPRINT(X,Y),CHR$(&H24):ELSEIFU=&H5 THENHCOLOR&HE:HPRINT(X,Y),CHR$(&H25):ELSEHPRINT(X,Y),CHR$(&H20)
4250 HPRINT(NL+&HB,23),CHR$(&H20):X=&H14:Y=&H11:HCOLOR&H1:HPRINT(X,Y),CHR$(&H22):P(&HCF)=&HF:GOTO4580
4260 PCLEAR1:POKE&HFFD8,0:LOADM"PACTILES.BIN":POKE&HFFD9,0:POKE&HADEB,57:POKE&HE414,0:POKE&HE42A,0:POKE359,255:POKE&HF00E,&H84:POKE&HF00D,&H94:POKE&HF00E,&HB3
4270 POKE&HE649,&H10:POKE&HE664,&H0:POKE&HE666,&HB:POKE&HE66A,&H3D:POKE&HE66B,&H34:POKE&HE66C,&H3C:POKE&HE66D,&H3C:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,&H3F:POKE&HE673,&H1C:RGB
4280 HSCREEN2
4290 DIM P(&H156),X,Y,Z,G,W,O,X1,Y1,Z1,D1,G1,C1,W1,X2,Y2,Z2,D2,G2,C2,W2,X3,Y3,Z3,D3,G3,C3,W3,X4,Y4,Z4,D4,G4,C4,W4,A,C,AB,A1,B1,A2,B2,A3,B3,A4,B4,PW,K
4300 E1$="V30;O2;7;V29;7;V28;7;V27;7;7;V25;7;V24;7;V18;7;V17;7;V14;7;V12;7;V30;7;V28;7;7;V27;7;7;V25;7;V23;7;V18;7;V17;7;V15;7;V12;7;V11;7;V31;7;V29;7;V28;7;V27;7;V26;7;V25;7;V23;7;V18;7;V16;7;V14;7;V17;7;V28;7;V29;7;V27;7;7;V26;7;V25;7;V23;7"
4310 E2$="V18;7;V16;7;V14;7;V12;7;V17;7;V30;7;V28;7;7;V27;7;7;V24;7;V22;7;V18;7;V16;7;V14;7;V18;7;V29;7;V28;7;7;V27;7;V26;7;V25;7;V22;7;V18;7;V16;7;V14;7;V11;7;V20;7;V29;7;7;V27;7;7;V26;7;V24;7;V22;7;V18;7;V16;7;V14;7;V21;7;V29;7;V28;7;V27;7;7"
4320 E3$="V26;7;V24;7;V22;7;V18;7;V16;7;V14;7;V11;7;V21;O1;1;V29;O2;7;V28;7;7;V26;7;7;V24;7;V21;7;V18;7;V15;7;V13;7;V23;7;V29;7;V28;7;V27;7;7;V26;7;V24;7;V21;7;V17;7;V15;7;V13;7;V10;7;V15;"
4330 GK$="T255;L255;V14;O1;1;V11;1;V21;1;V28;7;V31;12;V19;O2;4;V18;4;V29;7;V16;9;V27;12;V18;O3;2;V27;2;V18;4;V24;5;V25;7;V20;7;8;V22;9;11;12;V21;12;O4;1;2;V22;3;V23;3;V21;4;V19;4;V23;5;V20;6;6;V21;7;V12;O1;1;V4;1;V1;1;V15"
4340 HCLS0:G1=&H69:G2=&H69:G3=&H69:G4=&H69:FR=&H1:NL=&H3:S=.:OS=.:LM=.:BC=&HC:C1=&H3:C2=&H6:C3=&H5:C4=&H7:MZ=&H1:BL=.
4350 HCOLOR&H9,0:HPRINT(9,1),"COCOdSYNTHESIS PRESENTS":FORT=1TO3000:NEXT
4360 POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H1:FORT=8TO31:HPRINT(T-1,1),CHR$(&H20)+CHR$(&H22):PLAY"T255;L255;V20;O3;9;V23;7;V24;4;V25;1;V26;O2;7;V14;7;P255;P255;P255;"
4370 HPRINT(T,1),CHR$(&H21):PLAY"V23;O2;4;V27;9;V26;O3;1;4;V25;8;V10;O2;4;P255;P255;P255;":NEXT:HPRINT(31,1),CHR$(&H20)
4380 HCOLOR&H4:HPRINT(18,0),"BASIC":HCOLOR&H1:HPRINT(17,1),"pacdman":FORT=1TO3000:NEXT:HCOLOR&H4:HPRINT(9,4),"INTRODUCING THE GHOSTS":FORT=1TO1000:NEXT
4390 X=&H2:HCOLORC1:FORY=23TO5 STEP-1:HPRINT(2,Y+1),CHR$(&H20):HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H74):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:NEXT
4400 HPRINT(9,4),STRING$(22," "):HPRINT(2,5),CHR$(G1)+" BLINKY"
4410 HCOLORC2:FORY=23TO7 STEP-1:HPRINT(2,Y+1),CHR$(&H20):HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H74):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:NEXT
4420 HPRINT(2,7),CHR$(G1)+" PINKY"
4430 HCOLORC3:FORY=23TO9 STEP-1:HPRINT(2,Y+1),CHR$(&H20):HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H74):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:NEXT
4440 HPRINT(2,9),CHR$(G1)+" INKY"
4450 HCOLORC4:FORY=23TO11 STEP-1:HPRINT(2,Y+1),CHR$(&H20):HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H74):FORT=1TO150:NEXT:HPRINT(2,Y),CHR$(&H66):FORT=1TO150:NEXT:NEXT
4460 HPRINT(2,11),CHR$(G1)+" CLYDE"
4470 FORT=1TO1000:NEXT:HCOLOR&H9:HPRINT(30,9),CHR$(&H24):HCOLOR&H4:HPRINT(32,9),"10 PTS":HCOLOR&HE:HPRINT(30,11),CHR$(&H25):HCOLOR&H4:HPRINT(32,11),"50 PTS"
4480 HCOLOR&H4:HPRINT(33,3),"1UP":HCOLORBC:HPRINT(30,4),CHR$(&H5B)+STRING$(7,CHR$(&H26))+CHR$(&H5D):HPRINT(30,5),CHR$(&H2E):HCOLOR&H4:HPRINT(36,5),"00":HCOLORBC:HPRINT(38,5),CHR$(&H2E)
4490 HPRINT(30,6),CHR$(&H5C)+STRING$(7,CHR$(&H26))+CHR$(&H5E)
4500 IFFR>&H7 THENFR=&H7:BL=BL+&H1
4510 PL=.:PP=.:Z=.:POKE&HE47B,38:POKE&HE47C,54:ONERR GOTO4940
4520 MF$="MAZE"+STR$(MZ):OPEN "I",#1,MF$:INPUT#1,PC:POKE&HE670,PC:RGB:HCOLORBC:MZ=MZ+&H1
4530 FORY=1TO19:FORX=1TO17
4540 Z=X-&H12+&H12*Y:INPUT#1,B:IFB=&H24 THENHCOLOR&H9:P(Z)=&H1:PP=PP+&H1:ELSEIFB=&H25 THENHCOLOR&HE:P(Z)=&H5:ELSEIFB=&H3B THENHCOLOR&HB:P(Z)=.:ELSEIFB=&H20 THENHCOLOR&H0:P(Z)=&H2:ELSEIFB=&H22 THENHCOLOR&H1:P(Z)=&H2:ELSEP(Z)=.
4550 HPRINT(X+&HB,Y+&H3),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1
4560 IFFR=&H1 GOSUB4830
4570 POKE&HE47B,18:POKE&HE47C,18
4580 POKE&HF00D,&HA4:POKE&HF00E,&H84:K=.:X1=&H14:Y1=&HB:D1=&H2:G1=&H74:Z1=&H87:M1=.:W1=.:X2=&H14:Y2=&HD:D2=&H1:G2=&H74:Z2=&HAB:M2=.:W2=.
4590 X3=&H13:Y3=&HD:D3=&H4:G3=&H67:Z3=&HAA:M3=.:W3=NOT.:X4=&H15:Y4=&HD:D4=&H4:G4=&H67:Z4=&HAC:M4=.:W4=NOT.:J1=.:J2=NOT.:J3=NOT.:J4=NOT.
4600 HCOLORC1:HPRINT(X1,Y1),CHR$(G1):HCOLORC2:HPRINT(X2,Y2),CHR$(G2):HCOLORC3:HPRINT(X3,Y3),CHR$(G3):HCOLORC4:HPRINT(X4,Y4),CHR$(G4)
4610 ONFR GOTO4620,4630,4640,4650,4660,4670,4680
4620 FT=30:CT=30:R1=.:R2=10:R3=20:R4=30:HCOLOR&H3:HPRINT(28,23),CHR$(&H3C):HCOLOR&H4:HPRINT(28,23),CHR$(&H3D):HCOLOR&HD:HPRINT(28,23),CHR$(&H3E):GOTO4690
4630 FT=30:CT=27:R1=.:R2=9:R3=18:R4=27:HCOLOR&H3:HPRINT(27,23),CHR$(&H3F):HCOLOR&HD:HPRINT(27,23),CHR$(&H40):GOTO4690
4640 FT=30:CT=24:R1=.:R2=8:R3=16:R4=24:HCOLOR&H7:HPRINT(26,23),CHR$(&H23):HCOLOR&HD:HPRINT(26,23),CHR$(&H40):GOTO4690
4650 FT=30:CT=21:R1=.:R2=7:R3=14:R4=21:HCOLOR&H3:HPRINT(25,23),CHR$(&H62):HCOLOR&HD:HPRINT(25,23),CHR$(&H40):GOTO4690
4660 FT=30:CT=18:R1=.:R2=6:R3=12:R4=18:HCOLOR&HD:HPRINT(24,23),CHR$(&H79):HCOLOR&HF:HPRINT(24,23),CHR$(&H7A):GOTO4690
4670 FT=30:CT=15:R1=.:R2=5:R3=&HA:R4=15:HCOLOR&H4:HPRINT(23,23),CHR$(&H6F):HCOLOR&H5:HPRINT(23,23),CHR$(&H7F):GOTO4690
4680 FT=30:CT=15:R1=.:R2=4:R3=8:R4=12:HCOLOR&H1:HPRINT(22-BL,23),CHR$(&H7D):HCOLOR&H5:HPRINT(22-BL,23),CHR$(&H5F):GOTO4690
4690 POKE&HF00D,&H94:POKE&HF00E,&HB3:HCOLOR&H1:HPRINT(&H12,&HF),"READY"+CHR$(96)
4700 PLAY"V26;O1;1;V29;O3;2;V30;2;2;V23;O1;1;V17;7;V16;7;V13;7;V25;O4;2;V27;2;2;2;V15;O1;1;V3;1;V1;1;P255;V21;O3;8;V25;8;8;V26;8;V17;O1;1;V3;1;V1;1;P255;V27;O3;5;V28;5;V30;5;V29;5;V22;O1;12;V17;7;V16;7;V12;12;V27;O4;2;V28;2;2;2;O3;8;8;8;V27;8"
4710 PLAY"V19;O1;1;V10;1;V8;1;V6;1;V4;7;V2;7;P255;P255;V27;O3;5;V26;5;5;5;V27;5;5;5;5;V24;O1;7;V22;7;V20;12;V19;12;V18;7;V17;7;V16;12;V12;7;V31;O3;2;V29;4;2;V30;2;V18;O1;1;V17;7;V16;7;V12;7;V27;O4;3;3;3;3;V12;O1;1;V4;1;V1;1;V10;1;V26;O3;9;9;9"
4720 PLAY"9;V8;O1;1;V3;1;V1;1;V5;1;V30;O3;7;V29;7;7;V28;7;V19;O1;12;V17;12;V15;12;V16;7;V29;O4;3;V28;3;3;3;O3;9;V27;9;V28;9;V27;9;V13;O1;1;V10;1;V8;1;V5;7;V4;7;V1;1;P255;V13;O1;1;V26;O3;7;7;7;7;7;V27;7;7;V26;7;V22;O1;7;V21;12;V20;12;V19;7"
4730 PLAY"V18;7;V16;12;V15;12;V21;12;V30;O3;2;V29;2;2;V28;2;V17;O1;1;1;V15;1;V19;1;V27;O4;2;2;2;V24;2;V4;O1;1;V2;1;P255;V18;O1;1;V25;O3;8;V26;8;8;V21;8;P255;P255;P255;V19;O3;5;V30;5;V28;5;V29;5;V26;5;V18;O1;12;V16;7;V14;7;V21;7;V29;O4;2;V28;2"
4740 PLAY"V29;2;V27;2;V28;O3;8;8;8;V24;8;V11;O1;7;V9;1;V7;1;V5;1;V2;1;P255;P255;V21;O1;1;V26;O3;5;5;5;V27;5;5;5;5;V26;5;V23;O1;7;V21;7;V19;12;12;V17;7;V16;7;V14;12;V25;O3;4;V29;5;V30;4;V29;5;5;V28;5;V29;5;V28;5;7;7;7;7;V22;O1;1;V5;1;V2;1;P255"
4750 PLAY"V25;O1;7;V30;O3;7;V29;7;V28;7;V29;8;V27;8;V28;8;V27;8;8;8;8;8;V19;O1;1;V4;1;V2;1;P255;V26;O3;8;V28;8;8;V27;8;V28;9;V27;9;9;9;11;11;V28;11;11;V19;O1;1;V6;1;V2;1;P255;V27;O4;2;V28;2;V29;2;V28;2;V29;2;V28;2;2;2;V21;O2;4;V15;4;V13;O1;12"
4760 PLAY"V9;12;V7;12;V4;12;V2;1;V15;P1;P1;":HCOLOR&H9:HPRINT(&H14,&HF),CHR$(&H20)
4770 IFP(&HCD)=&H1 THENHPRINT(&H12,&HF),CHR$(&H24)ELSEHPRINT(&H12,&HF),CHR$(&H20)
4780 IFP(&HCE)=&H1 THENHPRINT(&H13,&HF),CHR$(&H24)ELSEHPRINT(&H13,&HF),CHR$(&H20)
4790 IFP(&HD0)=&H1 THENHPRINT(&H15,&HF),CHR$(&H24)ELSEHPRINT(&H15,&HF),CHR$(&H20)
4800 IFP(&HD1)=&H1 THENHPRINT(&H16,&HF),CHR$(&H24)ELSEHPRINT(&H16,&HF),CHR$(&H20)
4810 IFP(&HD2)=&H1 THENHPRINT(&H17,&HF),CHR$(&H24)ELSEHPRINT(&H17,&HF),CHR$(&H20)
4820 X=&H14:Y=&H11:B=&H22:PD=&H4:OB=B:Z=&HF3:PW=.:C1=&H3:C2=&H6:C3=&H5:C4=&H7:W=.:GOTO20
4830 HCOLOR&HE:HPRINT(10,23),"PRESS BUTTON TO START"
4840 IFBUTTON(.)GOTO4920
4850 IFFL=&H1 THENPOKE&HFFBE,&H3C
4860 IFBUTTON(.)GOTO4920
4870 IFFL=&H14 THENPOKE&HFFBE,&H3F
4880 IFBUTTON(.)GOTO4920
4890 IFFL=&H28 THENFL=.
4900 IFBUTTON(.)GOTO4920
4910 FL=FL+&H1:GOTO4840
4920 HCOLOR.:HPRINT(10,23),"PRESS BUTTON TO START":IFFR=&H1 ANDNL THENHCOLOR&H1:HPRINT(12,23),STRING$(NL-&H1,CHR$(&H22))
4930 RETURN
4940 IFERNO=26 THENMZ=&H1:GOTO4520:ELSEGOTO4570
