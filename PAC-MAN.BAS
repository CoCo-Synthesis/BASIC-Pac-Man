0 GOTO309
1 A=X:C=Y:G=Z:OS=S
2 IFPW THENCD=CD-I:IFM1+M2+M3+M4 THENELSEPW=.:CD=.
3 O=NOTO:POKEP3,V5:FT=FT-I:POKEP4,RND(V6):POKEP3,V6:TIMER=.:GOSUB63:IFFT=. GOSUB45
4 IFTIMER<19GOTO4
5 OD=PD:OB$=B$:ONFIX(JOYSTK(.)/JD)+I GOTO6,8,7
6 PD=&H3:B$=PL$:GOTO14
7 PD=&H4:B$=QT$:GOTO17
8 ONFIX(JOYSTK(I)/JD)+I GOTO9,11,10
9 PD=I:B$=PU$:GOTO12
10 PD=&H2:B$=PD$:GOTO13
11 ONPD GOTO12,13,14,17:GOTO19
12 Y=Y-I:GOTO19
13 Y=Y+I:GOTO19
14 X=X-I:IFX=RC THENX=LB:GOTO19
15 IFX=LC THENX=RB:GOTO19
16 GOTO19
17 X=X+I:IFX=RC THENX=LB:GOTO19
18 IFX=LC THENX=RB
19 Z=X-XA+Y*YA:IFP(Z)GOTO33
20 X=A:Y=C:Z=G:PD=OD:B$=OB$:ONOD GOTO21,23,25,29:GOTO33
21 Y=Y-I:Z=X-XA+Y*YA:IFP(Z)GOTO19
22 X=A:Y=C:Z=G:PD=OD:GOTO2
23 Y=Y+I:Z=X-XA+Y*YA:IFP(Z)GOTO19
24 X=A:Y=C:Z=G:PD=OD:GOTO2
25 X=X-I:IFX=RC THENX=LB:GOTO27
26 IFX=LC THENX=RB
27 Z=X-XA+Y*YA:IFP(Z)GOTO19
28 X=A:Y=C:Z=G:PD=OD:GOTO2
29 X=X+I:IFX=RC THENX=LB:GOTO31
30 IFX=LC THENX=RB
31 Z=X-XA+Y*YA:IFP(Z)GOTO19
32 X=A:Y=C:Z=G:PD=OD:GOTO2
33 HCOLORI:HPRINT(X,Y),"!":HPRINT(A,C)," ":W=NOTW:IFZ=Z1 THENGOSUB281
34 IFZ=Z2 THENGOSUB285
35 IFZ=Z3 THENGOSUB289
36 IFZ=Z4 THENGOSUB293
37 U=P(Z):ONU GOTO38,42,42,42,39,42,42,42,42,41:GOTO42
38 S=S+U:P(Z)=&H2:PP=PP-I:PLAY"V20O4G":GOTO44
39 PLAY"V18O3D-V24O2BV29G-V24DV16O1BV14G-V3G-G-V8G-V26G-V19BV24O2DV31DV25G-V15A-V20A-V27BV18O3D-V11DV4DV2DV3DDV2DDV1DV15"
40 S=S+U:P(Z)=&H2:PL=PL+I:PW=I:M1=NOTJ1:M2=NOTJ2:M3=NOTJ3:M4=NOTJ4:CD=CT:K=.:RGB:GOTO44
41 PLAY"V27O3D-V29O2BA-V28G-E-E-O1BV31G-V29CV27CV23CV27CV29CV30G-V29BV27O2E-E-V28G-V29A-V28BO3D-D-V27E-V12O1CV4CV1CV15":S=S+FR*&HA:P(Z)=&H2:GOTO44
42 PLAY"V5O1CV15":IFS-OS GOTO44
43 IFPP=. ANDPL=&H4 THENFR=FR+I:HCOLOR.:HPRINT(X,Y)," ":HPRINT(X1,Y1)," ":HPRINT(X2,Y2)," ":HPRINT(X3,Y3)," ":HPRINT(X4,Y4)," ":GOTO334:ELSE1
44 S$=MID$(STR$(S),&H2):PO=LEN(S$):HCOLOR&H4:HPRINT(&H25-PO,&H5),S$:IFS-LM>&H3E7 THENPLAY"T255L255XE1$;XE2$;XE3$;":LM=LM+&H3E8:NL=NL+I:HCOLORI:HPRINT(LB,&H17),STRING$(NL-I,QT$):GOTO43:ELSE43
45 OC=NOTOC:IFOC THENP(&HCF)=&HA:ONFR GOTO46,47,48,49,50,51,52:GOTO53:ELSE53
46 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"<":HCOLOR&H4:HPRINT(&H14,&HF),"=":HCOLOR&HD:HPRINT(&H14,&HF),">":FT=&H1E:POKEP1,V1:POKEP2,V2:RETURN
47 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"?":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H1B:POKEP1,V1:POKEP2,V2:RETURN
48 POKEP1,V3:POKEP2,V4:HCOLOR&H7:HPRINT(&H14,&HF),"#":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H18:POKEP1,V1:POKEP2,V2:RETURN
49 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"b":HCOLOR&HD:HPRINT(&H14,&HF),"@":FT=&H15:POKEP1,V1:POKEP2,V2:RETURN
50 POKEP1,V3:POKEP2,V4:HCOLOR&HD:HPRINT(&H14,&HF),"y":HCOLOR&HF:HPRINT(&H14,&HF),"z":FT=&H12:POKEP1,V1:POKEP2,V2:RETURN
51 POKEP1,V3:POKEP2,V4:HCOLOR&H4:HPRINT(&H14,&HF),"o":HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):FT=&HF:POKEP1,V1:POKEP2,V2:RETURN
52 POKEP1,V3:POKEP2,V4:HCOLORI:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):FT=&HC:POKEP1,V1:POKEP2,V2:RETURN
53 HPRINT(&H14,&HF)," ":P(&HCF)=&HF:FT=&H1E:RETURN
54 P(&HCF)=&HA:HPRINT(&H14,&HF)," ":ONFR GOTO55,56,57,58,59,60,61:GOTO62
55 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"<":HCOLOR&H4:HPRINT(&H14,&HF),"=":HCOLOR&HD:HPRINT(&H14,&HF),">":POKEP1,V1:POKEP2,V2:RETURN
56 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"?":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
57 POKEP1,V3:POKEP2,V4:HCOLOR&H7:HPRINT(&H14,&HF),"#":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
58 POKEP1,V3:POKEP2,V4:HCOLOR&H3:HPRINT(&H14,&HF),"b":HCOLOR&HD:HPRINT(&H14,&HF),"@":POKEP1,V1:POKEP2,V2:RETURN
59 POKEP1,V3:POKEP2,V4:HCOLOR&HD:HPRINT(&H14,&HF),"y":HCOLOR&HF:HPRINT(&H14,&HF),"z":POKEP1,V1:POKEP2,V2:RETURN
60 POKEP1,V3:POKEP2,V4:HCOLOR&H4:HPRINT(&H14,&HF),"o":HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H7F):POKEP1,V1:POKEP2,V2:RETURN
61 POKEP1,V3:POKEP2,V4:HCOLORI:HPRINT(&H14,&HF),CHR$(&H7D):HCOLOR&H5:HPRINT(&H14,&HF),CHR$(&H5F):POKEP1,V1:POKEP2,V2:RETURN
62 HPRINT(&H14,&HF)," ":P(&HCF)=&HF:RETURN
63 IFPW GOSUB67
64 IFR1 THENR1=R1-I:HCOLORC1:G1=&H77+O:HPRINT(X1,Y1),CHR$(G1+O*HE):GOTO118
65 IFM1 ANDO THENGOTO118
66 A1=X1:B1=Y1:AB=Z1:ONJ1+I GOTO70:GOTO72
67 ONCD GOTO68,69,69,69,69,69,69:RETURN
68 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
69 POKE&HFFB2,V6:POKE&HFFB8,&H24:RETURN
70 IFM1 THENOND1 GOSUB110,112,114,116:GOTO82
71 OND1 GOTO74,76,78,80:GOTO82
72 IFZ1=JC THEND1=I ELSEIFZ1=JR THEND1=&H3 ELSEIFZ1=JL THEND1=&H4
73 GOTO82
74 U=P(Z1+I):IFU ANDX1<X THEND1=&H4 ELSEIFP(Z1-YA)THEND1=I ELSEIFU THEND1=&H4 ELSEIFP(Z1-I)THEND1=&H3
75 GOTO81
76 U=P(Z1+I):IFP(Z1-I)ANDX1>X THEND1=&H3 ELSEIFU ANDX1<X THEND1=&H4 ELSEIFP(Z1+YA)THEND1=&H2 ELSEIFU THEND1=&H4 ELSED1=&H3
77 GOTO81
78 Q=P(Z1-YA):U=P(Z1+YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1<Y THEND1=&H2 ELSEIFP(Z1-I)THEND1=&H3 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
79 GOTO81
80 Q=P(Z1-YA):U=P(Z1+YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1<Y THEND1=&H2 ELSEIFP(Z1+I)THEND1=&H4 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
81 G1=&H73+D1
82 OND1 GOTO83,84,85,86
83 Y1=Y1-I:GOTO87
84 Y1=Y1+I:GOTO87
85 X1=X1-I:GOTO87
86 X1=X1+I
87 W1=NOTW1:IFX1=RC THENX1=LB:R1=M1+I:GOTO89
88 IFX1=LC THENX1=RB:R1=M1+I
89 Z1=X1-XA+Y1*YA:IFZ1=LG THENM1=.:GOTO91
90 IFM1 THEN POKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X1,Y1),UP$:HCOLOR&H2:HPRINT(X1,Y1),CHR$(&H78+W1*HE):POKEP1,V1:POKEP2,V2:GOTO93
91 HCOLORC1:HPRINT(X1,Y1),CHR$(G1+W1*HE):IFZ1=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X1,Y1),";":POKEP1,V1:POKEP2,V2:J1=.:GOTO93
92 IFAB=LG THENHCOLORLC:HPRINT(A1,B1),";":GOTO108
93 IFAB=Z2 GOTO94ELSE95
94 IFM2 GOTO99ELSE100
95 IFAB=Z3 GOTO96ELSE97
96 IFM3 GOTO99ELSE101
97 IFAB=Z4 GOTO98ELSE103
98 IFM4 GOTO99ELSE102
99 HCOLOR&H8:HPRINT(A1,B1),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A1,B1),CHR$(&H78+W1*HE):POKEP1,V1:POKEP2,V2:GOTO108
100 HCOLORC2:HPRINT(A1,B1),CHR$(G2):GOTO108
101 HCOLORC3:HPRINT(A1,B1),CHR$(G3):GOTO108
102 HCOLORC4:HPRINT(A1,B1),CHR$(G4):GOTO108
103 ONP(AB)GOTO104,107,107,107,105,107,107,107,107,106:GOTO107
104 HCOLOR&H9:HPRINT(A1,B1),"$":GOTO108
105 HCOLORHE:HPRINT(A1,B1),"%":GOTO108
106 GOSUB54:GOTO108
107 HPRINT(A1,B1)," "
108 IFZ-Z1 GOTO118
109 GOSUB281:GOTO118
110 U=P(Z1+I):IFU ANDX1>X THEND1=&H4 ELSEIFP(Z1-YA)THEND1=I ELSEIFU THEND1=&H4 ELSEIFP(Z1-I)THEND1=&H3
111 RETURN
112 U=P(Z1+I):IFP(Z1-I)ANDX1<X THEND1=&H3 ELSEIFU ANDX1>X THEND1=&H4 ELSEIFP(Z1+YA)THEND1=&H2 ELSEIFU THEND1=&H4 ELSED1=&H3
113 RETURN
114 U=P(Z1+YA):Q=P(Z1-YA):IFQ ANDY1<Y THEND1=I ELSEIFU ANDY1>Y THEND1=&H2 ELSEIFP(Z1-I)THEND1=&H3 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
115 RETURN
116 U=P(Z1+YA):Q=P(Z1-YA):IFQ ANDY1>Y THEND1=I ELSEIFU ANDY1>Y THEND1=&H2 ELSEIFP(Z1+I)THEND1=&H4 ELSEIFU THEND1=&H2 ELSEIFQ THEND1=I
117 RETURN
118 IFPW GOSUB122
119 IFR2 THENR2=R2-I:HCOLORC2:G2=&H76+O:HPRINT(X2,Y2),CHR$(G2+O*HE):GOTO172
120 IFM2 ANDO THENGOTO172
121 A2=X2:B2=Y2:AB=Z2:ONJ2+I GOTO124:GOTO126
122 ONCD GOTO123:RETURN
123 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
124 IFM2 THENOND2 GOSUB164,166,168,170:GOTO136
125 OND2 GOTO128,130,132,134:GOTO136
126 IFZ2=JC THEND2=I ELSEIFZ2=JR THEND2=&H3 ELSEIFZ2=JL THEND2=&H4
127 GOTO136
128 Q=P(Z2-I):U=P(Z2+I):IFQ ANDX2>X THEND2=&H3 ELSEIFU ANDX2<X THEND2=&H4 ELSEIFP(Z2-YA)THEND2=I ELSEIFU THEND2=&H4 ELSEIFQ THEND2=&H3
129 GOTO135
130 U=P(Z2+I):IFP(Z2-I)ANDX2>X THEND2=&H3 ELSEIFU ANDX2<X THEND2=&H4 ELSEIFP(Z2+YA)THEND2=&H2 ELSEIFU THEND2=&H4 ELSED2=&H3
131 GOTO135
132 Q=P(Z2-YA):U=P(Z2+YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2<Y THEND2=&H2 ELSEIFP(Z2-I)THEND2=&H3 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
133 GOTO135
134 Q=P(Z2-YA):U=P(Z2+YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2<Y THEND2=&H2 ELSEIFP(Z2+I)THEND2=&H4 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
135 G2=&H73+D2
136 OND2 GOTO137,138,139,140
137 Y2=Y2-I:GOTO141
138 Y2=Y2+I:GOTO141
139 X2=X2-I:GOTO141
140 X2=X2+I
141 W2=NOTW2:IFX2=RC THENX2=LB:R2=M2+I:GOTO143
142 IFX2=LC THENX2=RB:R2=M2+I
143 Z2=X2-XA+Y2*YA:IFZ2=LG THENM2=.:GOTO145
144 IFM2 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X2,Y2),UP$:HCOLOR&H2:HPRINT(X2,Y2),CHR$(&H78+W2*HE):POKEP1,V1:POKEP2,V2:GOTO147
145 HCOLORC2:HPRINT(X2,Y2),CHR$(G2+W2*HE):IFZ2=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X2,Y2),";":POKEP1,V1:POKEP2,V2:J2=.:GOTO147
146 IFAB=LG THENHCOLORLC:HPRINT(A2,B2),";":GOTO162
147 IFAB=Z3 GOTO148ELSE149
148 IFM3 GOTO153ELSE154
149 IFAB=Z4 GOTO150ELSE151
150 IFM4 GOTO153ELSE155
151 IFAB=Z1 GOTO152ELSE157
152 IFM1 GOTO153ELSE156
153 HCOLOR&H8:HPRINT(A2,B2),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A2,B2),CHR$(&H78+W2*HE):POKEP1,V1:POKEP2,V2:GOTO162
154 HCOLORC3:HPRINT(A2,B2),CHR$(G3):GOTO162
155 HCOLORC4:HPRINT(A2,B2),CHR$(G4):GOTO162
156 HCOLORC1:HPRINT(A2,B2),CHR$(G1):GOTO162
157 ONP(AB)GOTO158,161,161,161,159,161,161,161,161,160:GOTO161
158 HCOLOR&H9:HPRINT(A2,B2),"$":GOTO162
159 HCOLORHE:HPRINT(A2,B2),"%":GOTO162
160 GOSUB54:GOTO162
161 HPRINT(A2,B2)," "
162 IFZ-Z2 GOTO172
163 GOSUB285:GOTO172
164 U=P(Z2+I):Q=P(Z2-I):IFQ ANDX2<X THEND2=&H3 ELSEIFU ANDX2>X THEND2=&H4 ELSEIFP(Z2-YA)THEND2=I ELSEIFU THEND2=&H4 ELSEIFQ THEND2=&H3
165 RETURN
166 U=P(Z2+I):IFP(Z2-I)ANDX2<X THEND2=&H3 ELSEIFU ANDX2>X THEND2=&H4 ELSEIFP(Z2+YA)THEND2=&H2 ELSEIFU THEND2=&H4 ELSED2=&H3
167 RETURN
168 U=P(Z2+YA):Q=P(Z2-YA):IFQ ANDY2<Y THEND2=I ELSEIFU ANDY2>Y THEND2=&H2 ELSEIFP(Z2-I)THEND2=&H3 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
169 RETURN
170 U=P(Z2+YA):Q=P(Z2-YA):IFQ ANDY2>Y THEND2=I ELSEIFU ANDY2>Y THEND2=&H2 ELSEIFP(Z2+I)THEND2=&H4 ELSEIFU THEND2=&H2 ELSEIFQ THEND2=I
171 RETURN
172 HCOLORI:HPRINT(X,Y),B$:IFPW GOSUB176
173 IFR3 THENR3=R3-I:HCOLORC3:G3=&H75+O:HPRINT(X3,Y3),CHR$(G3+O*HE):GOTO227
174 IFO GOTO227
175 A3=X3:B3=Y3:AB=Z3:ONJ3+I GOTO179:GOTO181
176 ONCD GOTO177,178,178,178,178,178,178:RETURN
177 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
178 RGB:RETURN
179 IFM3 THENOND3 GOSUB219,221,223,225:GOTO191
180 OND3 GOTO183,185,187,189:GOTO191
181 IFZ3=JC THEND3=I ELSEIFZ3=JR THEND3=&H3 ELSEIFZ3=JL THEND3=&H4
182 GOTO191
183 U=P(Z3-I):IFU ANDX3>X THEND3=&H3 ELSEIFP(Z3-YA)THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3
184 GOTO190
185 U=P(Z3-I):IFU ANDX3>X THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3 ELSED3=&H3
186 GOTO190
187 U=P(Z3-YA):IFU ANDY3>Y THEND3=I ELSEIFP(Z3-I)THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
188 GOTO190
189 IFP(Z3+I)THEND3=&H4 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3-YA)THEND3=I
190 G3=&H73+D3
191 OND3 GOTO192,193,194,195
192 Y3=Y3-I:GOTO196
193 Y3=Y3+I:GOTO196
194 X3=X3-I:GOTO196
195 X3=X3+I
196 W3=NOTW3:IFX3=RC THENX3=LB:R3=M3+I:GOTO198
197 IFX3=LC THENX3=RB:R3=M3+I
198 Z3=X3-XA+Y3*YA:IFZ3=LG THENM3=.:GOTO200
199 IFM3 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X3,Y3),UP$:HCOLOR&H2:HPRINT(X3,Y3),CHR$(&H78+W3*HE):POKEP1,V1:POKEP2,V2:GOTO202
200 HCOLORC3:HPRINT(X3,Y3),CHR$(G3+W3*HE):IFZ3=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X3,Y3),";":POKEP1,V1:POKEP2,V2:J3=.:GOTO202
201 IFAB=LG THENHCOLORLC:HPRINT(A3,B3),";":GOTO217
202 IFAB=Z4 GOTO203ELSE204
203 IFM4 GOTO208ELSE209
204 IFAB=Z1 GOTO205ELSE206
205 IFM1 GOTO208ELSE210
206 IFAB=Z2 GOTO207ELSE212
207 IFM2 GOTO208ELSE211
208 HCOLOR&H8:HPRINT(A3,B3),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A3,B3),CHR$(&H78+W3*HE):POKEP1,V1:POKEP2,V2:GOTO217
209 HCOLORC4:HPRINT(A3,B3),CHR$(G4):GOTO217
210 HCOLORC1:HPRINT(A3,B3),CHR$(G1):GOTO217
211 HCOLORC2:HPRINT(A3,B3),CHR$(G2):GOTO217
212 ONP(AB)GOTO213,216,216,216,214,216,216,216,216,215:GOTO216
213 HCOLOR&H9:HPRINT(A3,B3),"$":GOTO217
214 HCOLORHE:HPRINT(A3,B3),"%":GOTO217
215 GOSUB54:GOTO217
216 HPRINT(A3,B3)," "
217 IFZ-Z3 GOTO227
218 GOSUB289:GOTO227
219 U=P(Z3-I):IFU ANDX3<X THEND3=&H3 ELSEIFP(Z3-YA)THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3
220 RETURN
221 U=P(Z3-I):IFU ANDX3<X THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFP(Z3+I)THEND3=&H4 ELSEIFU THEND3=&H3 ELSED3=&H3
222 RETURN
223 U=P(Z3-YA):IFU ANDY3<Y THEND3=I ELSEIFP(Z3-I)THEND3=&H3 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
224 RETURN
225 U=P(Z3-YA):IFU ANDY3>Y THEND3=I ELSEIFP(Z3+I)THEND3=&H4 ELSEIFP(Z3+YA)THEND3=&H2 ELSEIFU THEND3=I
226 RETURN
227 IFPW GOSUB231
228 IFR4 THENR4=R4-I:HCOLORC4:G4=&H77+O*2:HPRINT(X4,Y4),CHR$(G4+O*HE):RETURN
229 IFO THENELSERETURN
230 A4=X4:B4=Y4:AB=Z4:ONJ4+I GOTO233:GOTO235
231 ONCD GOTO232:RETURN
232 M1=.:M2=.:M3=.:M4=.:PW=.:RGB:RETURN
233 IFM4 THENOND4 GOSUB273,275,277,279:GOTO245
234 OND4 GOTO237,239,241,243:GOTO245
235 IFZ4=JC THEND4=I ELSEIFZ4=JR THEND4=&H3 ELSEIFZ4=JL THEND4=&H4
236 GOTO245
237 U=P(Z4-I):IFU ANDX4>X THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I ELSEIFP(Z4+I)THEND4=&H4 ELSEIFU THEND4=&H3
238 GOTO244
239 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4+I)THEND4=&H4 ELSEIFP(Z4-I)THEND4=&H3 ELSED4=&H3
240 GOTO244
241 IFP(Z4-I)THEND4=&H3 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
242 GOTO244
243 IFP(Z4+I)THEND4=&H4 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
244 G4=&H73+D4
245 OND4 GOTO246,247,248,249
246 Y4=Y4-I:GOTO250
247 Y4=Y4+I:GOTO250
248 X4=X4-I:GOTO250
249 X4=X4+I
250 W4=NOTW4:IFX4=RC THENX4=LB:R4=M4+I:GOTO252
251 IFX4=LC THENX4=RB:R4=M4+I
252 Z4=X4-XA+Y4*YA:IFZ4=LG THENM4=.:GOTO254
253 IFM4 THENPOKEP1,V3:POKEP2,V4:HCOLOR&H8:HPRINT(X4,Y4),UP$:HCOLOR&H2:HPRINT(X4,Y4),CHR$(&H78+W4*HE):POKEP1,V1:POKEP2,V2:GOTO256
254 HCOLORC4:HPRINT(X4,Y4),CHR$(G4+W4*HE):IFZ4=LG THENPOKEP1,V3:POKEP2,V4:HCOLORLC:HPRINT(X4,Y4),";":POKEP1,V1:POKEP2,V2:J4=.:GOTO256
255 IFAB=LG THENHCOLORLC:HPRINT(A4,B4),";":GOTO271
256 IFAB=Z1 GOTO257ELSE258
257 IFM1 GOTO262ELSE263
258 IFAB=Z2 GOTO259ELSE260
259 IFM2 GOTO262ELSE264
260 IFAB=Z3 GOTO261ELSE266
261 IFM3 GOTO262ELSE265
262 HCOLOR&H8:HPRINT(A4,B4),UP$:HCOLOR&H2:POKEP1,V3:POKEP2,V4:HPRINT(A4,B4),CHR$(&H78+W4*HE):POKEP1,V1:POKEP2,V2:GOTO271
263 HCOLORC1:HPRINT(A4,B4),CHR$(G1):GOTO271
264 HCOLORC2:HPRINT(A4,B4),CHR$(G2):GOTO271
265 HCOLORC3:HPRINT(A4,B4),CHR$(G3):GOTO271
266 ONP(AB)GOTO267,270,270,270,268,270,270,270,270,269:GOTO270
267 HCOLOR&H9:HPRINT(A4,B4),"$":GOTO271
268 HCOLORHE:HPRINT(A4,B4),"%":GOTO271
269 GOSUB54:GOTO271
270 HPRINT(A4,B4)," "
271 IFZ-Z4 THENRETURN
272 GOSUB293:RETURN
273 U=P(Z4-I):IFU ANDX4<X THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I ELSEIFP(Z4+I)THEND4=&H4 ELSEIFU THEND4=&H3
274 RETURN
275 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4+I)THEND4=&H4 ELSEIFP(Z4-I)THEND4=&H3 ELSED4=&H3
276 RETURN
277 IFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-I)THEND4=&H3 ELSEIFP(Z4-YA)THEND4=I
278 RETURN
279 IFP(Z4+I)THEND4=&H4 ELSEIFP(Z4+YA)THEND4=&H2 ELSEIFP(Z4-YA)THEND4=I
280 RETURN
281 IFM1 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE297
282 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y1=&HD:M1=.:D1=I:G1=&H73+W1:R1=&H14-FR:J1=NOT.:K=K+I
283 IFNOT(Z2=JR ORZ3=JR ORZ4=JR)THENZ1=JR:X1=&H15:W1=NOT.:D1=&H3:ELSEIFNOT(Z2=JL ORZ3=JL ORZ4=JL)THENZ1=JL:X1=&H13:W1=NOT.:D1=&H4:ELSEZ1=JC:X1=&H14:W1=.:D1=I
284 RETURN
285 IFM2 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE297
286 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y2=&HD:M2=.:D2=I:G2=&H73+W2:R2=&H14-FR:J2=NOT.:K=K+I
287 IFNOT(Z1=JR ORZ3=JR ORZ4=JR)THENZ2=JR:X2=&H15:W2=NOT.:D2=&H3:ELSEIFNOT(Z1=JL ORZ3=JL ORZ4=JL)THENZ2=JL:X2=&H13:W2=NOT.:D2=&H4:ELSEZ2=JC:X2=&H14:W2=.:D2=I
288 RETURN
289 IFM3 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE297
290 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y3=&HD:M3=.:D3=I:G3=&H73+W3:R3=&H14-FR:J3=NOT.:K=K+I
291 IFNOT(Z2=JR ORZ1=JR ORZ4=JR)THENZ3=JR:X3=&H15:W3=NOT.:D3=&H3:ELSEIFNOT(Z2=JL ORZ1=JL ORZ4=JL)THENZ3=JL:X3=&H13:W3=NOT.:D3=&H4:ELSEZ3=JC:X3=&H14:W3=.:D3=I
292 RETURN
293 IFM4 THENHCOLORI:IFW THENHPRINT(X,Y),"!"ELSEHPRINT(X,Y),B$:ELSE297
294 PLAY"XGK$;":S=S+&H14*FIX(&H2^K):Y4=&HD:M4=.:D4=I:G4=&H73+W4:R4=&H14-FR:J4=NOT.:K=K+I
295 IFNOT(Z2=JR ORZ3=JR ORZ1=JR)THENZ4=JR:X4=&H15:W4=NOT.:D4=&H3:ELSEIFNOT(Z2=JL ORZ3=JL ORZ1=JL)THENZ4=JL:X4=&H13:W4=NOT.:D4=&H4:ELSEZ4=JC:X4=&H14:W4=.:D4=I
296 RETURN
297 HCOLORI:HPRINT(X,Y),"k":PLAY"V31O3G-V27G-V28EEO4E-O3EV27EV28G-V27G-V26G-V27GV26EV27EO4E-O3E-E-V28D-V27E-E-V26O4E-"
298 HPRINT(X,Y),"l":PLAY"V27O3EV26EG-O4E-O3E-E-V27D-V26D-V27D-D-V26D-E-E-O4E-V25O3EE-D-V26D-O4CO2BBBO4CO3D-D-"
299 HPRINT(X,Y),"q":PLAY"V25E-E-V24D-V25D-V24O2BV25BA-A-V24A-BV25BV24O4CO3D-V23D-O2BV24BV23A-V24A-V25O3G"
300 HPRINT(X,Y),"r":PLAY"V23O2G-V24A-A-O1G-V29O2G-V28O3E-V27GV26BV24O4DV23EV22G-V21A-V20B-V18O5CV19O1C"
301 HPRINT(X,Y),"s":PLAY"V24BV30O2G-V28O3E-V27GV26BV24O4DV23EV22G-V21A-V20B-V18O5CV3O1CV2CV15P1P1P1"
302 HPRINT(X,Y)," ":NL=NL-I:IFNL=. THENHCOLOR&H3:HPRINT(16,&HF),"GAME OVER":GOSUB367:HCLS0:RESTORE:GOTO318
303 U=P(Z1):IFU=I THENHCOLOR&H9:HPRINT(X1,Y1),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X1,Y1),"%":ELSEHPRINT(X1,Y1)," "
304 U=P(Z2):IFU=I THENHCOLOR&H9:HPRINT(X2,Y2),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X2,Y2),"%":ELSEHPRINT(X2,Y2)," "
305 U=P(Z3):IFU=I THENHCOLOR&H9:HPRINT(X3,Y3),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X3,Y3),"%":ELSEHPRINT(X3,Y3)," "
306 U=P(Z4):IFU=I THENHCOLOR&H9:HPRINT(X4,Y4),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X4,Y4),"%":ELSEHPRINT(X4,Y4)," "
307 U=P(Z):IFU=I THENHCOLOR&H9:HPRINT(X,Y),"$":ELSEIFU=&H5 THENHCOLORHE:HPRINT(X,Y),"%":ELSEHPRINT(X,Y)," "
308 HPRINT(NL+LC,23)," ":X=&H14:Y=&H11:HCOLORI:HPRINT(X,Y),QT$:P(&HCF)=&HF:GOTO342
309 PCLEAR1:DIMI,P(&H156),X,Y,Z,XA,YA,G,W,O,X1,Y1,Z1,D1,G1,C1,W1,X2,Y2,Z2,D2,G2,C2,W2,X3,Y3,Z3,D3,G3,C3,W3,X4,Y4,Z4,D4,G4,C4,W4,A,C,AB,A1,B1,A2,B2,A3,B3,A4,B4,PW,K,LB,LC,RB,RC,LG,JL,JC,JR,JD,QT$,PL$,PU$,PD$,UP$,HE,P1,P2,V1,V2,V3,V4,SP
310 I=&H1:P1=&HF00D:P2=&HF00E:P3=&HFFBE:P4=&HFFBB:V1=&H94:V2=&HB3:V3=&HA4:V4=&H84:V5=&H3C:V6=&H3F:QT$=CHR$(&H22):PL$=CHR$(&H7C):PU$=CHR$(&H6B):PD$=CHR$(&H7B):UP$=CHR$(&H7E):HE=&HE:XA=&H53:YA=&H12:LB=&HC:LC=&HB:RB=&H1C:RC=&H1D:JD=&H16:SP=&H20:LG=&H99:JL=&HAA:JC=&HAB:JR=&HAC
311 POKE&HFFD8,.:LOADM"PACTILES.BIN":POKE&HFFD9,.:POKE&HADEB,57:POKE&HE414,.:POKE&HE42A,.:POKE359,255:POKEP2,V4:POKEP1,V1:POKEP2,V2
312 POKE&HE649,&H10:POKE&HE664,.:POKE&HE666,LC:POKE&HE66A,&H3D:POKE&HE66B,&H34:POKE&HE66C,V5:POKE&HE66D,V5:POKE&HE66E,&H24:POKE&HE670,&H8:POKE&HE672,V6:POKE&HE673,RB:RGB
313 HSCREEN&H2
314 E1$="V30O2G-V29G-V28G-V27G-G-V25G-V24G-V18G-V17G-V14G-V12G-V30G-V28G-G-V27G-G-V25G-V23G-V18G-V17G-V15G-V12G-V11G-V31G-V29G-V28G-V27G-V26G-V25G-V23G-V18G-V16G-V14G-V17G-V28G-V29G-V27G-G-V26G-V25G-V23G-"
315 E2$="V18G-V16G-V14G-V12G-V17G-V30G-V28G-G-V27G-G-V24G-V22G-V18G-V16G-V14G-V18G-V29G-V28G-G-V27G-V26G-V25G-V22G-V18G-V16G-V14G-V11G-V20G-V29G-G-V27G-G-V26G-V24G-V22G-V18G-V16G-V14G-V21G-V29G-V28G-V27G-G-"
316 E3$="V26G-V24G-V22G-V18G-V16G-V14G-V11G-V21O1CV29O2G-V28G-G-V26G-G-V24G-V21G-V18G-V15G-V13G-V23G-V29G-V28G-V27G-G-V26G-V24G-V21G-V17G-V15G-V13G-V10G-V15"
317 GK$="T255L255V14O1CV11CV21CV28G-V31BV19O2E-V18E-V29G-V16A-V27BV18O3D-V27D-V18E-V24EV25G-V20G-GV22A-B-BV21BO4CD-V22DV23DV21E-V19E-V23EV20FFV21G-V12O1CV4CV1CV15"
318 HCLS.:G1=&H69:G2=&H69:G3=&H69:G4=&H69:FR=I:NL=&H3:S=.:OS=.:LM=.:BC=LB:C1=&H3:C2=&H6:C3=&H5:C4=&H7:MZ=I:BL=.
319 HCOLOR&H9,.:HPRINT(&H9,I),"COCOdSYNTHESIS PRESENTS":FORT=1TO3000:NEXT
320 POKEP1,V1:POKEP2,V2:HCOLORI:FORT=8TO31:HPRINT(T-I,I)," "+QT$:PLAY"T255L255V20O3A-V23G-V24E-V25CV26O2G-V14G-P255P255P255"
321 HPRINT(T,I),"!":PLAY"V23O2E-V27A-V26O3CE-V25GV10O2E-P255P255P255":NEXT:HPRINT(31,I)," "
322 HCOLOR&H4:HPRINT(18,.),"BASIC":HCOLORI:HPRINT(17,I),"pacdman":FORT=1TO3000:NEXT:HCOLOR&H4:HPRINT(&H9,&H4),"INTRODUCING THE GHOSTS":FORT=1TO1000:NEXT
323 X=&H2:HCOLORC1:FORY=23TO5 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
324 HPRINT(&H9,&H4),STRING$(22," "):HPRINT(&H2,&H5),CHR$(G1)+" BLINKY"
325 HCOLORC2:FORY=23TO7 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
326 HPRINT(&H2,&H7),CHR$(G1)+" PINKY"
327 HCOLORC3:FORY=23TO9 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
328 HPRINT(&H2,&H9),CHR$(G1)+" INKY"
329 HCOLORC4:FORY=23TO11 STEP-1:HPRINT(&H2,Y+I)," ":HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:HPRINT(&H2,Y),"t":FORT=1TO150:NEXT:HPRINT(&H2,Y),"f":FORT=1TO150:NEXT:NEXT
330 HPRINT(&H2,LC),CHR$(G1)+" CLYDE"
331 FORT=1TO1000:NEXT:HCOLOR&H9:HPRINT(30,&H9),"$":HCOLOR&H4:HPRINT(32,&H9),"10 PTS":HCOLORHE:HPRINT(30,LC),"%":HCOLOR&H4:HPRINT(32,LC),"50 PTS"
332 HCOLOR&H4:HPRINT(33,&H3),"1UP":HCOLORBC:HPRINT(30,&H4),CHR$(&H5B)+STRING$(&H7,CHR$(&H26))+CHR$(&H5D):HPRINT(30,&H5),CHR$(&H2E):HCOLOR&H4:HPRINT(36,&H5),"00":HCOLORBC:HPRINT(38,&H5),CHR$(&H2E)
333 HPRINT(30,&H6),CHR$(&H5C)+STRING$(&H7,CHR$(&H26))+CHR$(&H5E)
334 IFFR>&H7 THENFR=&H7:BL=BL+I
335 PL=.:PP=.:Z=.:POKE&HE47B,38:POKE&HE47C,54:ONERR GOTO378
336 MF$="MAZE"+STR$(MZ):OPEN "I",#1,MF$:INPUT#1,PC:POKE&HE670,PC:RGB:HCOLORBC:MZ=MZ+I
337 FORY=1TO19:FORX=1TO17
338 Z=X-YA+YA*Y:INPUT#1,B:IFB=&H24 THENHCOLOR&H9:P(Z)=I:PP=PP+I:ELSEIFB=&H25 THENHCOLORHE:P(Z)=&H5:ELSEIFB=&H3B THENHCOLORLC:P(Z)=.:ELSEIFB=SP THENHCOLOR.:P(Z)=&H2:ELSEIFB=&H22 THENHCOLORI:P(Z)=&H2:ELSEP(Z)=.
339 HPRINT(X+LC,Y+&H3),CHR$(B):HCOLORBC:NEXT:NEXT:CLOSE #1
340 IFFR=I GOSUB367
341 POKE&HE47B,18:POKE&HE47C,18
342 POKEP1,V3:POKEP2,V4:K=.:X1=&H14:Y1=LC:D1=&H2:G1=&H74:Z1=&H87:M1=.:W1=.:X2=&H14:Y2=&HD:D2=I:G2=&H74:Z2=JC:M2=.:W2=.
343 X3=&H13:Y3=&HD:D3=&H4:G3=&H67:Z3=JL:M3=.:W3=NOT.:X4=&H15:Y4=&HD:D4=&H4:G4=&H67:Z4=JR:M4=.:W4=NOT.:J1=.:J2=NOT.:J3=NOT.:J4=NOT.
344 HCOLORC1:HPRINT(X1,Y1),CHR$(G1):HCOLORC2:HPRINT(X2,Y2),CHR$(G2):HCOLORC3:HPRINT(X3,Y3),CHR$(G3):HCOLORC4:HPRINT(X4,Y4),CHR$(G4)
345 ONFR GOTO346,347,348,349,350,351,352
346 FT=&H1E:CT=&H1E:R1=.:R2=10:R3=20:R4=&H1E:HCOLOR&H3:HPRINT(28,23),"<":HCOLOR&H4:HPRINT(28,23),"=":HCOLOR&HD:HPRINT(28,23),">":GOTO353
347 FT=&H1E:CT=&H1B:R1=.:R2=9:R3=&H12:R4=&H1B:HCOLOR&H3:HPRINT(27,23),"?":HCOLOR&HD:HPRINT(27,23),"@":GOTO353
348 FT=&H1E:CT=&H18:R1=.:R2=8:R3=16:R4=&H18:HCOLOR&H7:HPRINT(26,23),"#":HCOLOR&HD:HPRINT(26,23),"@":GOTO353
349 FT=&H1E:CT=&H15:R1=.:R2=7:R3=14:R4=&H15:HCOLOR&H3:HPRINT(25,23),"b":HCOLOR&HD:HPRINT(25,23),"@":GOTO353
350 FT=&H1E:CT=&H12:R1=.:R2=6:R3=&HC:R4=&H12:HCOLOR&HD:HPRINT(24,23),"y":HCOLOR&HF:HPRINT(24,23),"z":GOTO353
351 FT=&H1E:CT=&HF:R1=.:R2=5:R3=&HA:R4=&HF:HCOLOR&H4:HPRINT(23,23),"o":HCOLOR&H5:HPRINT(23,23),CHR$(&H7F):GOTO353
352 FT=&H1E:CT=&HF:R1=.:R2=4:R3=8:R4=&HC:HCOLORI:HPRINT(22-BL,23),CHR$(&H7D):HCOLOR&H5:HPRINT(22-BL,23),CHR$(&H5F):GOTO353
353 POKEP1,V1:POKEP2,V2:HCOLORI:HPRINT(YA,&HF),"READY"+CHR$(96)
354 PLAY"V26O1CV29O3D-V30D-D-V23O1CV17G-V16G-V13G-V25O4D-V27D-D-D-V15O1CV3CV1CP255V21O3GV25GGV26GV17O1CV3CV1CP255V27O3EV28EV30EV29EV22O1BV17G-V16G-V12BV27O4D-V28D-D-D-O3GGGV27G"
355 PLAY"V19O1CV10CV8CV6CV4G-V2G-P255P255V27O3EV26EEEV27EEEEV24O1G-V22G-V20BV19BV18G-V17G-V16BV12G-V31O3D-V29E-D-V30D-V18O1CV17G-V16G-V12G-V27O4DDDDV12O1CV4CV1CV10CV26O3A-A-A-"
356 PLAY"9V8O1CV3CV1CV5CV30O3G-V29G-G-V28G-V19O1BV17BV15BV16G-V29O4DV28DDDO3A-V27A-V28A-V27A-V13O1CV10CV8CV5G-V4G-V1CP255V13O1CV26O3G-G-G-G-G-V27G-G-V26G-V22O1G-V21BV20BV19G-"
357 PLAY"V18G-V16BV15BV21BV30O3D-V29D-D-V28D-V17O1CCV15CV19CV27O4D-D-D-V24D-V4O1CV2CP255V18O1CV25O3GV26GGV21GP255P255P255V19O3EV30EV28EV29EV26EV18O1BV16G-V14G-V21G-V29O4D-V28D-"
358 PLAY"V29D-V27D-V28O3GGGV24GV11O1G-V9CV7CV5CV2CP255P255V21O1CV26O3EEEV27EEEEV26EV23O1G-V21G-V19BBV17G-V16G-V14BV25O3E-V29EV30E-V29EEV28EV29EV28EG-G-G-G-V22O1CV5CV2CP255"
359 PLAY"V25O1G-V30O3G-V29G-V28G-V29GV27GV28GV27GGGGGV19O1CV4CV2CP255V26O3GV28GGV27GV28A-V27A-A-A-B-B-V28B-B-V19O1CV6CV2CP255V27O4D-V28D-V29D-V28D-V29D-V28D-D-D-V21O2E-V15E-V13O1B"
360 PLAY"V9BV7BV4BV2CV15P1P1":HCOLOR&H9:HPRINT(&H14,&HF)," "
361 IFP(&HCD)=I THENHPRINT(YA,&HF),"$"ELSEHPRINT(YA,&HF)," "
362 IFP(&HCE)=I THENHPRINT(&H13,&HF),"$"ELSEHPRINT(&H13,&HF)," "
363 IFP(&HD0)=I THENHPRINT(&H15,&HF),"$"ELSEHPRINT(&H15,&HF)," "
364 IFP(&HD1)=I THENHPRINT(JD,&HF),"$"ELSEHPRINT(JD,&HF)," "
365 IFP(&HD2)=I THENHPRINT(&H17,&HF),"$"ELSEHPRINT(&H17,&HF)," "
366 X=&H14:Y=&H11:B$=CHR$(&H22):PD=&H4:OB$=B$:Z=&HF3:PW=.:C1=&H3:C2=&H6:C3=&H5:C4=&H7:W=.:GOTO1
367 HCOLORHE:HPRINT(&HA,23),"PRESS BUTTON TO START"
368 IFBUTTON(.)GOTO376
369 IFFL=I THENPOKEP3,V5
370 IFBUTTON(.)GOTO376
371 IFFL=&H14 THENPOKEP3,V6
372 IFBUTTON(.)GOTO376
373 IFFL=&H28 THENFL=.
374 IFBUTTON(.)GOTO376
375 FL=FL+I:GOTO368
376 HCOLOR.:HPRINT(&HA,23),"PRESS BUTTON TO START":IFFR=I ANDNL THENHCOLORI:HPRINT(LB,23),STRING$(NL-I,QT$)
377 RETURN
378 IFERNO=26 THENMZ=I:GOTO336:ELSE341
